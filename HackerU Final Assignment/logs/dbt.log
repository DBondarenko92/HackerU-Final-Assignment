[0m01:36:24.326788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DB09AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DB099C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DB4C4C10>]}


============================== 01:36:24.329790 | 9e9a7fc0-1c79-4a63-8070-c021bf354150 ==============================
[0m01:36:24.329790 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:36:24.330790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:36:24.577625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e9a7fc0-1c79-4a63-8070-c021bf354150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DBA34810>]}
[0m01:36:24.642115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e9a7fc0-1c79-4a63-8070-c021bf354150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DAAB2850>]}
[0m01:36:24.643117 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:36:24.645199 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:36:24.645199 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:36:24.645199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e9a7fc0-1c79-4a63-8070-c021bf354150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DBAC5410>]}
[0m01:36:25.562098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.chinook.facts
- models.chinook.dimensions
[0m01:36:25.566187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e9a7fc0-1c79-4a63-8070-c021bf354150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DCB324D0>]}
[0m01:36:25.596435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e9a7fc0-1c79-4a63-8070-c021bf354150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DCC6DF10>]}
[0m01:36:25.597541 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m01:36:25.597541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9a7fc0-1c79-4a63-8070-c021bf354150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DB907A10>]}
[0m01:36:25.598544 [info ] [MainThread]: 
[0m01:36:25.599547 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:36:25.599547 [debug] [MainThread]: Command end result
[0m01:36:25.607676 [debug] [MainThread]: Command `dbt run` succeeded at 01:36:25.607676 after 1.32 seconds
[0m01:36:25.607676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125D84D3A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DA5A3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125DCBD4650>]}
[0m01:36:25.608680 [debug] [MainThread]: Flushing usage events
[0m01:38:02.823209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E0E55890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E0EA6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E0E55ED0>]}


============================== 01:38:02.826732 | 529aa6c4-e9c2-4de7-adab-ac37741c6551 ==============================
[0m01:38:02.826732 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:38:02.827734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:38:02.995812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E09A86D0>]}
[0m01:38:03.060854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E20E1490>]}
[0m01:38:03.062013 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:38:03.068683 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:38:03.222715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m01:38:03.223716 [debug] [MainThread]: Partial parsing: added file: chinook://models\dimensions\dim_employee.sql
[0m01:38:03.223716 [debug] [MainThread]: Partial parsing: added file: chinook://models\facts\fact_invoiceline.sql
[0m01:38:03.223716 [debug] [MainThread]: Partial parsing: added file: chinook://models\dimensions\dim_customer.sql
[0m01:38:03.224716 [debug] [MainThread]: Partial parsing: added file: chinook://models\dimensions\dim_playlist.sql
[0m01:38:03.224716 [debug] [MainThread]: Partial parsing: added file: chinook://models\dimensions\dim_track.sql
[0m01:38:03.225716 [debug] [MainThread]: Partial parsing: added file: chinook://models\facts\fact_invoice.sql
[0m01:38:03.225716 [debug] [MainThread]: Partial parsing: added file: chinook://models\facts\schema.yml
[0m01:38:03.225716 [debug] [MainThread]: Partial parsing: added file: chinook://models\dimensions\schema.yml
[0m01:38:03.388122 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_currency' in the 'models' section of file 'models\facts\schema.yml'
[0m01:38:03.517871 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.chinook.unique_dim_currency_date_rate.abd13cf4bb' (models\facts\schema.yml) depends on a node named 'dim_currency' in package '' which was not found
[0m01:38:03.533527 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.chinook.not_null_dim_currency_date_rate.962b905cf1' (models\facts\schema.yml) depends on a node named 'dim_currency' in package '' which was not found
[0m01:38:03.543922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E25A04D0>]}
[0m01:38:03.557998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E1073550>]}
[0m01:38:03.559145 [info ] [MainThread]: Found 6 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m01:38:03.559145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E23C0090>]}
[0m01:38:03.562942 [info ] [MainThread]: 
[0m01:38:03.562942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:38:03.564845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m01:38:03.572962 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m01:38:03.573963 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m01:38:03.573963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:03.607957 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m01:38:03.608960 [debug] [ThreadPool]: On list_chinook: Close
[0m01:38:03.609974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_chinook, now create_chinook_chinook_dwh)
[0m01:38:03.611246 [debug] [ThreadPool]: Creating schema "database: "chinook"
schema: "chinook_dwh"
"
[0m01:38:03.615339 [debug] [ThreadPool]: Using postgres connection "create_chinook_chinook_dwh"
[0m01:38:03.616339 [debug] [ThreadPool]: On create_chinook_chinook_dwh: BEGIN
[0m01:38:03.616339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:03.643112 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:38:03.643112 [debug] [ThreadPool]: Using postgres connection "create_chinook_chinook_dwh"
[0m01:38:03.643112 [debug] [ThreadPool]: On create_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "create_chinook_chinook_dwh"} */
create schema if not exists "chinook_dwh"
[0m01:38:03.643112 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m01:38:03.643112 [debug] [ThreadPool]: On create_chinook_chinook_dwh: COMMIT
[0m01:38:03.643112 [debug] [ThreadPool]: Using postgres connection "create_chinook_chinook_dwh"
[0m01:38:03.643112 [debug] [ThreadPool]: On create_chinook_chinook_dwh: COMMIT
[0m01:38:03.643112 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m01:38:03.643112 [debug] [ThreadPool]: On create_chinook_chinook_dwh: Close
[0m01:38:03.658041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m01:38:03.663355 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:38:03.663355 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m01:38:03.663355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:03.693930 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:38:03.693930 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:38:03.693930 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m01:38:03.702159 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m01:38:03.702159 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m01:38:03.703632 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m01:38:03.707958 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:03.707958 [debug] [MainThread]: On master: BEGIN
[0m01:38:03.707958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:38:03.736328 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:38:03.736328 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:03.737728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:38:03.745104 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m01:38:03.745104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E23C0090>]}
[0m01:38:03.745104 [debug] [MainThread]: On master: ROLLBACK
[0m01:38:03.745104 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:03.745104 [debug] [MainThread]: On master: BEGIN
[0m01:38:03.745104 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:38:03.745104 [debug] [MainThread]: On master: COMMIT
[0m01:38:03.750002 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:03.750002 [debug] [MainThread]: On master: COMMIT
[0m01:38:03.750002 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:38:03.751266 [debug] [MainThread]: On master: Close
[0m01:38:03.751266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:38:03.752762 [info ] [MainThread]: 
[0m01:38:03.756666 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m01:38:03.757671 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m01:38:03.757671 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m01:38:03.759151 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m01:38:03.764607 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m01:38:03.766966 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 01:38:03.759151 => 01:38:03.765607
[0m01:38:03.766966 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m01:38:03.792830 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m01:38:03.792830 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:38:03.792830 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m01:38:03.792830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:38:03.830242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:38:03.830242 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:38:03.831244 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customer_id
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(email, postition('@' in email) + 1), position('.' in substring(email, position(email, position('@' in email) + 1))-1) as domain
    ,customer.supporteid
    ,customer.last_update
    ,'2024-08-06 22:38:^S'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m01:38:03.832672 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  ошибка синтаксиса (примерное положение: "email")
LINE 24:     ,left(substring(email, postition('@' in email) + 1), pos...
                                                     ^

[0m01:38:03.832672 [debug] [Thread-1 (]: On model.chinook.dim_customer: ROLLBACK
[0m01:38:03.833839 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 01:38:03.766966 => 01:38:03.833839
[0m01:38:03.833839 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m01:38:03.916957 [debug] [Thread-1 (]: Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: "email")
  LINE 24:     ,left(substring(email, postition('@' in email) + 1), pos...
                                                       ^
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:38:03.916957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E2659D10>]}
[0m01:38:03.916957 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model chinook_dwh.dim_customer ................. [[31mERROR[0m in 0.16s]
[0m01:38:03.918525 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m01:38:03.919727 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m01:38:03.919727 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m01:38:03.920730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m01:38:03.920730 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m01:38:03.924731 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m01:38:03.925730 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 01:38:03.921731 => 01:38:03.925730
[0m01:38:03.926731 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m01:38:03.930113 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m01:38:03.931383 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:38:03.931885 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m01:38:03.931885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:03.963672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:38:03.964672 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:38:03.964672 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,db.department_name
    ,db.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 22:38:^S'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."department_budget" db on emp.department_id = db.department_id
  );
  
[0m01:38:03.967177 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  отношение "stg.department_budget" не существует
LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                  ^

[0m01:38:03.967177 [debug] [Thread-1 (]: On model.chinook.dim_employee: ROLLBACK
[0m01:38:03.968262 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 01:38:03.926731 => 01:38:03.968262
[0m01:38:03.969379 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m01:38:03.971694 [debug] [Thread-1 (]: Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:38:03.972694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E21AA550>]}
[0m01:38:03.972694 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model chinook_dwh.dim_employee ................. [[31mERROR[0m in 0.05s]
[0m01:38:03.974005 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m01:38:03.974005 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m01:38:03.974005 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m01:38:03.975374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m01:38:03.975374 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m01:38:03.979486 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m01:38:03.980486 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 01:38:03.976484 => 01:38:03.980486
[0m01:38:03.980486 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m01:38:03.984408 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m01:38:03.985426 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:38:03.986432 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m01:38:03.986432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:04.018427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:38:04.018427 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:38:04.019528 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 22:38:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m01:38:04.021387 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m01:38:04.021387 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m01:38:04.022392 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 01:38:03.980486 => 01:38:04.022392
[0m01:38:04.023397 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m01:38:04.025908 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:38:04.025908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E263EAD0>]}
[0m01:38:04.026914 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.05s]
[0m01:38:04.026914 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m01:38:04.026914 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m01:38:04.028343 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m01:38:04.028847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m01:38:04.029851 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m01:38:04.033945 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m01:38:04.034950 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 01:38:04.029851 => 01:38:04.034950
[0m01:38:04.036368 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m01:38:04.039373 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m01:38:04.040827 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:38:04.040944 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m01:38:04.040944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:04.071367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:38:04.071367 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:38:04.072369 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 22:38:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m01:38:04.073685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m01:38:04.074188 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m01:38:04.074188 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 01:38:04.036368 => 01:38:04.074188
[0m01:38:04.075320 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m01:38:04.077088 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:38:04.078184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E23868D0>]}
[0m01:38:04.078687 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.05s]
[0m01:38:04.079910 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m01:38:04.079910 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m01:38:04.079910 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m01:38:04.081334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m01:38:04.081334 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m01:38:04.085473 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m01:38:04.086477 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 01:38:04.081334 => 01:38:04.086477
[0m01:38:04.086477 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m01:38:04.110475 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m01:38:04.111557 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:38:04.112691 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m01:38:04.112691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:04.142961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:38:04.142961 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:38:04.143998 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 22:38:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m01:38:04.145593 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:38:^S"
LINE 16:     ,'2024-08-06 22:38:^S'::timestamp as dbt_time
              ^

[0m01:38:04.145593 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m01:38:04.145593 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 01:38:04.086477 => 01:38:04.145593
[0m01:38:04.145593 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m01:38:04.151156 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:38:^S"
  LINE 16:     ,'2024-08-06 22:38:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:38:04.151156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E20E2510>]}
[0m01:38:04.151156 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.07s]
[0m01:38:04.151156 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m01:38:04.151156 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m01:38:04.151156 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m01:38:04.151156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m01:38:04.151156 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m01:38:04.151156 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m01:38:04.151156 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 01:38:04.151156 => 01:38:04.151156
[0m01:38:04.159662 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m01:38:04.163150 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m01:38:04.164150 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:38:04.164150 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m01:38:04.165594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:04.197506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:38:04.197506 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:38:04.198507 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 22:38:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m01:38:04.199507 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:38:^S"
LINE 16:     ,'2024-08-06 22:38:^S'::timestamp as dbt_time
              ^

[0m01:38:04.199507 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m01:38:04.200507 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 01:38:04.159662 => 01:38:04.200507
[0m01:38:04.200507 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m01:38:04.203508 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:38:^S"
  LINE 16:     ,'2024-08-06 22:38:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:38:04.203508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529aa6c4-e9c2-4de7-adab-ac37741c6551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E2374450>]}
[0m01:38:04.204508 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.05s]
[0m01:38:04.204508 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m01:38:04.206828 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:04.207331 [debug] [MainThread]: On master: BEGIN
[0m01:38:04.207331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:38:04.238619 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:38:04.238619 [debug] [MainThread]: On master: COMMIT
[0m01:38:04.239749 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:04.239749 [debug] [MainThread]: On master: COMMIT
[0m01:38:04.239749 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:38:04.240791 [debug] [MainThread]: On master: Close
[0m01:38:04.240791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:38:04.242004 [debug] [MainThread]: Connection 'create_chinook_chinook_dwh' was properly closed.
[0m01:38:04.242004 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m01:38:04.242004 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m01:38:04.243006 [info ] [MainThread]: 
[0m01:38:04.243006 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m01:38:04.243006 [debug] [MainThread]: Command end result
[0m01:38:04.245491 [info ] [MainThread]: 
[0m01:38:04.245491 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m01:38:04.245491 [info ] [MainThread]: 
[0m01:38:04.255545 [error] [MainThread]:   Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: "email")
  LINE 24:     ,left(substring(email, postition('@' in email) + 1), pos...
                                                       ^
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:38:04.255545 [info ] [MainThread]: 
[0m01:38:04.256637 [error] [MainThread]:   Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:38:04.256637 [info ] [MainThread]: 
[0m01:38:04.257654 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:38:04.257654 [info ] [MainThread]: 
[0m01:38:04.258680 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:38:04.258680 [info ] [MainThread]: 
[0m01:38:04.258680 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:38:^S"
  LINE 16:     ,'2024-08-06 22:38:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:38:04.260093 [info ] [MainThread]: 
[0m01:38:04.260093 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:38:^S"
  LINE 16:     ,'2024-08-06 22:38:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:38:04.261096 [info ] [MainThread]: 
[0m01:38:04.262098 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m01:38:04.263098 [debug] [MainThread]: Command `dbt run` failed at 01:38:04.262098 after 1.48 seconds
[0m01:38:04.263098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E075D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E09D5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E09D63D0>]}
[0m01:38:04.263098 [debug] [MainThread]: Flushing usage events
[0m01:49:12.811880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021583FE1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215837AB5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215837EB850>]}


============================== 01:49:12.815108 | 59b4c715-091d-4d17-b89f-308a2706b3ef ==============================
[0m01:49:12.815108 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:49:12.815108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:49:12.973491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215837E8F90>]}
[0m01:49:13.040341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215844EE3D0>]}
[0m01:49:13.040341 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:49:13.040341 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:49:13.164756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:49:13.164756 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_customer.sql
[0m01:49:13.368601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215859F0A50>]}
[0m01:49:13.388178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585A9F650>]}
[0m01:49:13.388178 [info ] [MainThread]: Found 6 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m01:49:13.388178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158576F550>]}
[0m01:49:13.388178 [info ] [MainThread]: 
[0m01:49:13.388178 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:49:13.393831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m01:49:13.401589 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m01:49:13.402859 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m01:49:13.402859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:13.432080 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:49:13.432080 [debug] [ThreadPool]: On list_chinook: Close
[0m01:49:13.432080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m01:49:13.437959 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:49:13.437959 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m01:49:13.437959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:13.466760 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.466760 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:49:13.466760 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m01:49:13.470524 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m01:49:13.470524 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m01:49:13.470524 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m01:49:13.479578 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:13.480627 [debug] [MainThread]: On master: BEGIN
[0m01:49:13.480627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:13.508202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.508202 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:13.508202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:49:13.513313 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m01:49:13.513313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215844D6A10>]}
[0m01:49:13.513313 [debug] [MainThread]: On master: ROLLBACK
[0m01:49:13.513313 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:13.513313 [debug] [MainThread]: On master: BEGIN
[0m01:49:13.513313 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.513313 [debug] [MainThread]: On master: COMMIT
[0m01:49:13.513313 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:13.520705 [debug] [MainThread]: On master: COMMIT
[0m01:49:13.520705 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:49:13.520705 [debug] [MainThread]: On master: Close
[0m01:49:13.520705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:49:13.520705 [info ] [MainThread]: 
[0m01:49:13.520705 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m01:49:13.520705 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m01:49:13.526711 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m01:49:13.526711 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m01:49:13.533025 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m01:49:13.533025 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 01:49:13.526711 => 01:49:13.533025
[0m01:49:13.533025 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m01:49:13.560315 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m01:49:13.560315 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:49:13.560315 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m01:49:13.560315 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:49:13.593295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.593295 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:49:13.594522 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customer_id
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, postition('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supporteid
    ,customer.last_update
    ,'2024-08-06 22:49:^S'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m01:49:13.594522 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  ошибка синтаксиса (примерное положение: "customer")
LINE 24: ... ,left(substring(customer.email, postition('@' in customer.e...
                                                              ^

[0m01:49:13.595580 [debug] [Thread-1 (]: On model.chinook.dim_customer: ROLLBACK
[0m01:49:13.595580 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 01:49:13.533025 => 01:49:13.595580
[0m01:49:13.596755 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m01:49:13.596755 [debug] [Thread-1 (]: Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: "customer")
  LINE 24: ... ,left(substring(customer.email, postition('@' in customer.e...
                                                                ^
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:49:13.596755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158561F810>]}
[0m01:49:13.596755 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model chinook_dwh.dim_customer ................. [[31mERROR[0m in 0.07s]
[0m01:49:13.596755 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m01:49:13.596755 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m01:49:13.596755 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m01:49:13.596755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m01:49:13.596755 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m01:49:13.606258 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m01:49:13.606258 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 01:49:13.596755 => 01:49:13.606258
[0m01:49:13.606258 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m01:49:13.611733 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m01:49:13.611733 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:49:13.613370 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m01:49:13.613370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:13.640396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.640396 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:49:13.640396 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,db.department_name
    ,db.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 22:49:^S'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."department_budget" db on emp.department_id = db.department_id
  );
  
[0m01:49:13.640396 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  отношение "stg.department_budget" не существует
LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                  ^

[0m01:49:13.640396 [debug] [Thread-1 (]: On model.chinook.dim_employee: ROLLBACK
[0m01:49:13.644217 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 01:49:13.606258 => 01:49:13.644217
[0m01:49:13.644217 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m01:49:13.647630 [debug] [Thread-1 (]: Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:49:13.647630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585A12C50>]}
[0m01:49:13.647630 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model chinook_dwh.dim_employee ................. [[31mERROR[0m in 0.05s]
[0m01:49:13.647630 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m01:49:13.647630 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m01:49:13.647630 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m01:49:13.647630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m01:49:13.647630 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m01:49:13.654136 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m01:49:13.654136 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 01:49:13.647630 => 01:49:13.654136
[0m01:49:13.654136 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m01:49:13.654136 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m01:49:13.654136 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:49:13.654136 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m01:49:13.654136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:13.688499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.688499 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:49:13.690862 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 22:49:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m01:49:13.690862 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m01:49:13.692429 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m01:49:13.692429 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 01:49:13.654136 => 01:49:13.692429
[0m01:49:13.692429 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m01:49:13.693776 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:49:13.693776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585AD8390>]}
[0m01:49:13.693776 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.05s]
[0m01:49:13.693776 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m01:49:13.693776 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m01:49:13.693776 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m01:49:13.693776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m01:49:13.693776 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m01:49:13.701782 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m01:49:13.701782 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 01:49:13.693776 => 01:49:13.701782
[0m01:49:13.701782 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m01:49:13.705164 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m01:49:13.705164 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:49:13.705164 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m01:49:13.705164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:13.734672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.734672 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:49:13.734672 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 22:49:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m01:49:13.734672 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m01:49:13.738504 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m01:49:13.738504 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 01:49:13.701782 => 01:49:13.738504
[0m01:49:13.738504 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m01:49:13.741412 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:49:13.741916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215858C2110>]}
[0m01:49:13.741916 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.05s]
[0m01:49:13.741916 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m01:49:13.741916 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m01:49:13.741916 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m01:49:13.741916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m01:49:13.741916 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m01:49:13.749423 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m01:49:13.750515 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 01:49:13.741916 => 01:49:13.750515
[0m01:49:13.751019 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m01:49:13.765525 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m01:49:13.765525 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:49:13.765525 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m01:49:13.765525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:13.800819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.801890 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:49:13.801890 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 22:49:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m01:49:13.801890 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:49:^S"
LINE 16:     ,'2024-08-06 22:49:^S'::timestamp as dbt_time
              ^

[0m01:49:13.803721 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m01:49:13.803721 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 01:49:13.751019 => 01:49:13.803721
[0m01:49:13.803721 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m01:49:13.806380 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:49:^S"
  LINE 16:     ,'2024-08-06 22:49:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:49:13.806380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585BCCA90>]}
[0m01:49:13.806380 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.06s]
[0m01:49:13.806380 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m01:49:13.806380 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m01:49:13.806380 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m01:49:13.806380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m01:49:13.806380 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m01:49:13.813386 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m01:49:13.813386 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 01:49:13.806380 => 01:49:13.813386
[0m01:49:13.813386 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m01:49:13.815733 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m01:49:13.815733 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:49:13.815733 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m01:49:13.815733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:13.848892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.848892 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:49:13.848892 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 22:49:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m01:49:13.850383 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:49:^S"
LINE 16:     ,'2024-08-06 22:49:^S'::timestamp as dbt_time
              ^

[0m01:49:13.850383 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m01:49:13.851926 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 01:49:13.815733 => 01:49:13.850383
[0m01:49:13.851926 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m01:49:13.851926 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:49:^S"
  LINE 16:     ,'2024-08-06 22:49:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:49:13.851926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b4c715-091d-4d17-b89f-308a2706b3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585BBE550>]}
[0m01:49:13.851926 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.05s]
[0m01:49:13.851926 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m01:49:13.857128 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:13.857128 [debug] [MainThread]: On master: BEGIN
[0m01:49:13.857128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:49:13.889484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:49:13.889484 [debug] [MainThread]: On master: COMMIT
[0m01:49:13.892489 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:13.892489 [debug] [MainThread]: On master: COMMIT
[0m01:49:13.893542 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:49:13.893542 [debug] [MainThread]: On master: Close
[0m01:49:13.894704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:13.894704 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m01:49:13.894704 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m01:49:13.894704 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m01:49:13.894704 [info ] [MainThread]: 
[0m01:49:13.894704 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m01:49:13.894704 [debug] [MainThread]: Command end result
[0m01:49:13.907300 [info ] [MainThread]: 
[0m01:49:13.907300 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m01:49:13.909085 [info ] [MainThread]: 
[0m01:49:13.909085 [error] [MainThread]:   Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: "customer")
  LINE 24: ... ,left(substring(customer.email, postition('@' in customer.e...
                                                                ^
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:49:13.909085 [info ] [MainThread]: 
[0m01:49:13.909085 [error] [MainThread]:   Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:49:13.909085 [info ] [MainThread]: 
[0m01:49:13.909085 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:49:13.909085 [info ] [MainThread]: 
[0m01:49:13.909085 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:49:13.909085 [info ] [MainThread]: 
[0m01:49:13.909085 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:49:^S"
  LINE 16:     ,'2024-08-06 22:49:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:49:13.909085 [info ] [MainThread]: 
[0m01:49:13.914727 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:49:^S"
  LINE 16:     ,'2024-08-06 22:49:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:49:13.914727 [info ] [MainThread]: 
[0m01:49:13.914727 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m01:49:13.916587 [debug] [MainThread]: Command `dbt run` failed at 01:49:13.916587 after 1.14 seconds
[0m01:49:13.916587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215843A9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215837D2C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215856BDD10>]}
[0m01:49:13.916587 [debug] [MainThread]: Flushing usage events
[0m01:51:59.554521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013032523410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001303251B5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130325BD7D0>]}


============================== 01:51:59.558156 | f79da8fd-991c-4ed2-835f-0aaa13a0b4d9 ==============================
[0m01:51:59.558156 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:51:59.558156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:51:59.708080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013032B93F90>]}
[0m01:51:59.786621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130321FA550>]}
[0m01:51:59.786621 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:51:59.793907 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:51:59.896868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:51:59.896868 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_customer.sql
[0m01:52:00.103975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013033F48650>]}
[0m01:52:00.119530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013033F74590>]}
[0m01:52:00.119530 [info ] [MainThread]: Found 6 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m01:52:00.119530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013033D9F750>]}
[0m01:52:00.119530 [info ] [MainThread]: 
[0m01:52:00.119530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:52:00.119530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m01:52:00.126978 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m01:52:00.134501 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m01:52:00.134501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:00.163879 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:52:00.163879 [debug] [ThreadPool]: On list_chinook: Close
[0m01:52:00.166382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m01:52:00.169984 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:52:00.169984 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m01:52:00.169984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:00.198491 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.198491 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:52:00.198491 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m01:52:00.201577 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m01:52:00.201577 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m01:52:00.206148 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m01:52:00.208553 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:00.210460 [debug] [MainThread]: On master: BEGIN
[0m01:52:00.210460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:00.237037 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.237037 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:00.237037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:52:00.239806 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m01:52:00.246309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013034083090>]}
[0m01:52:00.247379 [debug] [MainThread]: On master: ROLLBACK
[0m01:52:00.247379 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:00.247379 [debug] [MainThread]: On master: BEGIN
[0m01:52:00.248444 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.248947 [debug] [MainThread]: On master: COMMIT
[0m01:52:00.248947 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:00.248947 [debug] [MainThread]: On master: COMMIT
[0m01:52:00.250049 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:52:00.250552 [debug] [MainThread]: On master: Close
[0m01:52:00.250552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:00.250552 [info ] [MainThread]: 
[0m01:52:00.252800 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m01:52:00.254637 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m01:52:00.254637 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m01:52:00.254637 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m01:52:00.261994 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m01:52:00.261994 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 01:52:00.256492 => 01:52:00.261994
[0m01:52:00.263330 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m01:52:00.277748 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m01:52:00.277748 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:52:00.277748 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m01:52:00.293462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:00.320006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.320006 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:52:00.320006 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customer_id
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supporteid
    ,customer.last_update
    ,'2024-08-06 22:51:^S'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m01:52:00.322192 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец customer.customer_id не существует
LINE 12:     select customer.customer_id
                    ^
HINT:  Возможно, предполагалась ссылка на столбец "customer.customerid".

[0m01:52:00.322694 [debug] [Thread-1 (]: On model.chinook.dim_customer: ROLLBACK
[0m01:52:00.322694 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 01:52:00.263330 => 01:52:00.322694
[0m01:52:00.323716 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m01:52:00.325162 [debug] [Thread-1 (]: Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  столбец customer.customer_id не существует
  LINE 12:     select customer.customer_id
                      ^
  HINT:  Возможно, предполагалась ссылка на столбец "customer.customerid".
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:52:00.327607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001303412D010>]}
[0m01:52:00.328109 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model chinook_dwh.dim_customer ................. [[31mERROR[0m in 0.07s]
[0m01:52:00.329302 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m01:52:00.329302 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m01:52:00.329302 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m01:52:00.331233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m01:52:00.331233 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m01:52:00.332694 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m01:52:00.332694 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 01:52:00.331233 => 01:52:00.332694
[0m01:52:00.332694 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m01:52:00.338198 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m01:52:00.338198 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:52:00.338198 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m01:52:00.338198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:00.367348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.367348 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:52:00.367348 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,db.department_name
    ,db.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 22:51:^S'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."department_budget" db on emp.department_id = db.department_id
  );
  
[0m01:52:00.370556 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  отношение "stg.department_budget" не существует
LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                  ^

[0m01:52:00.370556 [debug] [Thread-1 (]: On model.chinook.dim_employee: ROLLBACK
[0m01:52:00.370556 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 01:52:00.336233 => 01:52:00.370556
[0m01:52:00.371991 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m01:52:00.374484 [debug] [Thread-1 (]: Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:52:00.374484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001303411F3D0>]}
[0m01:52:00.374484 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model chinook_dwh.dim_employee ................. [[31mERROR[0m in 0.04s]
[0m01:52:00.374484 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m01:52:00.374484 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m01:52:00.374484 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m01:52:00.374484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m01:52:00.374484 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m01:52:00.374484 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m01:52:00.374484 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 01:52:00.374484 => 01:52:00.374484
[0m01:52:00.374484 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m01:52:00.387042 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m01:52:00.388545 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:52:00.388545 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m01:52:00.388545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:00.416210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.416210 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:52:00.416210 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 22:51:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m01:52:00.416210 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m01:52:00.419715 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m01:52:00.419715 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 01:52:00.385402 => 01:52:00.419715
[0m01:52:00.420827 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m01:52:00.422741 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:52:00.422741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013032D3F210>]}
[0m01:52:00.423950 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.05s]
[0m01:52:00.423950 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m01:52:00.423950 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m01:52:00.423950 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m01:52:00.423950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m01:52:00.426606 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m01:52:00.429566 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m01:52:00.429566 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 01:52:00.426606 => 01:52:00.429566
[0m01:52:00.429566 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m01:52:00.435544 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m01:52:00.439926 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:52:00.448687 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m01:52:00.448687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:00.475850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.477245 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:52:00.477245 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 22:51:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m01:52:00.478394 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m01:52:00.478394 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m01:52:00.478394 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 01:52:00.431538 => 01:52:00.478394
[0m01:52:00.478394 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m01:52:00.482111 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:52:00.482111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130341F6A50>]}
[0m01:52:00.483614 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.06s]
[0m01:52:00.483614 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m01:52:00.484618 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m01:52:00.484618 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m01:52:00.484618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m01:52:00.484618 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m01:52:00.488169 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m01:52:00.488169 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 01:52:00.486562 => 01:52:00.488169
[0m01:52:00.488169 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m01:52:00.500714 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m01:52:00.500714 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:52:00.500714 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m01:52:00.500714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:00.541044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.541044 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:52:00.541044 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 22:51:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m01:52:00.543404 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:51:^S"
LINE 16:     ,'2024-08-06 22:51:^S'::timestamp as dbt_time
              ^

[0m01:52:00.543404 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m01:52:00.543404 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 01:52:00.488169 => 01:52:00.543404
[0m01:52:00.545604 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m01:52:00.547119 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:51:^S"
  LINE 16:     ,'2024-08-06 22:51:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:52:00.547119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013033F92E50>]}
[0m01:52:00.548458 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.06s]
[0m01:52:00.548458 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m01:52:00.548458 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m01:52:00.550425 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m01:52:00.550425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m01:52:00.550425 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m01:52:00.550425 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m01:52:00.550425 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 01:52:00.550425 => 01:52:00.550425
[0m01:52:00.550425 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m01:52:00.556975 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m01:52:00.556975 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:52:00.556975 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m01:52:00.556975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:00.588030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.588030 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:52:00.588030 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 22:51:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m01:52:00.590146 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:51:^S"
LINE 16:     ,'2024-08-06 22:51:^S'::timestamp as dbt_time
              ^

[0m01:52:00.590146 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m01:52:00.590146 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 01:52:00.550425 => 01:52:00.590146
[0m01:52:00.590146 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m01:52:00.593748 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:51:^S"
  LINE 16:     ,'2024-08-06 22:51:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:52:00.593748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f79da8fd-991c-4ed2-835f-0aaa13a0b4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013033D61810>]}
[0m01:52:00.594838 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.04s]
[0m01:52:00.594838 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m01:52:00.596485 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:00.596485 [debug] [MainThread]: On master: BEGIN
[0m01:52:00.596485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:00.624727 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:52:00.624727 [debug] [MainThread]: On master: COMMIT
[0m01:52:00.626232 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:00.626232 [debug] [MainThread]: On master: COMMIT
[0m01:52:00.627287 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:52:00.627287 [debug] [MainThread]: On master: Close
[0m01:52:00.627287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:00.627287 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m01:52:00.627287 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m01:52:00.627287 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m01:52:00.627287 [info ] [MainThread]: 
[0m01:52:00.630096 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m01:52:00.631425 [debug] [MainThread]: Command end result
[0m01:52:00.638593 [info ] [MainThread]: 
[0m01:52:00.638593 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m01:52:00.638593 [info ] [MainThread]: 
[0m01:52:00.638593 [error] [MainThread]:   Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  столбец customer.customer_id не существует
  LINE 12:     select customer.customer_id
                      ^
  HINT:  Возможно, предполагалась ссылка на столбец "customer.customerid".
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:52:00.638593 [info ] [MainThread]: 
[0m01:52:00.638593 [error] [MainThread]:   Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:52:00.638593 [info ] [MainThread]: 
[0m01:52:00.638593 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:52:00.638593 [info ] [MainThread]: 
[0m01:52:00.642272 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:52:00.642775 [info ] [MainThread]: 
[0m01:52:00.642775 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:51:^S"
  LINE 16:     ,'2024-08-06 22:51:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:52:00.642775 [info ] [MainThread]: 
[0m01:52:00.642775 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:51:^S"
  LINE 16:     ,'2024-08-06 22:51:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:52:00.644465 [info ] [MainThread]: 
[0m01:52:00.644465 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m01:52:00.645603 [debug] [MainThread]: Command `dbt run` failed at 01:52:00.645603 after 1.13 seconds
[0m01:52:00.646655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130325181D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013032611710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013031D25750>]}
[0m01:52:00.646655 [debug] [MainThread]: Flushing usage events
[0m01:52:32.556999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023259C0D4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023259C0D390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023259B74AD0>]}


============================== 01:52:32.556999 | 955233bd-72d0-4c37-97f8-afaa45cc08e7 ==============================
[0m01:52:32.556999 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:52:32.556999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:52:32.721004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023257FB3A50>]}
[0m01:52:32.783508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325A16E190>]}
[0m01:52:32.783508 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:52:32.794948 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:52:32.910601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:52:32.910601 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_customer.sql
[0m01:52:33.115925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B54F2D0>]}
[0m01:52:33.131551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B71CE10>]}
[0m01:52:33.131551 [info ] [MainThread]: Found 6 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m01:52:33.133355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B3F37D0>]}
[0m01:52:33.133355 [info ] [MainThread]: 
[0m01:52:33.133355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:52:33.133355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m01:52:33.138296 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m01:52:33.138296 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m01:52:33.138296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:33.175408 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:52:33.175408 [debug] [ThreadPool]: On list_chinook: Close
[0m01:52:33.177222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m01:52:33.181506 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:52:33.181506 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m01:52:33.181506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:33.207611 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.207611 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:52:33.210727 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m01:52:33.214721 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m01:52:33.214721 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m01:52:33.214721 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m01:52:33.217759 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:33.217759 [debug] [MainThread]: On master: BEGIN
[0m01:52:33.217759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:33.248129 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.248129 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:33.248129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:52:33.253846 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m01:52:33.253846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B41C310>]}
[0m01:52:33.257469 [debug] [MainThread]: On master: ROLLBACK
[0m01:52:33.257469 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:33.257469 [debug] [MainThread]: On master: BEGIN
[0m01:52:33.258474 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.258474 [debug] [MainThread]: On master: COMMIT
[0m01:52:33.258474 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:33.260031 [debug] [MainThread]: On master: COMMIT
[0m01:52:33.260031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:52:33.260031 [debug] [MainThread]: On master: Close
[0m01:52:33.260031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:33.260031 [info ] [MainThread]: 
[0m01:52:33.262307 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m01:52:33.265349 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m01:52:33.265349 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m01:52:33.265349 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m01:52:33.267872 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m01:52:33.267872 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 01:52:33.265349 => 01:52:33.267872
[0m01:52:33.267872 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m01:52:33.290082 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m01:52:33.290082 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:52:33.290082 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m01:52:33.290082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:33.322102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.322102 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:52:33.322102 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supporteid
    ,customer.last_update
    ,'2024-08-06 22:52:^S'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m01:52:33.334492 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец customer.supporteid не существует
LINE 25:     ,customer.supporteid
              ^
HINT:  Возможно, предполагалась ссылка на столбец "customer.supportrepid".

[0m01:52:33.334492 [debug] [Thread-1 (]: On model.chinook.dim_customer: ROLLBACK
[0m01:52:33.334492 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 01:52:33.274380 => 01:52:33.334492
[0m01:52:33.334492 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m01:52:33.337995 [debug] [Thread-1 (]: Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  столбец customer.supporteid не существует
  LINE 25:     ,customer.supporteid
                ^
  HINT:  Возможно, предполагалась ссылка на столбец "customer.supportrepid".
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:52:33.340071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B778F50>]}
[0m01:52:33.340071 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model chinook_dwh.dim_customer ................. [[31mERROR[0m in 0.07s]
[0m01:52:33.340071 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m01:52:33.340071 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m01:52:33.340071 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m01:52:33.340071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m01:52:33.340071 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m01:52:33.344663 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m01:52:33.347328 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 01:52:33.340071 => 01:52:33.344663
[0m01:52:33.347328 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m01:52:33.347328 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m01:52:33.351025 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:52:33.351025 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m01:52:33.351025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:33.379819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.379819 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:52:33.379819 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,db.department_name
    ,db.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 22:52:^S'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."department_budget" db on emp.department_id = db.department_id
  );
  
[0m01:52:33.382787 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  отношение "stg.department_budget" не существует
LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                  ^

[0m01:52:33.382787 [debug] [Thread-1 (]: On model.chinook.dim_employee: ROLLBACK
[0m01:52:33.382787 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 01:52:33.347328 => 01:52:33.382787
[0m01:52:33.384109 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m01:52:33.385613 [debug] [Thread-1 (]: Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:52:33.385613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B72C650>]}
[0m01:52:33.385613 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model chinook_dwh.dim_employee ................. [[31mERROR[0m in 0.05s]
[0m01:52:33.385613 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m01:52:33.385613 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m01:52:33.389037 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m01:52:33.389037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m01:52:33.389037 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m01:52:33.389037 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m01:52:33.389037 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 01:52:33.389037 => 01:52:33.389037
[0m01:52:33.389037 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m01:52:33.389037 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m01:52:33.401546 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:52:33.401546 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m01:52:33.401546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:33.429253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.429253 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:52:33.429253 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 22:52:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m01:52:33.429253 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m01:52:33.429253 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m01:52:33.429253 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 01:52:33.389037 => 01:52:33.429253
[0m01:52:33.432906 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m01:52:33.434911 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:52:33.434911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B41C310>]}
[0m01:52:33.434911 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.05s]
[0m01:52:33.434911 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m01:52:33.434911 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m01:52:33.434911 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m01:52:33.434911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m01:52:33.434911 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m01:52:33.440550 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m01:52:33.440550 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 01:52:33.434911 => 01:52:33.440550
[0m01:52:33.440550 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m01:52:33.444775 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m01:52:33.444775 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:52:33.444775 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m01:52:33.444775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:33.475165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.475668 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:52:33.475668 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 22:52:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m01:52:33.475668 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m01:52:33.475668 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m01:52:33.475668 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 01:52:33.440550 => 01:52:33.475668
[0m01:52:33.475668 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m01:52:33.480867 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:52:33.480867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B8075D0>]}
[0m01:52:33.480867 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.05s]
[0m01:52:33.480867 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m01:52:33.480867 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m01:52:33.480867 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m01:52:33.480867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m01:52:33.480867 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m01:52:33.485875 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m01:52:33.485875 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 01:52:33.480867 => 01:52:33.485875
[0m01:52:33.485875 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m01:52:33.512604 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m01:52:33.512604 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:52:33.512604 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m01:52:33.514327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:33.536320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.541824 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:52:33.541824 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 22:52:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m01:52:33.541824 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:52:^S"
LINE 16:     ,'2024-08-06 22:52:^S'::timestamp as dbt_time
              ^

[0m01:52:33.541824 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m01:52:33.544448 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 01:52:33.485875 => 01:52:33.544448
[0m01:52:33.544448 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m01:52:33.547050 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:52:^S"
  LINE 16:     ,'2024-08-06 22:52:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:52:33.548102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B5AEF10>]}
[0m01:52:33.548102 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.07s]
[0m01:52:33.548102 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m01:52:33.548102 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m01:52:33.548102 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m01:52:33.548102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m01:52:33.551344 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m01:52:33.554641 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m01:52:33.555144 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 01:52:33.551344 => 01:52:33.555144
[0m01:52:33.555144 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m01:52:33.557931 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m01:52:33.559870 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:52:33.559870 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m01:52:33.561154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:33.693968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.693968 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:52:33.693968 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 22:52:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m01:52:33.695654 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:52:^S"
LINE 16:     ,'2024-08-06 22:52:^S'::timestamp as dbt_time
              ^

[0m01:52:33.695654 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m01:52:33.695654 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 01:52:33.555144 => 01:52:33.695654
[0m01:52:33.695654 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m01:52:33.699418 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:52:^S"
  LINE 16:     ,'2024-08-06 22:52:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:52:33.699418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955233bd-72d0-4c37-97f8-afaa45cc08e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325B5AC250>]}
[0m01:52:33.700547 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.15s]
[0m01:52:33.700547 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m01:52:33.700547 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:33.703447 [debug] [MainThread]: On master: BEGIN
[0m01:52:33.703447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:33.729554 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:52:33.729554 [debug] [MainThread]: On master: COMMIT
[0m01:52:33.729554 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:33.729554 [debug] [MainThread]: On master: COMMIT
[0m01:52:33.729554 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:52:33.732197 [debug] [MainThread]: On master: Close
[0m01:52:33.732197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:33.732197 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m01:52:33.733640 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m01:52:33.733640 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m01:52:33.733640 [info ] [MainThread]: 
[0m01:52:33.733640 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m01:52:33.733640 [debug] [MainThread]: Command end result
[0m01:52:33.736959 [info ] [MainThread]: 
[0m01:52:33.736959 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m01:52:33.736959 [info ] [MainThread]: 
[0m01:52:33.736959 [error] [MainThread]:   Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  столбец customer.supporteid не существует
  LINE 25:     ,customer.supporteid
                ^
  HINT:  Возможно, предполагалась ссылка на столбец "customer.supportrepid".
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:52:33.736959 [info ] [MainThread]: 
[0m01:52:33.736959 [error] [MainThread]:   Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:52:33.736959 [info ] [MainThread]: 
[0m01:52:33.736959 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:52:33.736959 [info ] [MainThread]: 
[0m01:52:33.736959 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:52:33.736959 [info ] [MainThread]: 
[0m01:52:33.747833 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:52:^S"
  LINE 16:     ,'2024-08-06 22:52:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:52:33.747833 [info ] [MainThread]: 
[0m01:52:33.747833 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:52:^S"
  LINE 16:     ,'2024-08-06 22:52:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:52:33.747833 [info ] [MainThread]: 
[0m01:52:33.747833 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m01:52:33.747833 [debug] [MainThread]: Command `dbt run` failed at 01:52:33.747833 after 1.23 seconds
[0m01:52:33.750784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023259941A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023259E8C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325A031E90>]}
[0m01:52:33.750784 [debug] [MainThread]: Flushing usage events
[0m01:53:24.070183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F616FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F617AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F616D390>]}


============================== 01:53:24.072354 | f5040336-a44d-4c4a-8d7d-52849eea063f ==============================
[0m01:53:24.072354 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:53:24.072354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:53:24.277325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6516F90>]}
[0m01:53:24.343550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F61F3E50>]}
[0m01:53:24.343550 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:53:24.353055 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:53:24.467107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:53:24.467107 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_customer.sql
[0m01:53:24.679293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F7E1DAD0>]}
[0m01:53:24.691091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F7FEE910>]}
[0m01:53:24.691091 [info ] [MainThread]: Found 6 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m01:53:24.691091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F7CBF690>]}
[0m01:53:24.696068 [info ] [MainThread]: 
[0m01:53:24.696068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:53:24.697615 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m01:53:24.708298 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m01:53:24.708298 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m01:53:24.708298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:24.734970 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:53:24.734970 [debug] [ThreadPool]: On list_chinook: Close
[0m01:53:24.749476 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m01:53:24.754532 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:53:24.755552 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m01:53:24.755552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:24.788869 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:53:24.788869 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:53:24.788869 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m01:53:24.795899 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m01:53:24.798027 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m01:53:24.798027 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m01:53:24.803898 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:24.803898 [debug] [MainThread]: On master: BEGIN
[0m01:53:24.803898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:53:24.836436 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:53:24.836436 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:24.836436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:53:24.845794 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m01:53:24.845794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F7C84B10>]}
[0m01:53:24.845794 [debug] [MainThread]: On master: ROLLBACK
[0m01:53:24.845794 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:24.845794 [debug] [MainThread]: On master: BEGIN
[0m01:53:24.845794 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:53:24.845794 [debug] [MainThread]: On master: COMMIT
[0m01:53:24.845794 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:24.845794 [debug] [MainThread]: On master: COMMIT
[0m01:53:24.845794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:53:24.845794 [debug] [MainThread]: On master: Close
[0m01:53:24.845794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:53:24.852013 [info ] [MainThread]: 
[0m01:53:24.852013 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m01:53:24.855372 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m01:53:24.855372 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m01:53:24.856896 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m01:53:24.862981 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m01:53:24.862981 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 01:53:24.856896 => 01:53:24.862981
[0m01:53:24.865074 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m01:53:24.893250 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m01:53:24.893250 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:53:24.893250 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m01:53:24.893250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:53:24.924299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:24.924299 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:53:24.924299 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-06 22:53:^S'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m01:53:24.930113 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
LINE 27:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
              ^

[0m01:53:24.930113 [debug] [Thread-1 (]: On model.chinook.dim_customer: ROLLBACK
[0m01:53:24.930113 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 01:53:24.865074 => 01:53:24.930113
[0m01:53:24.930113 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m01:53:24.936741 [debug] [Thread-1 (]: Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
  LINE 27:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:53:24.936741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8038650>]}
[0m01:53:24.936741 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model chinook_dwh.dim_customer ................. [[31mERROR[0m in 0.08s]
[0m01:53:24.936741 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m01:53:24.936741 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m01:53:24.940315 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m01:53:24.940860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m01:53:24.941863 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m01:53:24.945439 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m01:53:24.946536 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 01:53:24.941863 => 01:53:24.946536
[0m01:53:24.946536 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m01:53:24.951076 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m01:53:24.951076 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:53:24.951076 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m01:53:24.951076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:24.988752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:24.988752 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:53:24.988752 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,db.department_name
    ,db.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 22:53:^S'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."department_budget" db on emp.department_id = db.department_id
  );
  
[0m01:53:24.990916 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  отношение "stg.department_budget" не существует
LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                  ^

[0m01:53:24.990916 [debug] [Thread-1 (]: On model.chinook.dim_employee: ROLLBACK
[0m01:53:24.990916 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 01:53:24.946536 => 01:53:24.990916
[0m01:53:24.993105 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m01:53:24.995336 [debug] [Thread-1 (]: Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:53:24.995336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F7DEA810>]}
[0m01:53:24.995336 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model chinook_dwh.dim_employee ................. [[31mERROR[0m in 0.05s]
[0m01:53:24.995336 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m01:53:24.995336 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m01:53:24.995336 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m01:53:24.995336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m01:53:24.995336 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m01:53:25.007474 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m01:53:25.007474 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 01:53:24.995336 => 01:53:25.007474
[0m01:53:25.007474 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m01:53:25.015675 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m01:53:25.015675 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:53:25.015675 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m01:53:25.015675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:25.050229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:25.050229 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:53:25.051896 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 22:53:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m01:53:25.051896 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m01:53:25.051896 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m01:53:25.051896 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 01:53:25.007474 => 01:53:25.051896
[0m01:53:25.055436 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m01:53:25.056887 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:53:25.056887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F7FB5ED0>]}
[0m01:53:25.056887 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.06s]
[0m01:53:25.056887 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m01:53:25.056887 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m01:53:25.062223 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m01:53:25.062223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m01:53:25.062223 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m01:53:25.067724 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m01:53:25.067724 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 01:53:25.064220 => 01:53:25.067724
[0m01:53:25.067724 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m01:53:25.067724 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m01:53:25.067724 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:53:25.067724 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m01:53:25.067724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:25.108516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:25.108516 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:53:25.108516 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 22:53:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m01:53:25.111403 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m01:53:25.111403 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m01:53:25.111403 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 01:53:25.067724 => 01:53:25.111403
[0m01:53:25.111403 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m01:53:25.115370 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:53:25.115370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F80C6790>]}
[0m01:53:25.115370 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.05s]
[0m01:53:25.115370 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m01:53:25.115370 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m01:53:25.118547 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m01:53:25.118547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m01:53:25.118547 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m01:53:25.125966 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m01:53:25.125966 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 01:53:25.118547 => 01:53:25.125966
[0m01:53:25.125966 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m01:53:25.150799 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m01:53:25.150799 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:53:25.154800 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m01:53:25.154800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:25.185607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:25.185607 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:53:25.185607 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 22:53:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m01:53:25.188016 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
LINE 16:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
              ^

[0m01:53:25.188016 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m01:53:25.188016 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 01:53:25.127750 => 01:53:25.188016
[0m01:53:25.190256 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m01:53:25.190256 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
  LINE 16:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:53:25.193266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F7CD6B50>]}
[0m01:53:25.193266 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.07s]
[0m01:53:25.193266 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m01:53:25.193266 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m01:53:25.193266 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m01:53:25.193266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m01:53:25.193266 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m01:53:25.199408 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m01:53:25.200907 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 01:53:25.193266 => 01:53:25.200907
[0m01:53:25.200907 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m01:53:25.202058 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m01:53:25.202058 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:53:25.202058 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m01:53:25.207292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:25.237821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:25.237821 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:53:25.237821 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 22:53:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m01:53:25.240325 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
LINE 16:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
              ^

[0m01:53:25.240325 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m01:53:25.240325 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 01:53:25.202058 => 01:53:25.240325
[0m01:53:25.241953 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m01:53:25.243287 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
  LINE 16:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:53:25.243287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5040336-a44d-4c4a-8d7d-52849eea063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F7E23E90>]}
[0m01:53:25.243287 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.05s]
[0m01:53:25.243287 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m01:53:25.247302 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:25.247302 [debug] [MainThread]: On master: BEGIN
[0m01:53:25.247302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:53:25.277364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:53:25.277364 [debug] [MainThread]: On master: COMMIT
[0m01:53:25.277364 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:25.277364 [debug] [MainThread]: On master: COMMIT
[0m01:53:25.277364 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:53:25.279848 [debug] [MainThread]: On master: Close
[0m01:53:25.279848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:53:25.279848 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m01:53:25.281220 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m01:53:25.281220 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m01:53:25.281220 [info ] [MainThread]: 
[0m01:53:25.281220 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m01:53:25.284158 [debug] [MainThread]: Command end result
[0m01:53:25.290878 [info ] [MainThread]: 
[0m01:53:25.292741 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m01:53:25.292741 [info ] [MainThread]: 
[0m01:53:25.292741 [error] [MainThread]:   Database Error in model dim_customer (models\dimensions\dim_customer.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
  LINE 27:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\dimensions\dim_customer.sql
[0m01:53:25.294145 [info ] [MainThread]: 
[0m01:53:25.294145 [error] [MainThread]:   Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:53:25.294145 [info ] [MainThread]: 
[0m01:53:25.294145 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:53:25.296208 [info ] [MainThread]: 
[0m01:53:25.296208 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:53:25.296208 [info ] [MainThread]: 
[0m01:53:25.296208 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
  LINE 16:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:53:25.298461 [info ] [MainThread]: 
[0m01:53:25.298461 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:53:^S"
  LINE 16:     ,'2024-08-06 22:53:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:53:25.298461 [info ] [MainThread]: 
[0m01:53:25.299790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m01:53:25.299790 [debug] [MainThread]: Command `dbt run` failed at 01:53:25.299790 after 1.27 seconds
[0m01:53:25.301129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6956F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F616F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F64D3110>]}
[0m01:53:25.301129 [debug] [MainThread]: Flushing usage events
[0m01:54:06.739040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EA21E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E9F56250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EA2AD390>]}


============================== 01:54:06.739040 | 4862d282-0c1a-425e-afbc-75db20666751 ==============================
[0m01:54:06.739040 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:54:06.739040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:54:06.913582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EA82EF10>]}
[0m01:54:06.980493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EA1F8710>]}
[0m01:54:06.980493 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:54:06.990743 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:54:07.089069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:54:07.089069 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_customer.sql
[0m01:54:07.309214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EBBEB710>]}
[0m01:54:07.320410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EBC75190>]}
[0m01:54:07.320410 [info ] [MainThread]: Found 6 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m01:54:07.320410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EBA8EE10>]}
[0m01:54:07.322609 [info ] [MainThread]: 
[0m01:54:07.322609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:54:07.324616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m01:54:07.326557 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m01:54:07.326557 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m01:54:07.326557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:07.362957 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:54:07.362957 [debug] [ThreadPool]: On list_chinook: Close
[0m01:54:07.365275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m01:54:07.367958 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:54:07.367958 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m01:54:07.371961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:07.398272 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.398272 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m01:54:07.398272 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m01:54:07.403590 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m01:54:07.403590 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m01:54:07.405537 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m01:54:07.407441 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:07.407441 [debug] [MainThread]: On master: BEGIN
[0m01:54:07.407441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:07.436006 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.436006 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:07.436006 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:54:07.439356 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m01:54:07.439356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EA99FB90>]}
[0m01:54:07.439356 [debug] [MainThread]: On master: ROLLBACK
[0m01:54:07.439356 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:07.439356 [debug] [MainThread]: On master: BEGIN
[0m01:54:07.448115 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.448618 [debug] [MainThread]: On master: COMMIT
[0m01:54:07.448618 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:07.448618 [debug] [MainThread]: On master: COMMIT
[0m01:54:07.449716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:54:07.450219 [debug] [MainThread]: On master: Close
[0m01:54:07.450219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:07.450219 [info ] [MainThread]: 
[0m01:54:07.453854 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m01:54:07.455010 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m01:54:07.455010 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m01:54:07.455010 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m01:54:07.458532 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m01:54:07.458532 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 01:54:07.455010 => 01:54:07.458532
[0m01:54:07.458532 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m01:54:07.481839 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m01:54:07.481839 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:54:07.481839 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m01:54:07.481839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:54:07.520742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.520742 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:54:07.520742 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-06 22:54:06'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m01:54:07.545440 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m01:54:07.564987 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:54:07.564987 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m01:54:07.564987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:54:07.576895 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m01:54:07.576895 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:54:07.576895 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m01:54:07.584742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:54:07.584742 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m01:54:07.592969 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m01:54:07.592969 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m01:54:07.592969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:54:07.595822 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 01:54:07.458532 => 01:54:07.595822
[0m01:54:07.595822 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m01:54:07.595822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EBDF1CD0>]}
[0m01:54:07.595822 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.14s]
[0m01:54:07.598335 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m01:54:07.599432 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m01:54:07.599934 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m01:54:07.599934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m01:54:07.599934 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m01:54:07.601492 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m01:54:07.601492 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 01:54:07.599934 => 01:54:07.601492
[0m01:54:07.601492 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m01:54:07.607142 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m01:54:07.608645 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:54:07.608645 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m01:54:07.608645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:07.636246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.636246 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m01:54:07.636246 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,db.department_name
    ,db.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 22:54:^S'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."department_budget" db on emp.department_id = db.department_id
  );
  
[0m01:54:07.636246 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  отношение "stg.department_budget" не существует
LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                  ^

[0m01:54:07.639751 [debug] [Thread-1 (]: On model.chinook.dim_employee: ROLLBACK
[0m01:54:07.639751 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 01:54:07.601492 => 01:54:07.639751
[0m01:54:07.640754 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m01:54:07.641879 [debug] [Thread-1 (]: Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:54:07.644677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EBE68450>]}
[0m01:54:07.644677 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model chinook_dwh.dim_employee ................. [[31mERROR[0m in 0.04s]
[0m01:54:07.645923 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m01:54:07.645923 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m01:54:07.647041 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m01:54:07.647544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m01:54:07.647544 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m01:54:07.649861 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m01:54:07.655864 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 01:54:07.647544 => 01:54:07.649861
[0m01:54:07.655864 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m01:54:07.658966 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m01:54:07.658966 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:54:07.658966 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m01:54:07.658966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:07.687705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.687705 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m01:54:07.689014 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 22:54:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m01:54:07.690240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m01:54:07.690240 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m01:54:07.690240 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 01:54:07.655864 => 01:54:07.690240
[0m01:54:07.691695 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m01:54:07.693511 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:54:07.693511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EBA8EE10>]}
[0m01:54:07.693511 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.05s]
[0m01:54:07.695364 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m01:54:07.695866 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m01:54:07.695866 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m01:54:07.695866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m01:54:07.695866 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m01:54:07.699796 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m01:54:07.699796 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 01:54:07.695866 => 01:54:07.699796
[0m01:54:07.699796 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m01:54:07.705573 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m01:54:07.706076 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:54:07.706076 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m01:54:07.707268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:07.731606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.735149 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m01:54:07.735149 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 22:54:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m01:54:07.736262 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m01:54:07.736262 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m01:54:07.736262 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 01:54:07.699796 => 01:54:07.736262
[0m01:54:07.736262 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m01:54:07.740032 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:54:07.740032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EBEF2B10>]}
[0m01:54:07.741281 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.04s]
[0m01:54:07.741281 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m01:54:07.742482 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m01:54:07.742984 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m01:54:07.742984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m01:54:07.742984 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m01:54:07.746209 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m01:54:07.746209 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 01:54:07.742984 => 01:54:07.746209
[0m01:54:07.746209 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m01:54:07.770581 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m01:54:07.770581 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:54:07.770581 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m01:54:07.772125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:07.804152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.804152 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m01:54:07.804152 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 22:54:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m01:54:07.804152 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:54:^S"
LINE 16:     ,'2024-08-06 22:54:^S'::timestamp as dbt_time
              ^

[0m01:54:07.809201 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m01:54:07.809201 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 01:54:07.746209 => 01:54:07.809201
[0m01:54:07.810685 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m01:54:07.812219 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:54:^S"
  LINE 16:     ,'2024-08-06 22:54:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:54:07.813927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EAA0CE50>]}
[0m01:54:07.814930 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.07s]
[0m01:54:07.814930 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m01:54:07.814930 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m01:54:07.816718 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m01:54:07.816718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m01:54:07.816718 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m01:54:07.816718 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m01:54:07.816718 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 01:54:07.816718 => 01:54:07.816718
[0m01:54:07.824518 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m01:54:07.824518 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m01:54:07.831021 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:54:07.831021 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m01:54:07.831021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:07.863089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.863089 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m01:54:07.863089 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 22:54:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m01:54:07.863089 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:54:^S"
LINE 16:     ,'2024-08-06 22:54:^S'::timestamp as dbt_time
              ^

[0m01:54:07.863089 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m01:54:07.874532 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 01:54:07.824518 => 01:54:07.863089
[0m01:54:07.874532 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m01:54:07.877072 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:54:^S"
  LINE 16:     ,'2024-08-06 22:54:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:54:07.878438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4862d282-0c1a-425e-afbc-75db20666751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EBDBA310>]}
[0m01:54:07.878438 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.06s]
[0m01:54:07.878438 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m01:54:07.880938 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:07.880938 [debug] [MainThread]: On master: BEGIN
[0m01:54:07.880938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:07.915568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:54:07.915568 [debug] [MainThread]: On master: COMMIT
[0m01:54:07.915568 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:07.915568 [debug] [MainThread]: On master: COMMIT
[0m01:54:07.921099 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:54:07.921099 [debug] [MainThread]: On master: Close
[0m01:54:07.921099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:07.921099 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m01:54:07.921099 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m01:54:07.921099 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m01:54:07.921099 [info ] [MainThread]: 
[0m01:54:07.921099 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m01:54:07.925847 [debug] [MainThread]: Command end result
[0m01:54:07.925847 [info ] [MainThread]: 
[0m01:54:07.925847 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m01:54:07.941598 [info ] [MainThread]: 
[0m01:54:07.942101 [error] [MainThread]:   Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  отношение "stg.department_budget" не существует
  LINE 22:     JOIN "chinook"."stg"."department_budget" db on emp.depar...
                    ^
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m01:54:07.942101 [info ] [MainThread]: 
[0m01:54:07.942101 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m01:54:07.942101 [info ] [MainThread]: 
[0m01:54:07.942101 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m01:54:07.942101 [info ] [MainThread]: 
[0m01:54:07.942101 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:54:^S"
  LINE 16:     ,'2024-08-06 22:54:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m01:54:07.942101 [info ] [MainThread]: 
[0m01:54:07.947265 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 22:54:^S"
  LINE 16:     ,'2024-08-06 22:54:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m01:54:07.947265 [info ] [MainThread]: 
[0m01:54:07.947265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=0 TOTAL=6
[0m01:54:07.948885 [debug] [MainThread]: Command `dbt run` failed at 01:54:07.948885 after 1.24 seconds
[0m01:54:07.949974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EA74DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E2EB57D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E2EB6350>]}
[0m01:54:07.949974 [debug] [MainThread]: Flushing usage events
[0m01:56:32.828563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002541958A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254178F3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002541985FE90>]}


============================== 01:56:32.828563 | 8fbe54a6-d8e5-4e99-8753-beff6b770b1b ==============================
[0m01:56:32.828563 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:56:32.828563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:56:33.003244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fbe54a6-d8e5-4e99-8753-beff6b770b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025419DC60D0>]}
[0m01:56:33.064134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fbe54a6-d8e5-4e99-8753-beff6b770b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254197A4850>]}
[0m01:56:33.064134 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:56:33.076539 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:56:33.190092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:56:33.191646 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_employee.sql
[0m01:56:33.379110 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.chinook.dim_employee' (models\dimensions\dim_employee.sql) depends on a source named 'stg.budget' which was not found
[0m01:56:33.379110 [debug] [MainThread]: Command `dbt run` failed at 01:56:33.379110 after 0.59 seconds
[0m01:56:33.379110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254196E8B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025419CB6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025419CB7890>]}
[0m01:56:33.379110 [debug] [MainThread]: Flushing usage events
[0m01:58:16.469646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C5EEBFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C5CB18D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C63E9FD0>]}


============================== 01:58:16.473151 | 6547ad97-4692-4de7-9891-24c695e9ce3d ==============================
[0m01:58:16.473151 [info ] [MainThread]: Running with dbt=1.7.6
[0m01:58:16.473151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:58:16.629686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6547ad97-4692-4de7-9891-24c695e9ce3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C6594F10>]}
[0m01:58:16.692463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6547ad97-4692-4de7-9891-24c695e9ce3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C64FF150>]}
[0m01:58:16.692463 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m01:58:16.709161 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m01:58:16.818539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:58:16.818539 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_employee.sql
[0m01:58:17.007483 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.chinook.dim_employee' (models\dimensions\dim_employee.sql) depends on a source named 'stg.budget' which was not found
[0m01:58:17.007483 [debug] [MainThread]: Command `dbt run` failed at 01:58:17.007483 after 0.58 seconds
[0m01:58:17.007483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C63F78D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C5F035D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C5F02610>]}
[0m01:58:17.007483 [debug] [MainThread]: Flushing usage events
[0m02:00:00.957082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEE1447D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF1C0D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF18D0150>]}


============================== 02:00:00.960209 | b11adc29-8fa1-4a33-b680-f02d0eb1ca39 ==============================
[0m02:00:00.960209 [info ] [MainThread]: Running with dbt=1.7.6
[0m02:00:00.960209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:00:01.113795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b11adc29-8fa1-4a33-b680-f02d0eb1ca39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF2212050>]}
[0m02:00:01.192309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b11adc29-8fa1-4a33-b680-f02d0eb1ca39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF1C60050>]}
[0m02:00:01.192309 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m02:00:01.200779 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m02:00:01.301646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:00:01.301646 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_employee.sql
[0m02:00:01.495172 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.chinook.dim_employee' (models\dimensions\dim_employee.sql) depends on a source named 'stg.budget' which was not found
[0m02:00:01.495172 [debug] [MainThread]: Command `dbt run` failed at 02:00:01.495172 after 0.58 seconds
[0m02:00:01.495172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF1C61AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF0E87950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF201FFD0>]}
[0m02:00:01.495172 [debug] [MainThread]: Flushing usage events
[0m02:00:55.269150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002582ABC8E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258298E7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258298E7710>]}


============================== 02:00:55.272623 | bd4f5f4e-0a71-4b88-acd8-e6df1ebc67c5 ==============================
[0m02:00:55.272623 [info ] [MainThread]: Running with dbt=1.7.6
[0m02:00:55.273637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:00:55.438891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd4f5f4e-0a71-4b88-acd8-e6df1ebc67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002582ADB7710>]}
[0m02:00:55.493643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd4f5f4e-0a71-4b88-acd8-e6df1ebc67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002582A7AE150>]}
[0m02:00:55.493643 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m02:00:55.511412 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m02:00:55.562616 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:00:55.563607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd4f5f4e-0a71-4b88-acd8-e6df1ebc67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002582BE20190>]}
[0m02:00:56.343839 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_currency' in the 'models' section of file 'models\facts\schema.yml'
[0m02:00:56.371368 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.chinook.dim_employee' (models\dimensions\dim_employee.sql) depends on a source named 'stg.budget' which was not found
[0m02:00:56.372368 [debug] [MainThread]: Command `dbt run` failed at 02:00:56.372368 after 1.14 seconds
[0m02:00:56.373368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002582A9C85D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002582ABC9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002582ABC9F50>]}
[0m02:00:56.373368 [debug] [MainThread]: Flushing usage events
[0m02:04:04.179206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACB1A4DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACB1BC190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACB1BCB90>]}


============================== 02:04:04.182218 | 7f6b108a-08a4-4bc4-b993-cf32fac339f2 ==============================
[0m02:04:04.182218 [info ] [MainThread]: Running with dbt=1.7.6
[0m02:04:04.183616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:04:04.350810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f6b108a-08a4-4bc4-b993-cf32fac339f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACB638F90>]}
[0m02:04:04.420105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f6b108a-08a4-4bc4-b993-cf32fac339f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACB782B90>]}
[0m02:04:04.421105 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m02:04:04.428540 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m02:04:04.482552 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:04:04.483553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f6b108a-08a4-4bc4-b993-cf32fac339f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACCA133D0>]}
[0m02:04:05.283997 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_currency' in the 'models' section of file 'models\facts\schema.yml'
[0m02:04:05.306000 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.chinook.dim_employee' (models\dimensions\dim_employee.sql) depends on a source named 'stg.budget' which was not found
[0m02:04:05.306324 [debug] [MainThread]: Command `dbt run` failed at 02:04:05.306324 after 1.16 seconds
[0m02:04:05.307337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACAAF9710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACB1A4DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACB1A4D90>]}
[0m02:04:05.307850 [debug] [MainThread]: Flushing usage events
[0m02:05:49.520697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A290A7B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2902E4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2905B51D0>]}


============================== 02:05:49.520697 | 5d2513e1-e1a4-437c-bd07-90c78122ba99 ==============================
[0m02:05:49.520697 [info ] [MainThread]: Running with dbt=1.7.6
[0m02:05:49.520697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:05:49.688629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d2513e1-e1a4-437c-bd07-90c78122ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2905C4C50>]}
[0m02:05:49.757594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d2513e1-e1a4-437c-bd07-90c78122ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A290A55650>]}
[0m02:05:49.757594 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m02:05:49.764655 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m02:05:49.824889 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:05:49.825930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d2513e1-e1a4-437c-bd07-90c78122ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A290AD9590>]}
[0m02:05:50.608528 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_currency' in the 'models' section of file 'models\facts\schema.yml'
[0m02:05:50.625915 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.chinook.dim_employee' (models\dimensions\dim_employee.sql) depends on a source named 'stg.budget' which was not found
[0m02:05:50.625915 [debug] [MainThread]: Command `dbt run` failed at 02:05:50.625915 after 1.15 seconds
[0m02:05:50.625915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2905AE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28FEA2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28FE98250>]}
[0m02:05:50.625915 [debug] [MainThread]: Flushing usage events
[0m02:07:23.835165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE28DF8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE28DABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE288E79D0>]}


============================== 02:07:23.836700 | a0088f6a-62c8-4771-add9-e59f60bcc668 ==============================
[0m02:07:23.836700 [info ] [MainThread]: Running with dbt=1.7.6
[0m02:07:23.836700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:07:23.998933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0088f6a-62c8-4771-add9-e59f60bcc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE28EEC290>]}
[0m02:07:24.067632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0088f6a-62c8-4771-add9-e59f60bcc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE285F8110>]}
[0m02:07:24.067632 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m02:07:24.075120 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m02:07:24.139367 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:07:24.140368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0088f6a-62c8-4771-add9-e59f60bcc668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2A1832D0>]}
[0m02:07:24.929326 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_currency' in the 'models' section of file 'models\facts\schema.yml'
[0m02:07:24.952629 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.chinook.dim_employee' (models\dimensions\dim_employee.sql) depends on a source named 'stg.budget' which was not found
[0m02:07:24.954268 [debug] [MainThread]: Command `dbt run` failed at 02:07:24.954268 after 1.16 seconds
[0m02:07:24.954268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE28DA9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2A234CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE214B5910>]}
[0m02:07:24.955281 [debug] [MainThread]: Flushing usage events
[0m02:08:43.414288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3C85D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3C798E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3C83CC10>]}


============================== 02:08:43.418733 | c8d72194-ad8e-482c-a12b-ad71cfd420a2 ==============================
[0m02:08:43.418733 [info ] [MainThread]: Running with dbt=1.7.6
[0m02:08:43.418733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:08:43.583728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3CE5D250>]}
[0m02:08:43.646688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3BAA7B50>]}
[0m02:08:43.646688 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m02:08:43.660375 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m02:08:43.718581 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:08:43.718581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3C8ED2D0>]}
[0m02:08:44.578113 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_currency' in the 'models' section of file 'models\facts\schema.yml'
[0m02:08:44.595412 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.chinook.unique_dim_currency_date_rate.abd13cf4bb' (models\facts\schema.yml) depends on a node named 'dim_currency' in package '' which was not found
[0m02:08:44.595412 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.chinook.not_null_dim_currency_date_rate.962b905cf1' (models\facts\schema.yml) depends on a node named 'dim_currency' in package '' which was not found
[0m02:08:44.625858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E37C210>]}
[0m02:08:44.625858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E48B9D0>]}
[0m02:08:44.641486 [info ] [MainThread]: Found 6 models, 12 tests, 12 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m02:08:44.641486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E205490>]}
[0m02:08:44.642984 [info ] [MainThread]: 
[0m02:08:44.644873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:08:44.644873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m02:08:44.647886 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m02:08:44.647886 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m02:08:44.647886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:44.673257 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:08:44.688919 [debug] [ThreadPool]: On list_chinook: Close
[0m02:08:44.688919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m02:08:44.692197 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m02:08:44.692197 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m02:08:44.692197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:44.720738 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:08:44.720738 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m02:08:44.720738 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m02:08:44.720738 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m02:08:44.720738 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m02:08:44.720738 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m02:08:44.737712 [debug] [MainThread]: Using postgres connection "master"
[0m02:08:44.737712 [debug] [MainThread]: On master: BEGIN
[0m02:08:44.737712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:08:44.768306 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:08:44.768306 [debug] [MainThread]: Using postgres connection "master"
[0m02:08:44.768306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:08:44.776746 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:08:44.776746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E18F610>]}
[0m02:08:44.776746 [debug] [MainThread]: On master: ROLLBACK
[0m02:08:44.776746 [debug] [MainThread]: Using postgres connection "master"
[0m02:08:44.776746 [debug] [MainThread]: On master: BEGIN
[0m02:08:44.776746 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:08:44.776746 [debug] [MainThread]: On master: COMMIT
[0m02:08:44.776746 [debug] [MainThread]: Using postgres connection "master"
[0m02:08:44.776746 [debug] [MainThread]: On master: COMMIT
[0m02:08:44.776746 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:08:44.776746 [debug] [MainThread]: On master: Close
[0m02:08:44.784250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:08:44.784250 [info ] [MainThread]: 
[0m02:08:44.786644 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m02:08:44.786644 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m02:08:44.789056 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m02:08:44.789056 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m02:08:44.793898 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m02:08:44.793898 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 02:08:44.789056 => 02:08:44.793898
[0m02:08:44.793898 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m02:08:44.816928 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m02:08:44.816928 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:08:44.816928 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m02:08:44.816928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:08:44.847120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:08:44.847120 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:08:44.847120 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-06 23:08:43'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m02:08:44.862822 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m02:08:44.880057 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:08:44.880057 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m02:08:44.880057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:08:44.880057 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:08:44.880057 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m02:08:44.880057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:08:44.894569 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m02:08:44.894569 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:08:44.894569 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m02:08:44.894569 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:08:44.910207 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m02:08:44.910207 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:08:44.910207 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m02:08:44.910207 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:08:44.910207 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 02:08:44.793898 => 02:08:44.910207
[0m02:08:44.910207 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m02:08:44.910207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3C518190>]}
[0m02:08:44.910207 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.12s]
[0m02:08:44.910207 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m02:08:44.910207 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m02:08:44.910207 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m02:08:44.910207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m02:08:44.910207 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m02:08:44.925542 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m02:08:44.927912 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 02:08:44.910207 => 02:08:44.927912
[0m02:08:44.927912 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m02:08:44.931139 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m02:08:44.931139 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:08:44.931139 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m02:08:44.931139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:45.071145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:08:45.071145 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:08:45.071145 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 23:08:43'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.department_id = b.department_id
  );
  
[0m02:08:45.071145 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец emp.department_id не существует
LINE 22:     JOIN "chinook"."stg"."budget" b on emp.department_id = b...
                                                ^
HINT:  Возможно, предполагалась ссылка на столбец "emp.departmentid".

[0m02:08:45.079669 [debug] [Thread-1 (]: On model.chinook.dim_employee: ROLLBACK
[0m02:08:45.080173 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 02:08:44.929045 => 02:08:45.080173
[0m02:08:45.080173 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m02:08:45.084603 [debug] [Thread-1 (]: Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  столбец emp.department_id не существует
  LINE 22:     JOIN "chinook"."stg"."budget" b on emp.department_id = b...
                                                  ^
  HINT:  Возможно, предполагалась ссылка на столбец "emp.departmentid".
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m02:08:45.084603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E4B7810>]}
[0m02:08:45.084603 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model chinook_dwh.dim_employee ................. [[31mERROR[0m in 0.17s]
[0m02:08:45.084603 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m02:08:45.084603 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m02:08:45.084603 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m02:08:45.084603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m02:08:45.084603 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m02:08:45.090882 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m02:08:45.090882 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 02:08:45.089239 => 02:08:45.090882
[0m02:08:45.090882 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m02:08:45.094553 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m02:08:45.097204 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m02:08:45.097204 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m02:08:45.098613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:45.126984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:08:45.126984 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m02:08:45.128054 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 23:08:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m02:08:45.128054 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m02:08:45.128054 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m02:08:45.138634 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 02:08:45.090882 => 02:08:45.138634
[0m02:08:45.141848 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m02:08:45.141848 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m02:08:45.141848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E4F4550>]}
[0m02:08:45.141848 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.06s]
[0m02:08:45.145866 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m02:08:45.145866 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m02:08:45.145866 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m02:08:45.145866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m02:08:45.145866 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m02:08:45.152771 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m02:08:45.152771 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 02:08:45.145866 => 02:08:45.152771
[0m02:08:45.152771 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m02:08:45.152771 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m02:08:45.152771 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m02:08:45.152771 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m02:08:45.152771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:45.199958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:08:45.199958 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m02:08:45.204440 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 23:08:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m02:08:45.204440 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m02:08:45.204440 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m02:08:45.207084 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 02:08:45.152771 => 02:08:45.207084
[0m02:08:45.207084 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m02:08:45.210446 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m02:08:45.210446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E3F77D0>]}
[0m02:08:45.212810 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.06s]
[0m02:08:45.212810 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m02:08:45.212810 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m02:08:45.215366 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m02:08:45.216468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m02:08:45.216468 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m02:08:45.220698 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m02:08:45.220698 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 02:08:45.217512 => 02:08:45.220698
[0m02:08:45.220698 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m02:08:45.257993 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m02:08:45.257993 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m02:08:45.257993 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m02:08:45.257993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:45.289807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:08:45.289807 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m02:08:45.289807 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 23:08:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m02:08:45.289807 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:08:^S"
LINE 16:     ,'2024-08-06 23:08:^S'::timestamp as dbt_time
              ^

[0m02:08:45.289807 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m02:08:45.302690 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 02:08:45.220698 => 02:08:45.289807
[0m02:08:45.302690 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m02:08:45.305643 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:08:^S"
  LINE 16:     ,'2024-08-06 23:08:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m02:08:45.305643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E5BAFD0>]}
[0m02:08:45.305643 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.09s]
[0m02:08:45.308265 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m02:08:45.308769 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m02:08:45.308769 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m02:08:45.308769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m02:08:45.308769 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m02:08:45.308769 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m02:08:45.308769 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 02:08:45.308769 => 02:08:45.308769
[0m02:08:45.308769 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m02:08:45.317793 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m02:08:45.320797 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m02:08:45.320797 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m02:08:45.322495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:08:45.352134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:08:45.352134 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m02:08:45.352134 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 23:08:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m02:08:45.352134 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:08:^S"
LINE 16:     ,'2024-08-06 23:08:^S'::timestamp as dbt_time
              ^

[0m02:08:45.352134 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m02:08:45.352134 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 02:08:45.308769 => 02:08:45.352134
[0m02:08:45.352134 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m02:08:45.360308 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:08:^S"
  LINE 16:     ,'2024-08-06 23:08:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m02:08:45.360308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d72194-ad8e-482c-a12b-ad71cfd420a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E5A2E10>]}
[0m02:08:45.362006 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.05s]
[0m02:08:45.362006 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m02:08:45.363503 [debug] [MainThread]: Using postgres connection "master"
[0m02:08:45.364007 [debug] [MainThread]: On master: BEGIN
[0m02:08:45.364007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:08:45.383915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:08:45.383915 [debug] [MainThread]: On master: COMMIT
[0m02:08:45.383915 [debug] [MainThread]: Using postgres connection "master"
[0m02:08:45.383915 [debug] [MainThread]: On master: COMMIT
[0m02:08:45.383915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:08:45.383915 [debug] [MainThread]: On master: Close
[0m02:08:45.383915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:08:45.383915 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m02:08:45.383915 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m02:08:45.397927 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m02:08:45.397927 [info ] [MainThread]: 
[0m02:08:45.398432 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m02:08:45.399935 [debug] [MainThread]: Command end result
[0m02:08:45.404912 [info ] [MainThread]: 
[0m02:08:45.404912 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m02:08:45.404912 [info ] [MainThread]: 
[0m02:08:45.404912 [error] [MainThread]:   Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  столбец emp.department_id не существует
  LINE 22:     JOIN "chinook"."stg"."budget" b on emp.department_id = b...
                                                  ^
  HINT:  Возможно, предполагалась ссылка на столбец "emp.departmentid".
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m02:08:45.404912 [info ] [MainThread]: 
[0m02:08:45.410707 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m02:08:45.410707 [info ] [MainThread]: 
[0m02:08:45.410707 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m02:08:45.411957 [info ] [MainThread]: 
[0m02:08:45.412459 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:08:^S"
  LINE 16:     ,'2024-08-06 23:08:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m02:08:45.412459 [info ] [MainThread]: 
[0m02:08:45.412459 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:08:^S"
  LINE 16:     ,'2024-08-06 23:08:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m02:08:45.412459 [info ] [MainThread]: 
[0m02:08:45.412459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=0 TOTAL=6
[0m02:08:45.412459 [debug] [MainThread]: Command `dbt run` failed at 02:08:45.412459 after 2.04 seconds
[0m02:08:45.415721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3C543B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3C8ED250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A353553D0>]}
[0m02:08:45.415721 [debug] [MainThread]: Flushing usage events
[0m02:09:20.457572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD687C8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD683E6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD68805150>]}


============================== 02:09:20.462117 | da75d913-bcf8-4df6-9375-b59a71ea0ac2 ==============================
[0m02:09:20.462117 [info ] [MainThread]: Running with dbt=1.7.6
[0m02:09:20.462117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:09:20.629952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD687C8F90>]}
[0m02:09:20.692490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD688EFDD0>]}
[0m02:09:20.692490 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m02:09:20.692490 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m02:09:20.801942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:09:20.801942 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_employee.sql
[0m02:09:21.005955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69BA4F90>]}
[0m02:09:21.024026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69D64CD0>]}
[0m02:09:21.024026 [info ] [MainThread]: Found 6 models, 12 tests, 12 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m02:09:21.024026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69DC50D0>]}
[0m02:09:21.031540 [info ] [MainThread]: 
[0m02:09:21.031540 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:09:21.031540 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m02:09:21.039172 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m02:09:21.039172 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m02:09:21.039172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:21.069159 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:09:21.069159 [debug] [ThreadPool]: On list_chinook: Close
[0m02:09:21.069159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m02:09:21.069159 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m02:09:21.069159 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m02:09:21.069159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:21.107845 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.108349 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m02:09:21.108349 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m02:09:21.112249 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m02:09:21.113648 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m02:09:21.113648 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m02:09:21.118365 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.118365 [debug] [MainThread]: On master: BEGIN
[0m02:09:21.118365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:09:21.143594 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.143594 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.143594 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:09:21.152050 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:09:21.152050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD689E3F90>]}
[0m02:09:21.152050 [debug] [MainThread]: On master: ROLLBACK
[0m02:09:21.152050 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.152050 [debug] [MainThread]: On master: BEGIN
[0m02:09:21.152050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.152050 [debug] [MainThread]: On master: COMMIT
[0m02:09:21.152050 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.152050 [debug] [MainThread]: On master: COMMIT
[0m02:09:21.152050 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:09:21.152050 [debug] [MainThread]: On master: Close
[0m02:09:21.152050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:09:21.152050 [info ] [MainThread]: 
[0m02:09:21.162521 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m02:09:21.164025 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m02:09:21.164025 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m02:09:21.164025 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m02:09:21.166517 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m02:09:21.166517 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 02:09:21.164025 => 02:09:21.166517
[0m02:09:21.166517 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m02:09:21.196903 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m02:09:21.196903 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:21.196903 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m02:09:21.196903 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:09:21.227154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.227154 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:21.227154 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-06 23:09:20'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m02:09:21.242842 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m02:09:21.242842 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:21.242842 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m02:09:21.242842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:09:21.258467 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:21.259718 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m02:09:21.259718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:09:21.274420 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m02:09:21.274420 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:21.274420 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m02:09:21.274420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:09:21.274420 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m02:09:21.274420 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:21.274420 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m02:09:21.274420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:09:21.290547 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 02:09:21.166517 => 02:09:21.289543
[0m02:09:21.290547 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m02:09:21.290547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69E78450>]}
[0m02:09:21.290547 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.13s]
[0m02:09:21.290547 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m02:09:21.290547 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m02:09:21.290547 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m02:09:21.290547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m02:09:21.290547 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m02:09:21.290547 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m02:09:21.290547 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 02:09:21.290547 => 02:09:21.290547
[0m02:09:21.290547 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m02:09:21.290547 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m02:09:21.290547 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:09:21.290547 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m02:09:21.290547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:21.322534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.322534 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:09:21.322534 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 23:09:20'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.departmentid
  );
  
[0m02:09:21.322534 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец b.departmentid не существует
LINE 22: ... "chinook"."stg"."budget" b on emp.departmentid = b.departme...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "b.department_id".

[0m02:09:21.322534 [debug] [Thread-1 (]: On model.chinook.dim_employee: ROLLBACK
[0m02:09:21.335499 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 02:09:21.290547 => 02:09:21.335499
[0m02:09:21.335499 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m02:09:21.341230 [debug] [Thread-1 (]: Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  столбец b.departmentid не существует
  LINE 22: ... "chinook"."stg"."budget" b on emp.departmentid = b.departme...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "b.department_id".
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m02:09:21.341732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69F4DE90>]}
[0m02:09:21.341732 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model chinook_dwh.dim_employee ................. [[31mERROR[0m in 0.05s]
[0m02:09:21.341732 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m02:09:21.343140 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m02:09:21.343140 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m02:09:21.343140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m02:09:21.343140 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m02:09:21.345614 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m02:09:21.345614 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 02:09:21.343140 => 02:09:21.345614
[0m02:09:21.345614 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m02:09:21.354618 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m02:09:21.354618 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m02:09:21.354618 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m02:09:21.354618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:21.370706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.370706 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m02:09:21.370706 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 23:09:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m02:09:21.386388 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m02:09:21.386388 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m02:09:21.387713 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 02:09:21.345614 => 02:09:21.387713
[0m02:09:21.388788 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m02:09:21.390429 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m02:09:21.390429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69F5F2D0>]}
[0m02:09:21.391531 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.05s]
[0m02:09:21.391531 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m02:09:21.392951 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m02:09:21.392951 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m02:09:21.394256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m02:09:21.394256 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m02:09:21.396207 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m02:09:21.396207 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 02:09:21.394256 => 02:09:21.396207
[0m02:09:21.396207 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m02:09:21.402210 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m02:09:21.402210 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m02:09:21.402210 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m02:09:21.402210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:21.419132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.419132 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m02:09:21.419132 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 23:09:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m02:09:21.433639 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m02:09:21.433639 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m02:09:21.433639 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 02:09:21.396207 => 02:09:21.433639
[0m02:09:21.433639 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m02:09:21.436036 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m02:09:21.436036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69BA5BD0>]}
[0m02:09:21.436036 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.04s]
[0m02:09:21.436036 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m02:09:21.436036 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m02:09:21.436036 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m02:09:21.436036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m02:09:21.436036 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m02:09:21.443473 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m02:09:21.443473 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 02:09:21.436036 => 02:09:21.443473
[0m02:09:21.443473 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m02:09:21.465106 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m02:09:21.465106 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m02:09:21.465106 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m02:09:21.465106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:21.496549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.496549 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m02:09:21.496549 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 23:09:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m02:09:21.496549 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
              ^

[0m02:09:21.501624 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m02:09:21.501624 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 02:09:21.443473 => 02:09:21.501624
[0m02:09:21.501624 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m02:09:21.503095 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
  LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m02:09:21.503095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69ED0950>]}
[0m02:09:21.503095 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.07s]
[0m02:09:21.503095 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m02:09:21.503095 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m02:09:21.503095 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m02:09:21.503095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m02:09:21.503095 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m02:09:21.510893 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m02:09:21.512396 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 02:09:21.503095 => 02:09:21.512396
[0m02:09:21.512396 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m02:09:21.512396 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m02:09:21.512396 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m02:09:21.512396 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m02:09:21.512396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:21.543790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.543790 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m02:09:21.543790 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 23:09:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m02:09:21.548470 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
              ^

[0m02:09:21.548470 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m02:09:21.548470 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 02:09:21.512396 => 02:09:21.548470
[0m02:09:21.548470 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m02:09:21.550600 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
  LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m02:09:21.550600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da75d913-bcf8-4df6-9375-b59a71ea0ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69E884D0>]}
[0m02:09:21.550600 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.05s]
[0m02:09:21.550600 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m02:09:21.550600 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.555986 [debug] [MainThread]: On master: BEGIN
[0m02:09:21.555986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:09:21.575582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:09:21.575582 [debug] [MainThread]: On master: COMMIT
[0m02:09:21.575582 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.575582 [debug] [MainThread]: On master: COMMIT
[0m02:09:21.575582 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:09:21.575582 [debug] [MainThread]: On master: Close
[0m02:09:21.586005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:21.586005 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m02:09:21.586005 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m02:09:21.586005 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m02:09:21.587625 [info ] [MainThread]: 
[0m02:09:21.587625 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:09:21.587625 [debug] [MainThread]: Command end result
[0m02:09:21.592890 [info ] [MainThread]: 
[0m02:09:21.592890 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m02:09:21.592890 [info ] [MainThread]: 
[0m02:09:21.592890 [error] [MainThread]:   Database Error in model dim_employee (models\dimensions\dim_employee.sql)
  ОШИБКА:  столбец b.departmentid не существует
  LINE 22: ... "chinook"."stg"."budget" b on emp.departmentid = b.departme...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "b.department_id".
  compiled Code at target\run\chinook\models\dimensions\dim_employee.sql
[0m02:09:21.592890 [info ] [MainThread]: 
[0m02:09:21.592890 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m02:09:21.592890 [info ] [MainThread]: 
[0m02:09:21.592890 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m02:09:21.592890 [info ] [MainThread]: 
[0m02:09:21.592890 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
  LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m02:09:21.592890 [info ] [MainThread]: 
[0m02:09:21.592890 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
  LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m02:09:21.592890 [info ] [MainThread]: 
[0m02:09:21.592890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=0 TOTAL=6
[0m02:09:21.592890 [debug] [MainThread]: Command `dbt run` failed at 02:09:21.592890 after 1.18 seconds
[0m02:09:21.592890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD68819710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD64FBDD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD69ADDA50>]}
[0m02:09:21.592890 [debug] [MainThread]: Flushing usage events
[0m02:09:50.301972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B63C55D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B5F335D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B5C18A90>]}


============================== 02:09:50.305079 | 79da7fdb-650e-4e09-ad70-5cf68fbadd93 ==============================
[0m02:09:50.305079 [info ] [MainThread]: Running with dbt=1.7.6
[0m02:09:50.306082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:09:50.469009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B63C5950>]}
[0m02:09:50.532074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B6512C50>]}
[0m02:09:50.533074 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m02:09:50.540077 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m02:09:50.649923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:09:50.650925 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_employee.sql
[0m02:09:50.877479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B6002A10>]}
[0m02:09:50.888361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B78EE490>]}
[0m02:09:50.889372 [info ] [MainThread]: Found 6 models, 12 tests, 12 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m02:09:50.889372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B7A10C50>]}
[0m02:09:50.891503 [info ] [MainThread]: 
[0m02:09:50.892574 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:09:50.893575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m02:09:50.905249 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m02:09:50.905249 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m02:09:50.906250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:50.936119 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:09:50.938319 [debug] [ThreadPool]: On list_chinook: Close
[0m02:09:50.939323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m02:09:50.944848 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m02:09:50.944848 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m02:09:50.945850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:50.971705 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:09:50.972707 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m02:09:50.972707 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m02:09:50.977248 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m02:09:50.978249 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m02:09:50.978249 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m02:09:50.982630 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:50.982630 [debug] [MainThread]: On master: BEGIN
[0m02:09:50.982630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:09:51.010734 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.010734 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:51.010734 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:09:51.019333 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:09:51.020333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B6415950>]}
[0m02:09:51.020333 [debug] [MainThread]: On master: ROLLBACK
[0m02:09:51.021333 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:51.021333 [debug] [MainThread]: On master: BEGIN
[0m02:09:51.022334 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.022334 [debug] [MainThread]: On master: COMMIT
[0m02:09:51.022334 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:51.023334 [debug] [MainThread]: On master: COMMIT
[0m02:09:51.023334 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:09:51.023334 [debug] [MainThread]: On master: Close
[0m02:09:51.024334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:09:51.024334 [info ] [MainThread]: 
[0m02:09:51.027335 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m02:09:51.028335 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m02:09:51.029335 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m02:09:51.029335 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m02:09:51.036337 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m02:09:51.037337 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 02:09:51.030335 => 02:09:51.037337
[0m02:09:51.038338 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m02:09:51.076346 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m02:09:51.078346 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:51.078346 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m02:09:51.079347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:09:51.113113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.113113 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:51.114326 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-06 23:09:50'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m02:09:51.135559 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m02:09:51.141966 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:51.141966 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m02:09:51.142981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:09:51.146446 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:51.146446 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m02:09:51.147728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:09:51.166909 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m02:09:51.167911 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:51.167911 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m02:09:51.169486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:09:51.174487 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m02:09:51.178560 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m02:09:51.179562 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m02:09:51.182572 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:09:51.183916 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 02:09:51.038338 => 02:09:51.183916
[0m02:09:51.183916 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m02:09:51.185075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B7ACBC10>]}
[0m02:09:51.185075 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.16s]
[0m02:09:51.186077 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m02:09:51.187149 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m02:09:51.187149 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m02:09:51.188152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m02:09:51.188152 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m02:09:51.192234 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m02:09:51.192234 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 02:09:51.189178 => 02:09:51.192234
[0m02:09:51.193720 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m02:09:51.196727 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m02:09:51.198422 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:09:51.198422 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m02:09:51.198422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:51.228559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.229562 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:09:51.229562 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-06 23:09:50'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m02:09:51.239979 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m02:09:51.244008 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:09:51.244008 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m02:09:51.245010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:09:51.246356 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m02:09:51.247359 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:09:51.247359 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m02:09:51.248597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:09:51.250600 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m02:09:51.251600 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m02:09:51.251600 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m02:09:51.252600 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:09:51.253600 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 02:09:51.193720 => 02:09:51.252600
[0m02:09:51.253600 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m02:09:51.254601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B7B59610>]}
[0m02:09:51.254601 [info ] [Thread-1 (]: 2 of 6 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.07s]
[0m02:09:51.255759 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m02:09:51.255759 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m02:09:51.256761 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m02:09:51.257788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m02:09:51.258291 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m02:09:51.264364 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m02:09:51.264364 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 02:09:51.258795 => 02:09:51.264364
[0m02:09:51.265843 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m02:09:51.268804 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m02:09:51.269805 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m02:09:51.269805 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m02:09:51.270961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:51.299670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.300672 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m02:09:51.300672 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-06 23:09:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m02:09:51.302021 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m02:09:51.302524 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m02:09:51.303028 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 02:09:51.265843 => 02:09:51.303028
[0m02:09:51.303028 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m02:09:51.307090 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m02:09:51.308091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B7AB38D0>]}
[0m02:09:51.309092 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.05s]
[0m02:09:51.309092 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m02:09:51.310092 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m02:09:51.310092 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m02:09:51.311092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m02:09:51.311092 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m02:09:51.314913 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m02:09:51.316289 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 02:09:51.312504 => 02:09:51.316289
[0m02:09:51.316289 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m02:09:51.320210 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m02:09:51.321212 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m02:09:51.321212 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m02:09:51.322221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:51.350895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.351894 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m02:09:51.351894 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-06 23:09:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m02:09:51.352895 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m02:09:51.353896 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m02:09:51.353896 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 02:09:51.316289 => 02:09:51.353896
[0m02:09:51.354897 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m02:09:51.357487 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m02:09:51.357487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B7B4D550>]}
[0m02:09:51.358490 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.05s]
[0m02:09:51.358490 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m02:09:51.359489 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m02:09:51.359489 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m02:09:51.360958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m02:09:51.360958 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m02:09:51.363961 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m02:09:51.364961 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 02:09:51.360958 => 02:09:51.364961
[0m02:09:51.365961 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m02:09:51.388967 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m02:09:51.389966 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m02:09:51.389966 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m02:09:51.390967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:51.419838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.420844 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m02:09:51.420844 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-06 23:09:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m02:09:51.421846 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
              ^

[0m02:09:51.421846 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m02:09:51.422849 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 02:09:51.365961 => 02:09:51.422849
[0m02:09:51.423861 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m02:09:51.425887 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
  LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m02:09:51.426391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B7B4E150>]}
[0m02:09:51.426391 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.07s]
[0m02:09:51.427393 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m02:09:51.428392 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m02:09:51.428392 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m02:09:51.429631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m02:09:51.429631 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m02:09:51.432634 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m02:09:51.433634 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 02:09:51.429631 => 02:09:51.433634
[0m02:09:51.433634 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m02:09:51.439635 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m02:09:51.440636 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m02:09:51.441636 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m02:09:51.441636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:51.470503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.471005 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m02:09:51.471005 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-06 23:09:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m02:09:51.472494 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
              ^

[0m02:09:51.472494 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m02:09:51.473499 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 02:09:51.434634 => 02:09:51.473499
[0m02:09:51.473499 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m02:09:51.476192 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
  LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m02:09:51.476192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79da7fdb-650e-4e09-ad70-5cf68fbadd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B7C02690>]}
[0m02:09:51.477543 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.05s]
[0m02:09:51.477543 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m02:09:51.478904 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:51.480290 [debug] [MainThread]: On master: BEGIN
[0m02:09:51.480290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:09:51.508840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:09:51.509840 [debug] [MainThread]: On master: COMMIT
[0m02:09:51.509840 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:51.510839 [debug] [MainThread]: On master: COMMIT
[0m02:09:51.510839 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:09:51.510839 [debug] [MainThread]: On master: Close
[0m02:09:51.511842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:51.511842 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m02:09:51.513024 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m02:09:51.513529 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m02:09:51.514033 [info ] [MainThread]: 
[0m02:09:51.514033 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m02:09:51.515758 [debug] [MainThread]: Command end result
[0m02:09:51.523321 [info ] [MainThread]: 
[0m02:09:51.524322 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m02:09:51.524322 [info ] [MainThread]: 
[0m02:09:51.525321 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m02:09:51.525321 [info ] [MainThread]: 
[0m02:09:51.526321 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m02:09:51.526321 [info ] [MainThread]: 
[0m02:09:51.526321 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
  LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m02:09:51.527322 [info ] [MainThread]: 
[0m02:09:51.527322 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-06 23:09:^S"
  LINE 16:     ,'2024-08-06 23:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m02:09:51.528321 [info ] [MainThread]: 
[0m02:09:51.528321 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m02:09:51.529321 [debug] [MainThread]: Command `dbt run` failed at 02:09:51.529321 after 1.26 seconds
[0m02:09:51.530322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B5F08A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B5C3C090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B64275D0>]}
[0m02:09:51.530322 [debug] [MainThread]: Flushing usage events
[0m13:05:50.411854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6A052450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6A0520D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6A46F590>]}


============================== 13:05:50.416936 | d1d815d7-72ba-4cd4-b18e-301a033055c5 ==============================
[0m13:05:50.416936 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:05:50.417441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:05:50.646988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6A4ED710>]}
[0m13:05:50.718408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6B700890>]}
[0m13:05:50.719932 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:05:50.725442 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:05:50.852359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:50.852359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:50.852359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6A631310>]}
[0m13:05:50.874375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6B77BF90>]}
[0m13:05:50.874375 [info ] [MainThread]: Found 6 models, 12 tests, 12 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:05:50.874375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6A69DC50>]}
[0m13:05:50.877401 [info ] [MainThread]: 
[0m13:05:50.879626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:50.880881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:05:50.883885 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:05:50.883885 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:05:50.883885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:50.927781 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:05:50.929071 [debug] [ThreadPool]: On list_chinook: Close
[0m13:05:50.931083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:05:50.935594 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:05:50.936098 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:05:50.936603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:50.963506 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:05:50.965740 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:05:50.966248 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:05:50.971840 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m13:05:50.973498 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:05:50.974515 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:05:50.978709 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:50.979215 [debug] [MainThread]: On master: BEGIN
[0m13:05:50.979719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:51.004017 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.004017 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:51.004017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:51.009019 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:05:51.009019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F68C40B90>]}
[0m13:05:51.009019 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:51.009019 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:51.009019 [debug] [MainThread]: On master: BEGIN
[0m13:05:51.009019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.009019 [debug] [MainThread]: On master: COMMIT
[0m13:05:51.009019 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:51.009019 [debug] [MainThread]: On master: COMMIT
[0m13:05:51.009019 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:05:51.009019 [debug] [MainThread]: On master: Close
[0m13:05:51.009019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:51.009019 [info ] [MainThread]: 
[0m13:05:51.025784 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:05:51.026291 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:05:51.027307 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m13:05:51.027813 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:05:51.033366 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:05:51.034895 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:05:51.027813 => 13:05:51.034385
[0m13:05:51.034895 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:05:51.056030 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:05:51.056030 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:05:51.056030 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:05:51.056030 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:51.097546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.097546 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:05:51.097546 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-08 10:05:50'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:05:51.103049 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:05:51.103049 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:05:51.103049 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:05:51.118679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:51.121281 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:05:51.121281 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:05:51.122298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:51.134422 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:05:51.134422 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:05:51.134422 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:05:51.134422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:05:51.134422 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:05:51.134422 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:05:51.134422 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:05:51.150055 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:05:51.150055 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:05:51.034895 => 13:05:51.150055
[0m13:05:51.150055 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:05:51.150055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6B8EA810>]}
[0m13:05:51.150055 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.12s]
[0m13:05:51.150055 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:05:51.150055 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:05:51.150055 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:05:51.150055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:05:51.150055 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:05:51.150055 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:05:51.150055 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:05:51.150055 => 13:05:51.150055
[0m13:05:51.150055 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:05:51.168266 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:05:51.169422 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:05:51.169984 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:05:51.170491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:51.203117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.203622 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:05:51.204128 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-08 10:05:50'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:05:51.213945 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:05:51.217197 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:05:51.217704 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:05:51.218727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:51.221262 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:05:51.221768 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:05:51.222780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:51.224827 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:05:51.224827 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:05:51.225333 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:05:51.226345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:05:51.228939 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:05:51.229953 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:05:51.230460 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:05:51.233022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:05:51.234552 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:05:51.150055 => 13:05:51.234552
[0m13:05:51.235058 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:05:51.236074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6B81A810>]}
[0m13:05:51.236074 [info ] [Thread-1 (]: 2 of 6 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.09s]
[0m13:05:51.236074 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:05:51.238350 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:05:51.238861 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:05:51.239370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:05:51.239887 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:05:51.247060 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:05:51.248090 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:05:51.240395 => 13:05:51.248090
[0m13:05:51.248596 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:05:51.252645 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:05:51.253656 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:05:51.254177 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:05:51.254684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:51.287893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.288939 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:05:51.289446 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-08 10:05:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlist = plt.playlistid
where 1=1
    
  );
  
[0m13:05:51.291165 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец pl.playlist не существует
LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                              ^
HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".

[0m13:05:51.291759 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m13:05:51.292274 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:05:51.249103 => 13:05:51.292274
[0m13:05:51.292782 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:05:51.302898 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m13:05:51.303408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6A5ACAD0>]}
[0m13:05:51.304431 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.06s]
[0m13:05:51.304943 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:05:51.305454 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:05:51.306520 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:05:51.307547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:05:51.308064 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:05:51.313640 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:05:51.314651 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:05:51.308570 => 13:05:51.314651
[0m13:05:51.315162 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:05:51.319227 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:05:51.320239 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:05:51.320745 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:05:51.321251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:51.352808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.352808 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:05:51.352808 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-08 10:05:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:05:51.352808 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m13:05:51.352808 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m13:05:51.352808 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:05:51.315674 => 13:05:51.352808
[0m13:05:51.352808 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:05:51.352808 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m13:05:51.352808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6BA41110>]}
[0m13:05:51.352808 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.05s]
[0m13:05:51.352808 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:05:51.352808 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:05:51.352808 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:05:51.352808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:05:51.352808 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:05:51.352808 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:05:51.368438 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:05:51.352808 => 13:05:51.368438
[0m13:05:51.368438 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:05:51.384065 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:05:51.384065 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:05:51.384065 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:05:51.384065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:51.424884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.425761 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:05:51.426268 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-08 10:05:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m13:05:51.427278 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:05:^S"
LINE 16:     ,'2024-08-08 10:05:^S'::timestamp as dbt_time
              ^

[0m13:05:51.429535 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m13:05:51.430555 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:05:51.368438 => 13:05:51.430050
[0m13:05:51.431102 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:05:51.432124 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:05:^S"
  LINE 16:     ,'2024-08-08 10:05:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m13:05:51.432124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6B6FC650>]}
[0m13:05:51.432124 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.08s]
[0m13:05:51.435081 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:05:51.435592 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:05:51.436101 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:05:51.437121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:05:51.437632 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:05:51.440685 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:05:51.441196 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:05:51.437632 => 13:05:51.441196
[0m13:05:51.441196 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:05:51.446200 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:05:51.446200 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:05:51.446200 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:05:51.446200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:51.579101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.580128 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:05:51.580647 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-08 10:05:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m13:05:51.581660 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:05:^S"
LINE 16:     ,'2024-08-08 10:05:^S'::timestamp as dbt_time
              ^

[0m13:05:51.582408 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m13:05:51.583441 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:05:51.441196 => 13:05:51.582933
[0m13:05:51.583441 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:05:51.586460 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:05:^S"
  LINE 16:     ,'2024-08-08 10:05:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m13:05:51.586460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1d815d7-72ba-4cd4-b18e-301a033055c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6B856510>]}
[0m13:05:51.588187 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.15s]
[0m13:05:51.588694 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:05:51.590463 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:51.590970 [debug] [MainThread]: On master: BEGIN
[0m13:05:51.590970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:51.626747 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:51.627832 [debug] [MainThread]: On master: COMMIT
[0m13:05:51.628350 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:51.628861 [debug] [MainThread]: On master: COMMIT
[0m13:05:51.629374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:05:51.629884 [debug] [MainThread]: On master: Close
[0m13:05:51.630909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:51.631419 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:05:51.631930 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:05:51.631930 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:05:51.632439 [info ] [MainThread]: 
[0m13:05:51.633484 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m13:05:51.635006 [debug] [MainThread]: Command end result
[0m13:05:51.644677 [info ] [MainThread]: 
[0m13:05:51.645692 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m13:05:51.646198 [info ] [MainThread]: 
[0m13:05:51.646705 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  столбец pl.playlist не существует
  LINE 19: ... left join "chinook"."stg"."playlisttrack" plt on pl.playlis...
                                                                ^
  HINT:  Возможно, предполагалась ссылка на столбец "pl.playlistid".
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m13:05:51.647211 [info ] [MainThread]: 
[0m13:05:51.647912 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m13:05:51.648419 [info ] [MainThread]: 
[0m13:05:51.649487 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:05:^S"
  LINE 16:     ,'2024-08-08 10:05:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m13:05:51.649994 [info ] [MainThread]: 
[0m13:05:51.650501 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:05:^S"
  LINE 16:     ,'2024-08-08 10:05:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m13:05:51.650501 [info ] [MainThread]: 
[0m13:05:51.651607 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m13:05:51.653133 [debug] [MainThread]: Command `dbt run` failed at 13:05:51.652626 after 1.28 seconds
[0m13:05:51.653646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F698CE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F698CD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F698CE8D0>]}
[0m13:05:51.654152 [debug] [MainThread]: Flushing usage events
[0m13:07:53.460521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECD5528D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECD6435D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDA05ED0>]}


============================== 13:07:53.463557 | 83ecd52a-177f-49e4-b0e8-49333614f094 ==============================
[0m13:07:53.463557 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:07:53.464063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:07:53.628829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECCEFAD50>]}
[0m13:07:53.692421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECD3CAB10>]}
[0m13:07:53.693434 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:07:53.693434 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:07:53.802388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:07:53.802388 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_playlist.sql
[0m13:07:54.022695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECF04CAD0>]}
[0m13:07:54.033897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECF123790>]}
[0m13:07:54.034406 [info ] [MainThread]: Found 6 models, 12 tests, 12 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:07:54.034916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECEF31A90>]}
[0m13:07:54.036452 [info ] [MainThread]: 
[0m13:07:54.037470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:07:54.038543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:07:54.046624 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:07:54.047128 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:07:54.047634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:54.077563 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:07:54.078581 [debug] [ThreadPool]: On list_chinook: Close
[0m13:07:54.080110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:07:54.084699 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:07:54.085253 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:07:54.085763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:54.114086 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.114592 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:07:54.114592 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:07:54.119479 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m13:07:54.120999 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:07:54.120999 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:07:54.125565 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:54.126070 [debug] [MainThread]: On master: BEGIN
[0m13:07:54.126576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:54.153532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.154041 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:54.154545 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:07:54.159853 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:07:54.163358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECEC8BF50>]}
[0m13:07:54.163358 [debug] [MainThread]: On master: ROLLBACK
[0m13:07:54.163358 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:54.163358 [debug] [MainThread]: On master: BEGIN
[0m13:07:54.165318 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.166031 [debug] [MainThread]: On master: COMMIT
[0m13:07:54.166031 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:54.166573 [debug] [MainThread]: On master: COMMIT
[0m13:07:54.166573 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:07:54.166573 [debug] [MainThread]: On master: Close
[0m13:07:54.167621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:54.167621 [info ] [MainThread]: 
[0m13:07:54.170012 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:07:54.170012 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:07:54.170012 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m13:07:54.170012 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:07:54.174629 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:07:54.179133 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:07:54.170012 => 13:07:54.179133
[0m13:07:54.179133 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:07:54.208854 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:07:54.209356 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:54.209356 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:07:54.210440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:07:54.226161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.226161 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:54.226161 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-08 10:07:53'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:07:54.250619 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:07:54.261699 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:54.262203 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:07:54.262709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:54.265233 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:54.265737 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:07:54.266242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:54.273751 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:07:54.273751 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:54.273751 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:07:54.282752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:54.283791 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:07:54.291765 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:54.292267 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:07:54.294436 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:54.294436 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:07:54.179133 => 13:07:54.294436
[0m13:07:54.294436 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:07:54.294436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECF0B6110>]}
[0m13:07:54.294436 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.12s]
[0m13:07:54.294436 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:07:54.299104 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:07:54.299844 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:07:54.299844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:07:54.299844 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:07:54.304129 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:07:54.304634 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:07:54.299844 => 13:07:54.304634
[0m13:07:54.305271 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:07:54.308815 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:07:54.309321 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:54.309826 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:07:54.310332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:54.336639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.336639 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:54.336639 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-08 10:07:53'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:07:54.345693 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:07:54.345693 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:54.345693 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:07:54.345693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:54.352696 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:54.352696 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:07:54.353606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:54.354159 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:07:54.354159 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:54.354159 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:07:54.357309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:54.359327 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:07:54.359832 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:54.360337 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:07:54.362656 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:54.363165 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:07:54.305775 => 13:07:54.363165
[0m13:07:54.363165 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:07:54.363165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECF195290>]}
[0m13:07:54.363165 [info ] [Thread-1 (]: 2 of 6 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.06s]
[0m13:07:54.363165 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:07:54.367193 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:07:54.367696 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:07:54.367696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:07:54.368698 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:07:54.368698 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:07:54.368698 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:07:54.368698 => 13:07:54.368698
[0m13:07:54.368698 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:07:54.368698 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:07:54.368698 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:07:54.368698 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:07:54.368698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:54.400034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.400034 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:07:54.400034 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-08 10:07:^S'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:07:54.407137 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
LINE 17:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
              ^

[0m13:07:54.407745 [debug] [Thread-1 (]: On model.chinook.dim_playlist: ROLLBACK
[0m13:07:54.408248 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:07:54.368698 => 13:07:54.408248
[0m13:07:54.408248 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:07:54.410973 [debug] [Thread-1 (]: Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
  LINE 17:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m13:07:54.410973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECF1BC8D0>]}
[0m13:07:54.410973 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model chinook_dwh.dim_playlist ................. [[31mERROR[0m in 0.04s]
[0m13:07:54.410973 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:07:54.410973 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:07:54.410973 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:07:54.415975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:07:54.415975 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:07:54.415975 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:07:54.415975 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:07:54.415975 => 13:07:54.415975
[0m13:07:54.415975 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:07:54.422166 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:07:54.422166 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:07:54.422166 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:07:54.422166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:54.453404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.454415 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:07:54.454926 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-08 10:07:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:07:54.455956 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m13:07:54.456464 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m13:07:54.456464 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:07:54.415975 => 13:07:54.456464
[0m13:07:54.457273 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:07:54.457273 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m13:07:54.457273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECF17E750>]}
[0m13:07:54.457273 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.05s]
[0m13:07:54.461273 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:07:54.461784 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:07:54.462291 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:07:54.463391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:07:54.463391 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:07:54.463894 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:07:54.463894 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:07:54.463894 => 13:07:54.463894
[0m13:07:54.468202 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:07:54.480135 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:07:54.494141 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:54.494950 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:07:54.494950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:54.523565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.524247 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:54.524749 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-08 10:07:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m13:07:54.525253 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
LINE 16:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
              ^

[0m13:07:54.525253 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m13:07:54.527332 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:07:54.468711 => 13:07:54.525253
[0m13:07:54.527332 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:07:54.529937 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
  LINE 16:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m13:07:54.529937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECF11BA90>]}
[0m13:07:54.529937 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.07s]
[0m13:07:54.529937 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:07:54.529937 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:07:54.529937 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:07:54.533047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:07:54.533555 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:07:54.533555 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:07:54.533555 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:07:54.533555 => 13:07:54.533555
[0m13:07:54.533555 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:07:54.540686 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:07:54.544476 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:54.544983 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:07:54.545562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:54.575551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.576568 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:54.576568 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-08 10:07:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m13:07:54.577637 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
LINE 16:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
              ^

[0m13:07:54.578357 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m13:07:54.579360 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:07:54.533555 => 13:07:54.578357
[0m13:07:54.579360 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:07:54.579360 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
  LINE 16:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m13:07:54.579360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ecd52a-177f-49e4-b0e8-49333614f094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECDA68A10>]}
[0m13:07:54.579360 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.05s]
[0m13:07:54.583975 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:07:54.584979 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:54.585483 [debug] [MainThread]: On master: BEGIN
[0m13:07:54.585483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:54.613535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:54.613535 [debug] [MainThread]: On master: COMMIT
[0m13:07:54.613535 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:54.613535 [debug] [MainThread]: On master: COMMIT
[0m13:07:54.613535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:07:54.613535 [debug] [MainThread]: On master: Close
[0m13:07:54.619039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:54.619039 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:07:54.619579 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:07:54.619579 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:07:54.619579 [info ] [MainThread]: 
[0m13:07:54.619579 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m13:07:54.619579 [debug] [MainThread]: Command end result
[0m13:07:54.631041 [info ] [MainThread]: 
[0m13:07:54.631041 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m13:07:54.631041 [info ] [MainThread]: 
[0m13:07:54.631041 [error] [MainThread]:   Database Error in model dim_playlist (models\dimensions\dim_playlist.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
  LINE 17:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\dimensions\dim_playlist.sql
[0m13:07:54.631041 [info ] [MainThread]: 
[0m13:07:54.631041 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m13:07:54.631041 [info ] [MainThread]: 
[0m13:07:54.631041 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
  LINE 16:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m13:07:54.635047 [info ] [MainThread]: 
[0m13:07:54.635047 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:07:^S"
  LINE 16:     ,'2024-08-08 10:07:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m13:07:54.635047 [info ] [MainThread]: 
[0m13:07:54.635047 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m13:07:54.635047 [debug] [MainThread]: Command `dbt run` failed at 13:07:54.635047 after 1.22 seconds
[0m13:07:54.635047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECC887950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECCEF1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AECCEF1450>]}
[0m13:07:54.635047 [debug] [MainThread]: Flushing usage events
[0m13:08:24.811532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E1108710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E11F6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E11F7650>]}


============================== 13:08:24.812537 | f6c18515-d38a-468a-98fa-29ad80994fb0 ==============================
[0m13:08:24.812537 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:08:24.812537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:08:24.968994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E17C0450>]}
[0m13:08:25.032324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E1628A50>]}
[0m13:08:25.032324 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:08:25.032324 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:08:25.144233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:08:25.144233 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_playlist.sql
[0m13:08:25.347580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E2957A90>]}
[0m13:08:25.363206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E2AF4850>]}
[0m13:08:25.363206 [info ] [MainThread]: Found 6 models, 12 tests, 12 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:08:25.363206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E13C3010>]}
[0m13:08:25.363206 [info ] [MainThread]: 
[0m13:08:25.370962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:08:25.371967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:08:25.380241 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:08:25.380743 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:08:25.380743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:25.409825 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:08:25.410330 [debug] [ThreadPool]: On list_chinook: Close
[0m13:08:25.412498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:08:25.414512 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:08:25.414512 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:08:25.414512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:25.553260 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:08:25.553260 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:08:25.553260 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:08:25.553260 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m13:08:25.567773 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:08:25.567773 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:08:25.571821 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:25.571821 [debug] [MainThread]: On master: BEGIN
[0m13:08:25.571821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:25.598819 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:08:25.598819 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:25.598819 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:08:25.598819 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:08:25.598819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E01A2D10>]}
[0m13:08:25.598819 [debug] [MainThread]: On master: ROLLBACK
[0m13:08:25.598819 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:25.598819 [debug] [MainThread]: On master: BEGIN
[0m13:08:25.610630 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:08:25.610630 [debug] [MainThread]: On master: COMMIT
[0m13:08:25.611134 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:25.611134 [debug] [MainThread]: On master: COMMIT
[0m13:08:25.611134 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:08:25.612136 [debug] [MainThread]: On master: Close
[0m13:08:25.612136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:25.612136 [info ] [MainThread]: 
[0m13:08:25.616051 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:08:25.616051 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:08:25.616051 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m13:08:25.616051 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:08:25.616051 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:08:25.616051 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:08:25.616051 => 13:08:25.616051
[0m13:08:25.616051 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:08:25.646509 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:08:25.646509 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:08:25.646509 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:08:25.646509 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:08:25.682095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:08:25.682613 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:08:25.683119 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-08 10:08:24'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:08:25.692697 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:08:25.692697 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:08:25.692697 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:08:25.708334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:25.708334 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:08:25.708334 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:08:25.708334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:25.723960 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:08:25.723960 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:08:25.723960 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:08:25.723960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:08:25.723960 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:08:25.723960 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:08:25.723960 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:08:25.739586 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:25.739586 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:08:25.616051 => 13:08:25.739586
[0m13:08:25.739586 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:08:25.739586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E2B00810>]}
[0m13:08:25.739586 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.12s]
[0m13:08:25.739586 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:08:25.739586 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:08:25.739586 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:08:25.739586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:08:25.739586 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:08:25.739586 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:08:25.739586 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:08:25.739586 => 13:08:25.739586
[0m13:08:25.750955 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:08:25.751458 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:08:25.755462 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:08:25.755462 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:08:25.755462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:25.783941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:08:25.784446 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:08:25.784951 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-08 10:08:24'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:08:25.786954 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:08:25.786954 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:08:25.786954 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:08:25.786954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:25.786954 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:08:25.786954 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:08:25.786954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:25.786954 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:08:25.786954 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:08:25.802592 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:08:25.802592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:08:25.802592 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:08:25.802592 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:08:25.802592 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:08:25.802592 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:25.802592 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:08:25.751458 => 13:08:25.802592
[0m13:08:25.802592 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:08:25.802592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E2B45750>]}
[0m13:08:25.802592 [info ] [Thread-1 (]: 2 of 6 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.06s]
[0m13:08:25.802592 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:08:25.802592 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:08:25.802592 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:08:25.802592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:08:25.802592 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:08:25.802592 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:08:25.818209 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:08:25.802592 => 13:08:25.818209
[0m13:08:25.819091 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:08:25.820095 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:08:25.820095 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:08:25.820095 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:08:25.820095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:25.851891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:08:25.852396 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:08:25.852901 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-08 10:08:24'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:08:25.862999 [debug] [Thread-1 (]: SQL status: SELECT 8719 in 0.0 seconds
[0m13:08:25.864502 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:08:25.864502 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp" rename to "dim_playlist"
[0m13:08:25.864502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:25.864502 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:08:25.864502 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:08:25.864502 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:08:25.864502 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:08:25.864502 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_playlist__dbt_backup"
[0m13:08:25.864502 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:08:25.864502 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
drop table if exists "chinook"."chinook_dwh"."dim_playlist__dbt_backup" cascade
[0m13:08:25.864502 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:25.864502 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:08:25.819091 => 13:08:25.864502
[0m13:08:25.864502 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:08:25.864502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E2D73750>]}
[0m13:08:25.864502 [info ] [Thread-1 (]: 3 of 6 OK created sql table model chinook_dwh.dim_playlist ..................... [[32mSELECT 8719[0m in 0.06s]
[0m13:08:25.864502 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:08:25.864502 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:08:25.880130 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:08:25.881135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:08:25.881135 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:08:25.881135 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:08:25.881135 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:08:25.881135 => 13:08:25.881135
[0m13:08:25.881135 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:08:25.881135 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:08:25.881135 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:08:25.881135 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:08:25.881135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:25.911485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:08:25.911485 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:08:25.911485 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-08 10:08:^S'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.album = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:08:25.911485 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец track.album не существует
LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                   ^
HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".

[0m13:08:25.911485 [debug] [Thread-1 (]: On model.chinook.dim_track: ROLLBACK
[0m13:08:25.911485 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:08:25.881135 => 13:08:25.911485
[0m13:08:25.911485 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:08:25.924426 [debug] [Thread-1 (]: Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m13:08:25.924426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E2AE3BD0>]}
[0m13:08:25.924426 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model chinook_dwh.dim_track .................... [[31mERROR[0m in 0.04s]
[0m13:08:25.924426 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:08:25.927103 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:08:25.927607 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:08:25.928533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:08:25.928533 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:08:25.931953 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:08:25.932456 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:08:25.929036 => 13:08:25.932456
[0m13:08:25.932456 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:08:25.944729 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:08:25.944729 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:08:25.944729 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:08:25.944729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:26.086923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:08:26.086923 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:08:26.086923 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-08 10:08:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m13:08:26.086923 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:08:^S"
LINE 16:     ,'2024-08-08 10:08:^S'::timestamp as dbt_time
              ^

[0m13:08:26.086923 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m13:08:26.086923 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:08:25.932456 => 13:08:26.086923
[0m13:08:26.086923 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:08:26.102032 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:08:^S"
  LINE 16:     ,'2024-08-08 10:08:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m13:08:26.102980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E2E28250>]}
[0m13:08:26.103482 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.18s]
[0m13:08:26.104415 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:08:26.104918 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:08:26.104918 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:08:26.104918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:08:26.104918 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:08:26.104918 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:08:26.104918 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:08:26.104918 => 13:08:26.104918
[0m13:08:26.111635 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:08:26.115668 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:08:26.116173 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:08:26.116678 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:08:26.117220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:26.143935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:08:26.144441 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:08:26.144441 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-08 10:08:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m13:08:26.144441 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:08:^S"
LINE 16:     ,'2024-08-08 10:08:^S'::timestamp as dbt_time
              ^

[0m13:08:26.144441 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m13:08:26.144441 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:08:26.112138 => 13:08:26.144441
[0m13:08:26.144441 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:08:26.149472 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:08:^S"
  LINE 16:     ,'2024-08-08 10:08:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m13:08:26.150475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c18515-d38a-468a-98fa-29ad80994fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E2C806D0>]}
[0m13:08:26.150977 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.04s]
[0m13:08:26.150977 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:08:26.150977 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:26.150977 [debug] [MainThread]: On master: BEGIN
[0m13:08:26.150977 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:08:26.180529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:08:26.181031 [debug] [MainThread]: On master: COMMIT
[0m13:08:26.181031 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:26.181537 [debug] [MainThread]: On master: COMMIT
[0m13:08:26.182042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:08:26.182042 [debug] [MainThread]: On master: Close
[0m13:08:26.183063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:26.183063 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:08:26.183568 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:08:26.184073 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:08:26.184073 [info ] [MainThread]: 
[0m13:08:26.184576 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m13:08:26.186096 [debug] [MainThread]: Command end result
[0m13:08:26.191142 [info ] [MainThread]: 
[0m13:08:26.191142 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:08:26.191142 [info ] [MainThread]: 
[0m13:08:26.194646 [error] [MainThread]:   Database Error in model dim_track (models\dimensions\dim_track.sql)
  ОШИБКА:  столбец track.album не существует
  LINE 24:     join "chinook"."stg"."album" album on track.album = albu...
                                                     ^
  HINT:  Возможно, предполагалась ссылка на столбец "track.albumid".
  compiled Code at target\run\chinook\models\dimensions\dim_track.sql
[0m13:08:26.194646 [info ] [MainThread]: 
[0m13:08:26.194646 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:08:^S"
  LINE 16:     ,'2024-08-08 10:08:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m13:08:26.194646 [info ] [MainThread]: 
[0m13:08:26.194646 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:08:^S"
  LINE 16:     ,'2024-08-08 10:08:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m13:08:26.194646 [info ] [MainThread]: 
[0m13:08:26.194646 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m13:08:26.194646 [debug] [MainThread]: Command `dbt run` failed at 13:08:26.194646 after 1.43 seconds
[0m13:08:26.194646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E11BECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250D9D46390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250E0A8ACD0>]}
[0m13:08:26.194646 [debug] [MainThread]: Flushing usage events
[0m13:09:18.537271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CA787890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CA787850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C8E06A10>]}


============================== 13:09:18.538796 | 558037ad-4fdb-406a-8f4a-e1c46cc6c82d ==============================
[0m13:09:18.538796 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:09:18.538796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:09:18.688881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CA86EE90>]}
[0m13:09:18.751438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CA0B2150>]}
[0m13:09:18.767075 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:09:18.767075 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:09:18.878925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:18.878925 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_track.sql
[0m13:09:19.084319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CC151ED0>]}
[0m13:09:19.084319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CC015D90>]}
[0m13:09:19.096148 [info ] [MainThread]: Found 6 models, 12 tests, 12 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:09:19.096148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CC2F2650>]}
[0m13:09:19.098655 [info ] [MainThread]: 
[0m13:09:19.099223 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:09:19.100225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:09:19.102231 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:09:19.102231 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:09:19.102231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:19.142843 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:09:19.144358 [debug] [ThreadPool]: On list_chinook: Close
[0m13:09:19.145861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:09:19.147389 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:09:19.147389 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:09:19.147389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:19.177531 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.177531 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:09:19.177531 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:09:19.177531 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:09:19.184314 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:09:19.184827 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:09:19.188725 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:19.188725 [debug] [MainThread]: On master: BEGIN
[0m13:09:19.188725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:19.215421 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.215926 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:19.216937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:09:19.222488 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:09:19.224991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CC300850>]}
[0m13:09:19.224991 [debug] [MainThread]: On master: ROLLBACK
[0m13:09:19.226511 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:19.226511 [debug] [MainThread]: On master: BEGIN
[0m13:09:19.227513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.227513 [debug] [MainThread]: On master: COMMIT
[0m13:09:19.228084 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:19.228587 [debug] [MainThread]: On master: COMMIT
[0m13:09:19.228587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:09:19.228587 [debug] [MainThread]: On master: Close
[0m13:09:19.229791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:19.230294 [info ] [MainThread]: 
[0m13:09:19.230294 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:09:19.230294 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:09:19.230294 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m13:09:19.230294 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:09:19.240798 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:09:19.241881 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:09:19.230294 => 13:09:19.241881
[0m13:09:19.242388 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:09:19.258410 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:09:19.272422 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:09:19.273149 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:09:19.273149 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:09:19.299742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.300250 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:09:19.300757 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-08 10:09:18'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:09:19.303761 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:09:19.303761 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:09:19.303761 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:09:19.303761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:09:19.303761 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:09:19.303761 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:09:19.303761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:09:19.322604 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:09:19.322604 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:09:19.335116 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:09:19.336171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:09:19.340715 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:09:19.344752 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:09:19.345257 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:09:19.347789 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:09:19.347789 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:09:19.242388 => 13:09:19.347789
[0m13:09:19.347789 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:09:19.347789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CC3C4F90>]}
[0m13:09:19.350792 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.12s]
[0m13:09:19.351333 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:09:19.352293 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:09:19.352293 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:09:19.352293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:09:19.352293 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:09:19.352293 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:09:19.352293 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:09:19.352293 => 13:09:19.352293
[0m13:09:19.358173 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:09:19.361161 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:09:19.362167 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:09:19.362167 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:09:19.362167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:19.390163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.390668 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:09:19.390668 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-08 10:09:18'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:09:19.397222 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:09:19.397222 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:09:19.397222 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:09:19.397222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:09:19.397222 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:09:19.397222 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:09:19.397222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:09:19.409926 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:09:19.410429 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:09:19.410931 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:09:19.411941 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:09:19.414038 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:09:19.414543 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:09:19.415048 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:09:19.417068 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:09:19.418583 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:09:19.358173 => 13:09:19.418078
[0m13:09:19.419088 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:09:19.419593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CAD0CFD0>]}
[0m13:09:19.420098 [info ] [Thread-1 (]: 2 of 6 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.07s]
[0m13:09:19.420604 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:09:19.421112 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:09:19.421636 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:09:19.422653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:09:19.423161 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:09:19.429802 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:09:19.429802 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:09:19.423670 => 13:09:19.429802
[0m13:09:19.429802 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:09:19.429802 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:09:19.429802 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:09:19.429802 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:09:19.429802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:19.468107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.469116 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:09:19.469116 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-08 10:09:18'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:09:19.481386 [debug] [Thread-1 (]: SQL status: SELECT 8719 in 0.0 seconds
[0m13:09:19.484427 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:09:19.484932 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist" rename to "dim_playlist__dbt_backup"
[0m13:09:19.485437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:09:19.487964 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:09:19.488471 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp" rename to "dim_playlist"
[0m13:09:19.488976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:09:19.490542 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:09:19.491047 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:09:19.491552 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:09:19.493063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:09:19.495590 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_playlist__dbt_backup"
[0m13:09:19.496610 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:09:19.496610 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
drop table if exists "chinook"."chinook_dwh"."dim_playlist__dbt_backup" cascade
[0m13:09:19.499640 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:09:19.500650 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:09:19.429802 => 13:09:19.500650
[0m13:09:19.501155 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:09:19.501660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CAFEF250>]}
[0m13:09:19.502165 [info ] [Thread-1 (]: 3 of 6 OK created sql table model chinook_dwh.dim_playlist ..................... [[32mSELECT 8719[0m in 0.08s]
[0m13:09:19.503177 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:09:19.503177 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:09:19.503684 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:09:19.503684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:09:19.503684 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:09:19.505688 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:09:19.505688 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:09:19.503684 => 13:09:19.505688
[0m13:09:19.505688 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:09:19.505688 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:09:19.505688 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:09:19.505688 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:09:19.505688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:19.536781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.536781 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:09:19.536781 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-08 10:09:18'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.albumid = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:09:19.555294 [debug] [Thread-1 (]: SQL status: SELECT 3503 in 0.0 seconds
[0m13:09:19.555294 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:09:19.555294 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track__dbt_tmp" rename to "dim_track"
[0m13:09:19.555294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:09:19.555294 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:09:19.568308 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:09:19.568308 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:09:19.568308 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:09:19.568308 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_track__dbt_backup"
[0m13:09:19.568308 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:09:19.568308 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
drop table if exists "chinook"."chinook_dwh"."dim_track__dbt_backup" cascade
[0m13:09:19.568308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:09:19.568308 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:09:19.505688 => 13:09:19.568308
[0m13:09:19.568308 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:09:19.568308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CC482D10>]}
[0m13:09:19.568308 [info ] [Thread-1 (]: 4 of 6 OK created sql table model chinook_dwh.dim_track ........................ [[32mSELECT 3503[0m in 0.06s]
[0m13:09:19.578778 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:09:19.579281 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:09:19.579281 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:09:19.580283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:09:19.580283 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:09:19.584288 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:09:19.585354 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:09:19.580283 => 13:09:19.584848
[0m13:09:19.585354 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:09:19.602185 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:09:19.602185 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:09:19.602185 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:09:19.602185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:19.631821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.631821 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:09:19.631821 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-08 10:09:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m13:09:19.631821 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:09:^S"
LINE 16:     ,'2024-08-08 10:09:^S'::timestamp as dbt_time
              ^

[0m13:09:19.631821 [debug] [Thread-1 (]: On model.chinook.fact_invoice: ROLLBACK
[0m13:09:19.631821 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:09:19.585862 => 13:09:19.631821
[0m13:09:19.631821 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:09:19.644027 [debug] [Thread-1 (]: Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:09:^S"
  LINE 16:     ,'2024-08-08 10:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m13:09:19.644027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CC472E10>]}
[0m13:09:19.644027 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoice ........... [[31mERROR[0m in 0.06s]
[0m13:09:19.644027 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:09:19.644027 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:09:19.644027 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:09:19.647531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:09:19.647531 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:09:19.649947 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:09:19.649947 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:09:19.647531 => 13:09:19.649947
[0m13:09:19.649947 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:09:19.649947 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:09:19.649947 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:09:19.649947 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:09:19.649947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:19.681029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.681029 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:09:19.681029 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-08 10:09:^S'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m13:09:19.681029 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:09:^S"
LINE 16:     ,'2024-08-08 10:09:^S'::timestamp as dbt_time
              ^

[0m13:09:19.681029 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: ROLLBACK
[0m13:09:19.681029 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:09:19.649947 => 13:09:19.681029
[0m13:09:19.681029 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:09:19.681029 [debug] [Thread-1 (]: Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:09:^S"
  LINE 16:     ,'2024-08-08 10:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m13:09:19.690603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558037ad-4fdb-406a-8f4a-e1c46cc6c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CC1756D0>]}
[0m13:09:19.691105 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model chinook_dwh.fact_invoiceline ....... [[31mERROR[0m in 0.05s]
[0m13:09:19.691608 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:09:19.691608 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:19.691608 [debug] [MainThread]: On master: BEGIN
[0m13:09:19.691608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:19.720742 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:09:19.721245 [debug] [MainThread]: On master: COMMIT
[0m13:09:19.721245 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:19.721750 [debug] [MainThread]: On master: COMMIT
[0m13:09:19.722255 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:09:19.722255 [debug] [MainThread]: On master: Close
[0m13:09:19.722760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:19.722760 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:09:19.722760 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:09:19.722760 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:09:19.722760 [info ] [MainThread]: 
[0m13:09:19.722760 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m13:09:19.722760 [debug] [MainThread]: Command end result
[0m13:09:19.726765 [info ] [MainThread]: 
[0m13:09:19.726765 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:09:19.726765 [info ] [MainThread]: 
[0m13:09:19.726765 [error] [MainThread]:   Database Error in model fact_invoice (models\facts\fact_invoice.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:09:^S"
  LINE 16:     ,'2024-08-08 10:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoice.sql
[0m13:09:19.726765 [info ] [MainThread]: 
[0m13:09:19.726765 [error] [MainThread]:   Database Error in model fact_invoiceline (models\facts\fact_invoiceline.sql)
  ОШИБКА:  неверный синтаксис для типа timestamp: "2024-08-08 10:09:^S"
  LINE 16:     ,'2024-08-08 10:09:^S'::timestamp as dbt_time
                ^
  compiled Code at target\run\chinook\models\facts\fact_invoiceline.sql
[0m13:09:19.726765 [info ] [MainThread]: 
[0m13:09:19.726765 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m13:09:19.726765 [debug] [MainThread]: Command `dbt run` failed at 13:09:19.726765 after 1.24 seconds
[0m13:09:19.726765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CA7F0A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C8D7C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CA0981D0>]}
[0m13:09:19.726765 [debug] [MainThread]: Flushing usage events
[0m13:10:00.919711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E50DB010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E50E7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E454C350>]}


============================== 13:10:00.924147 | ba4aeb88-dd5a-4588-a4f8-f546550f2e77 ==============================
[0m13:10:00.924147 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:10:00.924650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:10:01.081987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E5A4EFD0>]}
[0m13:10:01.142554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E55BF910>]}
[0m13:10:01.142554 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:10:01.154665 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:10:01.264847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:10:01.264847 [debug] [MainThread]: Partial parsing: updated file: chinook://models\facts\fact_invoiceline.sql
[0m13:10:01.264847 [debug] [MainThread]: Partial parsing: updated file: chinook://models\facts\fact_invoice.sql
[0m13:10:01.483927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E6BF4E50>]}
[0m13:10:01.496670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E6F5A5D0>]}
[0m13:10:01.498184 [info ] [MainThread]: Found 6 models, 12 tests, 12 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:10:01.498184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E6C3AF50>]}
[0m13:10:01.500014 [info ] [MainThread]: 
[0m13:10:01.500014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:01.501611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:10:01.508665 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:10:01.508665 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:10:01.508665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:01.539052 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:10:01.539052 [debug] [ThreadPool]: On list_chinook: Close
[0m13:10:01.539052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:10:01.545502 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:10:01.545502 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:10:01.545502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:01.569869 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:10:01.569869 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:10:01.569869 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:10:01.580230 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:10:01.580230 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:10:01.580230 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:10:01.587500 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:01.587500 [debug] [MainThread]: On master: BEGIN
[0m13:10:01.587500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:01.615344 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:01.615344 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:01.615344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:10:01.621031 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:10:01.621031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E6F583D0>]}
[0m13:10:01.621031 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:01.621031 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:01.621031 [debug] [MainThread]: On master: BEGIN
[0m13:10:01.621031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:01.621031 [debug] [MainThread]: On master: COMMIT
[0m13:10:01.621031 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:01.621031 [debug] [MainThread]: On master: COMMIT
[0m13:10:01.621031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:10:01.621031 [debug] [MainThread]: On master: Close
[0m13:10:01.631045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:01.631045 [info ] [MainThread]: 
[0m13:10:01.633481 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:10:01.633481 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:10:01.635586 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m13:10:01.635586 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:10:01.641091 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:10:01.641091 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:10:01.635586 => 13:10:01.641091
[0m13:10:01.641091 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:10:01.671626 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:10:01.671626 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:10:01.671626 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:10:01.671626 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:10:01.694282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:01.694282 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:10:01.701786 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-08 10:10:00'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:10:01.701786 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:10:01.711806 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:10:01.711806 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:10:01.711806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:01.717169 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:10:01.718742 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:10:01.718742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:01.732273 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:10:01.732273 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:10:01.732273 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:10:01.736170 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:01.739677 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:10:01.743899 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:10:01.743899 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:10:01.743899 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:01.743899 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:10:01.641091 => 13:10:01.743899
[0m13:10:01.743899 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:10:01.743899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E58CE810>]}
[0m13:10:01.743899 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.11s]
[0m13:10:01.743899 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:10:01.752914 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:10:01.753436 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:10:01.753436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:10:01.753436 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:10:01.757775 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:10:01.758780 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:10:01.753436 => 13:10:01.757775
[0m13:10:01.758780 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:10:01.764065 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:10:01.764065 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:10:01.764065 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:10:01.765764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:01.793544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:01.793544 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:10:01.793544 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-08 10:10:00'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:10:01.806612 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:10:01.811273 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:10:01.811273 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:10:01.811273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:01.813776 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:10:01.813776 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:10:01.813776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:01.820915 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:10:01.820915 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:10:01.820915 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:10:01.823469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:01.825973 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:10:01.825973 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:10:01.825973 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:10:01.825973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:01.825973 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:10:01.758780 => 13:10:01.825973
[0m13:10:01.825973 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:10:01.834478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E5A1F5D0>]}
[0m13:10:01.835524 [info ] [Thread-1 (]: 2 of 6 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.08s]
[0m13:10:01.835524 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:10:01.835524 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:10:01.835524 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:10:01.838531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:10:01.838531 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:10:01.840707 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:10:01.840707 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:10:01.839574 => 13:10:01.840707
[0m13:10:01.844714 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:10:01.844714 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:10:01.844714 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:10:01.844714 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:10:01.844714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:01.875347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:01.875347 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:10:01.875347 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-08 10:10:00'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:10:01.885379 [debug] [Thread-1 (]: SQL status: SELECT 8719 in 0.0 seconds
[0m13:10:01.895652 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:10:01.895652 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist" rename to "dim_playlist__dbt_backup"
[0m13:10:01.895652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:01.895652 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:10:01.895652 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp" rename to "dim_playlist"
[0m13:10:01.895652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:01.901188 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:10:01.901188 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:10:01.901188 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:10:01.901188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:01.905702 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_playlist__dbt_backup"
[0m13:10:01.905702 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:10:01.905702 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
drop table if exists "chinook"."chinook_dwh"."dim_playlist__dbt_backup" cascade
[0m13:10:01.905702 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:01.905702 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:10:01.844714 => 13:10:01.905702
[0m13:10:01.905702 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:10:01.905702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E6FE7790>]}
[0m13:10:01.905702 [info ] [Thread-1 (]: 3 of 6 OK created sql table model chinook_dwh.dim_playlist ..................... [[32mSELECT 8719[0m in 0.07s]
[0m13:10:01.905702 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:10:01.905702 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:10:01.915965 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:10:01.916988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:10:01.916988 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:10:01.918059 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:10:01.918059 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:10:01.916988 => 13:10:01.918059
[0m13:10:01.918059 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:10:01.918059 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:10:01.926064 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:10:01.926064 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:10:01.926064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:01.956875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:01.956875 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:10:01.956875 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-08 10:10:00'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.albumid = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:10:01.977333 [debug] [Thread-1 (]: SQL status: SELECT 3503 in 0.0 seconds
[0m13:10:01.980355 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:10:01.980355 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track" rename to "dim_track__dbt_backup"
[0m13:10:01.980355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:01.980355 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:10:01.987359 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track__dbt_tmp" rename to "dim_track"
[0m13:10:01.987359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:01.987359 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:10:01.987359 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:10:01.987359 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:10:01.987359 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:01.993076 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_track__dbt_backup"
[0m13:10:01.996080 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:10:01.996629 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
drop table if exists "chinook"."chinook_dwh"."dim_track__dbt_backup" cascade
[0m13:10:01.999161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:01.999161 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:10:01.918059 => 13:10:01.999161
[0m13:10:01.999161 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:10:01.999161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E6E42D50>]}
[0m13:10:01.999161 [info ] [Thread-1 (]: 4 of 6 OK created sql table model chinook_dwh.dim_track ........................ [[32mSELECT 3503[0m in 0.08s]
[0m13:10:02.004086 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:10:02.004086 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:10:02.005233 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:10:02.005737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:10:02.005737 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:10:02.007742 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:10:02.007742 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:10:02.005737 => 13:10:02.007742
[0m13:10:02.007742 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:10:02.028426 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:10:02.028426 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:10:02.028426 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:10:02.028426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:02.059922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:02.059922 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:10:02.059922 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoice"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-08 10:10:00'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

  );
  
  
[0m13:10:02.068935 [debug] [Thread-1 (]: SQL status: SELECT 3811 in 0.0 seconds
[0m13:10:02.075973 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:10:02.075973 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:10:02.075973 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:10:02.078985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:02.078985 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:10:02.012203 => 13:10:02.078985
[0m13:10:02.078985 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:10:02.078985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E59B2490>]}
[0m13:10:02.078985 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model chinook_dwh.fact_invoice ............... [[32mSELECT 3811[0m in 0.07s]
[0m13:10:02.078985 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:10:02.078985 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:10:02.083326 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:10:02.083326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:10:02.083326 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:10:02.085900 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:10:02.085900 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:10:02.083326 => 13:10:02.085900
[0m13:10:02.085900 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:10:02.093114 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:10:02.093617 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:10:02.093617 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:10:02.093617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:02.123795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:02.124868 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:10:02.124868 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
  
    

  create  table "chinook"."chinook_dwh"."fact_invoiceline"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-08 10:10:00'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

  );
  
  
[0m13:10:02.139554 [debug] [Thread-1 (]: SQL status: SELECT 13463 in 0.0 seconds
[0m13:10:02.140058 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:10:02.140058 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:10:02.140058 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:10:02.140058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:02.140058 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:10:02.089406 => 13:10:02.140058
[0m13:10:02.140058 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:10:02.147289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba4aeb88-dd5a-4588-a4f8-f546550f2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E6EF5890>]}
[0m13:10:02.147289 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model chinook_dwh.fact_invoiceline ........... [[32mSELECT 13463[0m in 0.06s]
[0m13:10:02.148825 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:10:02.150339 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:02.150339 [debug] [MainThread]: On master: BEGIN
[0m13:10:02.150339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:02.184768 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:02.186770 [debug] [MainThread]: On master: COMMIT
[0m13:10:02.186770 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:02.186770 [debug] [MainThread]: On master: COMMIT
[0m13:10:02.186770 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:10:02.186770 [debug] [MainThread]: On master: Close
[0m13:10:02.186770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:02.186770 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:10:02.186770 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:10:02.190369 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:10:02.190872 [info ] [MainThread]: 
[0m13:10:02.190872 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m13:10:02.191894 [debug] [MainThread]: Command end result
[0m13:10:02.201232 [info ] [MainThread]: 
[0m13:10:02.202765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:02.202765 [info ] [MainThread]: 
[0m13:10:02.202765 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:10:02.202765 [debug] [MainThread]: Command `dbt run` succeeded at 13:10:02.202765 after 1.32 seconds
[0m13:10:02.205705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E5028250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6DDF56390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6E53B5990>]}
[0m13:10:02.205705 [debug] [MainThread]: Flushing usage events
[0m13:50:08.764642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D70CC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D7698C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D758F5D0>]}


============================== 13:50:08.767157 | c87166e3-9b8a-4523-bcb9-f10c28fb33c4 ==============================
[0m13:50:08.767157 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:50:08.767157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:50:08.941394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D79C49D0>]}
[0m13:50:09.019347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D741E150>]}
[0m13:50:09.021062 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:50:09.036328 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:50:09.709896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:09.709896 [debug] [MainThread]: Partial parsing: updated file: chinook://models\facts\schema.yml
[0m13:50:09.992777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D8D454D0>]}
[0m13:50:10.008289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D8F36BD0>]}
[0m13:50:10.008289 [info ] [MainThread]: Found 6 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:50:10.008289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D789B1D0>]}
[0m13:50:10.008289 [info ] [MainThread]: 
[0m13:50:10.008289 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:10.008289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:50:10.025869 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:50:10.025869 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:50:10.025869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:10.055920 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:50:10.055920 [debug] [ThreadPool]: On list_chinook: Close
[0m13:50:10.055920 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:50:10.064813 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:50:10.064813 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:50:10.064813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:10.087630 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.087630 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:50:10.087630 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:50:10.103315 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:50:10.103315 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:50:10.103315 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:50:10.103315 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:10.103315 [debug] [MainThread]: On master: BEGIN
[0m13:50:10.103315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:10.141943 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.141943 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:10.143001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:10.150966 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:50:10.153993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D8FAB090>]}
[0m13:50:10.153993 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:10.153993 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:10.153993 [debug] [MainThread]: On master: BEGIN
[0m13:50:10.155991 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.155991 [debug] [MainThread]: On master: COMMIT
[0m13:50:10.155991 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:10.155991 [debug] [MainThread]: On master: COMMIT
[0m13:50:10.155991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:50:10.155991 [debug] [MainThread]: On master: Close
[0m13:50:10.155991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:10.155991 [info ] [MainThread]: 
[0m13:50:10.155991 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:50:10.155991 [info ] [Thread-1 (]: 1 of 6 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:50:10.164781 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_customer'
[0m13:50:10.164781 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:50:10.166797 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:50:10.166797 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:50:10.164781 => 13:50:10.166797
[0m13:50:10.166797 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:50:10.207486 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:50:10.208878 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:50:10.209381 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:50:10.209381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:10.232041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.232041 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:50:10.232041 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-08 10:50:08'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:50:10.261301 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:50:10.261301 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:50:10.261301 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:50:10.261301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:10.261301 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:50:10.261301 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:50:10.261301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:10.276939 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:50:10.276939 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:50:10.276939 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:50:10.276939 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:10.292660 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:50:10.297685 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:50:10.297685 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:50:10.297685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:10.297685 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:50:10.166797 => 13:50:10.297685
[0m13:50:10.297685 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:50:10.297685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D8C14F90>]}
[0m13:50:10.308692 [info ] [Thread-1 (]: 1 of 6 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.14s]
[0m13:50:10.308692 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:50:10.308692 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:50:10.308692 [info ] [Thread-1 (]: 2 of 6 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:50:10.308692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:50:10.312274 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:50:10.313589 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:50:10.313589 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:50:10.312274 => 13:50:10.313589
[0m13:50:10.313589 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:50:10.319794 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:50:10.319794 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:50:10.319794 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:50:10.319794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:10.356453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.356453 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:50:10.356453 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-08 10:50:08'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:50:10.356453 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:50:10.372127 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:50:10.372127 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:50:10.372127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:10.372127 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:50:10.372127 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:50:10.372127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:10.372127 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:50:10.372127 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:50:10.372127 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:50:10.372127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:10.372127 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:50:10.372127 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:50:10.372127 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:50:10.387826 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:10.387826 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:50:10.313589 => 13:50:10.387826
[0m13:50:10.387826 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:50:10.387826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D906F0D0>]}
[0m13:50:10.387826 [info ] [Thread-1 (]: 2 of 6 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.08s]
[0m13:50:10.387826 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:50:10.387826 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:50:10.393554 [info ] [Thread-1 (]: 3 of 6 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:50:10.394056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:50:10.394056 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:50:10.394056 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:50:10.394056 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:50:10.394056 => 13:50:10.394056
[0m13:50:10.394056 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:50:10.403559 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:50:10.405268 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:50:10.405268 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:50:10.405268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:10.435078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.435078 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:50:10.435078 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-08 10:50:08'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:50:10.450769 [debug] [Thread-1 (]: SQL status: SELECT 8719 in 0.0 seconds
[0m13:50:10.450769 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:50:10.450769 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist" rename to "dim_playlist__dbt_backup"
[0m13:50:10.450769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:10.450769 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:50:10.450769 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp" rename to "dim_playlist"
[0m13:50:10.450769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:10.450769 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:50:10.450769 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:50:10.450769 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:50:10.450769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:10.466444 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_playlist__dbt_backup"
[0m13:50:10.466444 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:50:10.466444 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
drop table if exists "chinook"."chinook_dwh"."dim_playlist__dbt_backup" cascade
[0m13:50:10.466444 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:10.466444 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:50:10.394056 => 13:50:10.466444
[0m13:50:10.466444 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:50:10.466444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D9055BD0>]}
[0m13:50:10.466444 [info ] [Thread-1 (]: 3 of 6 OK created sql table model chinook_dwh.dim_playlist ..................... [[32mSELECT 8719[0m in 0.07s]
[0m13:50:10.466444 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:50:10.466444 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:50:10.466444 [info ] [Thread-1 (]: 4 of 6 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:50:10.466444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:50:10.466444 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:50:10.482123 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:50:10.482123 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:50:10.466444 => 13:50:10.482123
[0m13:50:10.482123 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:50:10.482123 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:50:10.482123 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:50:10.482123 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:50:10.482123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:10.516375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.516375 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:50:10.516375 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-08 10:50:08'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.albumid = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:50:10.545375 [debug] [Thread-1 (]: SQL status: SELECT 3503 in 0.0 seconds
[0m13:50:10.545375 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:50:10.545375 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track" rename to "dim_track__dbt_backup"
[0m13:50:10.545375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:10.545375 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:50:10.545375 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track__dbt_tmp" rename to "dim_track"
[0m13:50:10.545375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:10.545375 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:50:10.545375 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:50:10.545375 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:50:10.545375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:10.561049 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_track__dbt_backup"
[0m13:50:10.561049 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:50:10.561049 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
drop table if exists "chinook"."chinook_dwh"."dim_track__dbt_backup" cascade
[0m13:50:10.561049 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:10.561049 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:50:10.482123 => 13:50:10.561049
[0m13:50:10.561049 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:50:10.561049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D904D3D0>]}
[0m13:50:10.561049 [info ] [Thread-1 (]: 4 of 6 OK created sql table model chinook_dwh.dim_track ........................ [[32mSELECT 3503[0m in 0.09s]
[0m13:50:10.561049 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:50:10.561049 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:50:10.561049 [info ] [Thread-1 (]: 5 of 6 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:50:10.561049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:50:10.561049 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:50:10.576714 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:50:10.576714 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:50:10.561049 => 13:50:10.576714
[0m13:50:10.576714 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:50:10.610015 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:50:10.610015 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

    
  
    

  create temporary table "fact_invoice__dbt_tmp135010593575"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-08 10:50:08'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoice")

  );
  
  
[0m13:50:10.610015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:10.639412 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:50:10.655130 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:50:10.655130 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:50:10.655130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.655130 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:50:10.655130 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice__dbt_tmp135010593575'
        
      order by ordinal_position

  
[0m13:50:10.670746 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:50:10.670746 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:50:10.670746 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:50:10.670746 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:50:10.686459 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:50:10.686459 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:50:10.686459 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:50:10.702156 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:50:10.702156 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:50:10.702156 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoice"
            where (
                invoiceid) in (
                select (invoiceid)
                from "fact_invoice__dbt_tmp135010593575"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoice" ("invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time")
    (
        select "invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time"
        from "fact_invoice__dbt_tmp135010593575"
    )
  
[0m13:50:10.702156 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:50:10.702156 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:50:10.702156 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:50:10.702156 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:50:10.702156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:10.702156 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:50:10.576714 => 13:50:10.702156
[0m13:50:10.702156 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:50:10.702156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D8FAC250>]}
[0m13:50:10.702156 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model chinook_dwh.fact_invoice ............... [[32mINSERT 0 0[0m in 0.14s]
[0m13:50:10.717759 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:50:10.718939 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:50:10.718939 [info ] [Thread-1 (]: 6 of 6 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:50:10.720296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:50:10.720799 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:50:10.722992 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:50:10.722992 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:50:10.720799 => 13:50:10.722992
[0m13:50:10.722992 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:50:10.722992 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:50:10.722992 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

    
  
    

  create temporary table "fact_invoiceline__dbt_tmp135010722992"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-08 10:50:08'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoiceline")

  );
  
  
[0m13:50:10.722992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:10.859928 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:50:10.875566 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:50:10.876809 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:50:10.876809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.876809 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:50:10.876809 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline__dbt_tmp135010722992'
        
      order by ordinal_position

  
[0m13:50:10.876809 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:50:10.891312 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:50:10.891312 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:50:10.891312 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:50:10.891312 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:50:10.891312 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:50:10.891312 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:50:10.891312 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:50:10.891312 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:50:10.891312 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoiceline"
            where (
                invoicelineid) in (
                select (invoicelineid)
                from "fact_invoiceline__dbt_tmp135010722992"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoiceline" ("invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time")
    (
        select "invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time"
        from "fact_invoiceline__dbt_tmp135010722992"
    )
  
[0m13:50:10.891312 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:50:10.906986 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:50:10.906986 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:50:10.906986 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:50:10.906986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:10.906986 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:50:10.722992 => 13:50:10.906986
[0m13:50:10.906986 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:50:10.906986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87166e3-9b8a-4523-bcb9-f10c28fb33c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D8E9A010>]}
[0m13:50:10.906986 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model chinook_dwh.fact_invoiceline ........... [[32mINSERT 0 0[0m in 0.19s]
[0m13:50:10.906986 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:50:10.906986 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:10.906986 [debug] [MainThread]: On master: BEGIN
[0m13:50:10.906986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:10.938683 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:10.938683 [debug] [MainThread]: On master: COMMIT
[0m13:50:10.938683 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:10.938683 [debug] [MainThread]: On master: COMMIT
[0m13:50:10.938683 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:50:10.938683 [debug] [MainThread]: On master: Close
[0m13:50:10.938683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:10.938683 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:50:10.938683 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:50:10.945131 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:50:10.945131 [info ] [MainThread]: 
[0m13:50:10.945131 [info ] [MainThread]: Finished running 4 table models, 2 incremental models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m13:50:10.946933 [debug] [MainThread]: Command end result
[0m13:50:10.954965 [info ] [MainThread]: 
[0m13:50:10.954965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:10.954965 [info ] [MainThread]: 
[0m13:50:10.954965 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:50:10.954965 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:10.954965 after 2.25 seconds
[0m13:50:10.954965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D7384590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CFC14D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D8CDD4D0>]}
[0m13:50:10.954965 [debug] [MainThread]: Flushing usage events
[0m13:07:17.587757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC3288A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC32C4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC2E63CD0>]}


============================== 13:07:17.592209 | d4370879-2c72-4518-bf03-e09512b802de ==============================
[0m13:07:17.592209 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:07:17.592209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:07:17.945357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC3417190>]}
[0m13:07:18.021677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC33CE150>]}
[0m13:07:18.023409 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:07:18.036888 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:07:18.903236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:07:18.903236 [debug] [MainThread]: Partial parsing: added file: chinook://models\dimensions\dim_currency.sql
[0m13:07:19.016359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC45FB650>]}
[0m13:07:19.041765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC4607D90>]}
[0m13:07:19.041765 [info ] [MainThread]: Found 7 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:07:19.041765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC4509D10>]}
[0m13:07:19.044948 [info ] [MainThread]: 
[0m13:07:19.044948 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:07:19.047415 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:07:19.049530 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:07:19.049530 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:07:19.049530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:19.091610 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:07:19.091610 [debug] [ThreadPool]: On list_chinook: Close
[0m13:07:19.096243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:07:19.100696 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:07:19.101699 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:07:19.101699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:19.135333 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.135333 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:07:19.135333 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:07:19.139049 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:07:19.147508 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:07:19.147508 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:07:19.151535 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.151535 [debug] [MainThread]: On master: BEGIN
[0m13:07:19.151535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:19.185188 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.185188 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.185188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:07:19.198246 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:07:19.198246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC4567D10>]}
[0m13:07:19.198246 [debug] [MainThread]: On master: ROLLBACK
[0m13:07:19.198246 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.198246 [debug] [MainThread]: On master: BEGIN
[0m13:07:19.202082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.202082 [debug] [MainThread]: On master: COMMIT
[0m13:07:19.202082 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.202082 [debug] [MainThread]: On master: COMMIT
[0m13:07:19.203433 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.203937 [debug] [MainThread]: On master: Close
[0m13:07:19.203937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:19.203937 [info ] [MainThread]: 
[0m13:07:19.209057 [debug] [Thread-1 (]: Began running node model.chinook.dim_currency
[0m13:07:19.209560 [info ] [Thread-1 (]: 1 of 7 START sql table model chinook_dwh.dim_currency .......................... [RUN]
[0m13:07:19.209560 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_currency'
[0m13:07:19.209560 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_currency
[0m13:07:19.217603 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_currency"
[0m13:07:19.217603 [debug] [Thread-1 (]: Timing info for model.chinook.dim_currency (compile): 13:07:19.209560 => 13:07:19.217603
[0m13:07:19.217603 [debug] [Thread-1 (]: Began executing node model.chinook.dim_currency
[0m13:07:19.247742 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_currency"
[0m13:07:19.247742 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:07:19.253887 [debug] [Thread-1 (]: On model.chinook.dim_currency: BEGIN
[0m13:07:19.254390 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:07:19.284638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.284638 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:07:19.284638 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_currency__dbt_tmp"
  
  
    as
  
  (
    

SELECT  distinct invoicedate as date_rate
       ,exchange.ils as ils
FROM "chinook"."stg"."invoice" as invoice
	 left join "chinook"."stg"."exchange" as exchange
        on invoice.invoicedate = exchange.date_rate
ORDER BY date_rate asc
  );
  
[0m13:07:19.295831 [debug] [Thread-1 (]: SQL status: SELECT 1592 in 0.0 seconds
[0m13:07:19.297818 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:07:19.297818 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
alter table "chinook"."chinook_dwh"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m13:07:19.297818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.309867 [debug] [Thread-1 (]: On model.chinook.dim_currency: COMMIT
[0m13:07:19.309867 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:07:19.309867 [debug] [Thread-1 (]: On model.chinook.dim_currency: COMMIT
[0m13:07:19.309867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.325545 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_currency__dbt_backup"
[0m13:07:19.328181 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:07:19.328181 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
drop table if exists "chinook"."chinook_dwh"."dim_currency__dbt_backup" cascade
[0m13:07:19.333440 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:19.334640 [debug] [Thread-1 (]: Timing info for model.chinook.dim_currency (execute): 13:07:19.219546 => 13:07:19.334640
[0m13:07:19.334640 [debug] [Thread-1 (]: On model.chinook.dim_currency: Close
[0m13:07:19.334640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC480DE90>]}
[0m13:07:19.334640 [info ] [Thread-1 (]: 1 of 7 OK created sql table model chinook_dwh.dim_currency ..................... [[32mSELECT 1592[0m in 0.13s]
[0m13:07:19.337590 [debug] [Thread-1 (]: Finished running node model.chinook.dim_currency
[0m13:07:19.337590 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:07:19.337590 [info ] [Thread-1 (]: 2 of 7 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:07:19.337590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_currency, now model.chinook.dim_customer)
[0m13:07:19.340256 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:07:19.341985 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:07:19.341985 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:07:19.340256 => 13:07:19.341985
[0m13:07:19.345274 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:07:19.349525 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:07:19.349525 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:19.349525 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:07:19.349525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:19.383600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.383600 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:19.383600 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-10 10:07:17'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:07:19.394227 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:07:19.394227 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:19.394227 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:07:19.394227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.405499 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:19.406502 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:07:19.406502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.410182 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:07:19.411192 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:19.411192 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:07:19.412195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.414963 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:07:19.414963 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:07:19.414963 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:07:19.418435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:19.418435 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:07:19.345274 => 13:07:19.418435
[0m13:07:19.418435 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:07:19.418435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC480E9D0>]}
[0m13:07:19.418435 [info ] [Thread-1 (]: 2 of 7 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.08s]
[0m13:07:19.425611 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:07:19.425611 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:07:19.425611 [info ] [Thread-1 (]: 3 of 7 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:07:19.427893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:07:19.427893 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:07:19.430025 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:07:19.432097 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:07:19.428922 => 13:07:19.432097
[0m13:07:19.433127 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:07:19.433127 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:07:19.433127 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:19.433127 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:07:19.433127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:19.470364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.470364 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:19.470364 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-10 10:07:17'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:07:19.484297 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:07:19.487245 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:19.487245 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:07:19.487245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.492471 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:19.492471 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:07:19.494776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.495279 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:07:19.495279 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:19.495279 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:07:19.498765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.500814 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:07:19.500814 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:07:19.500814 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:07:19.500814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:19.506817 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:07:19.433127 => 13:07:19.506817
[0m13:07:19.507921 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:07:19.508424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC48CAE10>]}
[0m13:07:19.508424 [info ] [Thread-1 (]: 3 of 7 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.08s]
[0m13:07:19.510171 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:07:19.510675 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:07:19.510675 [info ] [Thread-1 (]: 4 of 7 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:07:19.512492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:07:19.512994 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:07:19.514505 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:07:19.514505 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:07:19.512994 => 13:07:19.514505
[0m13:07:19.521763 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:07:19.523882 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:07:19.523882 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:07:19.523882 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:07:19.523882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:19.554367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.554367 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:07:19.554367 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-10 10:07:17'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:07:19.571927 [debug] [Thread-1 (]: SQL status: SELECT 8719 in 0.0 seconds
[0m13:07:19.582816 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:07:19.582816 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist" rename to "dim_playlist__dbt_backup"
[0m13:07:19.582816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.587900 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:07:19.588502 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp" rename to "dim_playlist"
[0m13:07:19.589561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.591711 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:07:19.591711 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:07:19.592712 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:07:19.593712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.596523 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_playlist__dbt_backup"
[0m13:07:19.597553 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:07:19.597553 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
drop table if exists "chinook"."chinook_dwh"."dim_playlist__dbt_backup" cascade
[0m13:07:19.599393 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:19.603616 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:07:19.521763 => 13:07:19.599393
[0m13:07:19.604119 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:07:19.604119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC48E5B10>]}
[0m13:07:19.604119 [info ] [Thread-1 (]: 4 of 7 OK created sql table model chinook_dwh.dim_playlist ..................... [[32mSELECT 8719[0m in 0.09s]
[0m13:07:19.606026 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:07:19.606026 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:07:19.607465 [info ] [Thread-1 (]: 5 of 7 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:07:19.608903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:07:19.608903 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:07:19.612279 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:07:19.612279 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:07:19.608903 => 13:07:19.612279
[0m13:07:19.612279 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:07:19.612279 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:07:19.612279 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:07:19.612279 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:07:19.612279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:19.655301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.655301 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:07:19.655301 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-10 10:07:17'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.albumid = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:07:19.675689 [debug] [Thread-1 (]: SQL status: SELECT 3503 in 0.0 seconds
[0m13:07:19.683464 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:07:19.683464 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track" rename to "dim_track__dbt_backup"
[0m13:07:19.683464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.686973 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:07:19.686973 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track__dbt_tmp" rename to "dim_track"
[0m13:07:19.686973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.691705 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:07:19.691705 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:07:19.692815 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:07:19.694410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.696376 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_track__dbt_backup"
[0m13:07:19.696376 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:07:19.696376 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
drop table if exists "chinook"."chinook_dwh"."dim_track__dbt_backup" cascade
[0m13:07:19.696376 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:19.702827 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:07:19.612279 => 13:07:19.702827
[0m13:07:19.703329 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:07:19.703329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC47B7290>]}
[0m13:07:19.703329 [info ] [Thread-1 (]: 5 of 7 OK created sql table model chinook_dwh.dim_track ........................ [[32mSELECT 3503[0m in 0.10s]
[0m13:07:19.705203 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:07:19.705203 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:07:19.705203 [info ] [Thread-1 (]: 6 of 7 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:07:19.707125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:07:19.707125 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:07:19.708160 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:07:19.708160 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:07:19.708160 => 13:07:19.708160
[0m13:07:19.708160 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:07:19.738689 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:19.738689 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

    
  
    

  create temporary table "fact_invoice__dbt_tmp130719722901"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-10 10:07:17'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoice")

  );
  
  
[0m13:07:19.738689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:19.775845 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:07:19.775845 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:19.775845 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:07:19.775845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.786359 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:19.786359 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice__dbt_tmp130719722901'
        
      order by ordinal_position

  
[0m13:07:19.802027 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:07:19.802027 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:19.802027 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:07:19.802027 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:07:19.802027 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:19.802027 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:07:19.817804 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:07:19.833293 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:07:19.833293 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:19.833293 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoice"
            where (
                invoiceid) in (
                select (invoiceid)
                from "fact_invoice__dbt_tmp130719722901"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoice" ("invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time")
    (
        select "invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time"
        from "fact_invoice__dbt_tmp130719722901"
    )
  
[0m13:07:19.838249 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:07:19.843243 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:07:19.843755 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:07:19.843755 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:07:19.845238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.845741 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:07:19.708160 => 13:07:19.845741
[0m13:07:19.845741 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:07:19.846835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC47AC090>]}
[0m13:07:19.846835 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model chinook_dwh.fact_invoice ............... [[32mINSERT 0 0[0m in 0.14s]
[0m13:07:19.848090 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:07:19.848090 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:07:19.849264 [info ] [Thread-1 (]: 7 of 7 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:07:19.849264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:07:19.850554 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:07:19.853723 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:07:19.853723 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:07:19.850554 => 13:07:19.853723
[0m13:07:19.853723 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:07:19.853723 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:19.853723 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

    
  
    

  create temporary table "fact_invoiceline__dbt_tmp130719853723"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-10 10:07:17'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoiceline")

  );
  
  
[0m13:07:19.853723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:19.896646 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:07:19.899503 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:19.899503 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:07:19.899503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.899503 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:19.899503 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline__dbt_tmp130719853723'
        
      order by ordinal_position

  
[0m13:07:19.914127 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:07:19.916231 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:19.916231 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:07:19.916231 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:07:19.916231 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:19.916231 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:07:19.928610 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:07:19.930593 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:07:19.930593 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:19.930593 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoiceline"
            where (
                invoicelineid) in (
                select (invoicelineid)
                from "fact_invoiceline__dbt_tmp130719853723"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoiceline" ("invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time")
    (
        select "invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time"
        from "fact_invoiceline__dbt_tmp130719853723"
    )
  
[0m13:07:19.934038 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:07:19.935716 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:07:19.936218 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:07:19.936218 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:07:19.937677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.937677 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:07:19.853723 => 13:07:19.937677
[0m13:07:19.939178 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:07:19.939178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4370879-2c72-4518-bf03-e09512b802de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC48BCA90>]}
[0m13:07:19.940531 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model chinook_dwh.fact_invoiceline ........... [[32mINSERT 0 0[0m in 0.09s]
[0m13:07:19.940531 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:07:19.941990 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.943487 [debug] [MainThread]: On master: BEGIN
[0m13:07:19.943991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:19.973726 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.975731 [debug] [MainThread]: On master: COMMIT
[0m13:07:19.975731 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.975731 [debug] [MainThread]: On master: COMMIT
[0m13:07:19.975731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.975731 [debug] [MainThread]: On master: Close
[0m13:07:19.975731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:19.975731 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:07:19.975731 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:07:19.979635 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:07:19.979635 [info ] [MainThread]: 
[0m13:07:19.979635 [info ] [MainThread]: Finished running 5 table models, 2 incremental models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m13:07:19.982348 [debug] [MainThread]: Command end result
[0m13:07:19.982851 [info ] [MainThread]: 
[0m13:07:19.991531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:19.991531 [info ] [MainThread]: 
[0m13:07:19.993216 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:07:19.993216 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:19.993216 after 2.46 seconds
[0m13:07:19.993216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC32DC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBBA05810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB9F6390>]}
[0m13:07:19.993216 [debug] [MainThread]: Flushing usage events
[0m13:27:51.670203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A231FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A1F0D390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A04BCD50>]}


============================== 13:27:51.675362 | f4da15f3-ad2c-4834-be6e-58ddb20e340e ==============================
[0m13:27:51.675362 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:27:51.675866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:27:51.827917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A2330F90>]}
[0m13:27:51.907349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A1C5A0D0>]}
[0m13:27:51.907349 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:27:51.909673 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:27:52.035101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:52.035101 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_currency.sql
[0m13:27:52.139758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A3832E50>]}
[0m13:27:52.139758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A36E0B90>]}
[0m13:27:52.139758 [info ] [MainThread]: Found 7 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:27:52.139758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A36F8C10>]}
[0m13:27:52.155388 [info ] [MainThread]: 
[0m13:27:52.155388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:27:52.157069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:27:52.159148 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:27:52.159148 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:27:52.159148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:52.197261 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:27:52.199938 [debug] [ThreadPool]: On list_chinook: Close
[0m13:27:52.199938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:27:52.203577 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:27:52.203577 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:27:52.203577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:52.234161 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.234161 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:27:52.236440 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:27:52.236440 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:27:52.242006 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:27:52.242006 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:27:52.246315 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:52.246315 [debug] [MainThread]: On master: BEGIN
[0m13:27:52.246315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:52.276247 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.276247 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:52.276247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:27:52.282457 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:27:52.282457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A2550D50>]}
[0m13:27:52.282457 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:52.282457 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:52.282457 [debug] [MainThread]: On master: BEGIN
[0m13:27:52.282457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.282457 [debug] [MainThread]: On master: COMMIT
[0m13:27:52.289843 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:52.289843 [debug] [MainThread]: On master: COMMIT
[0m13:27:52.289843 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:27:52.289843 [debug] [MainThread]: On master: Close
[0m13:27:52.289843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:52.292055 [info ] [MainThread]: 
[0m13:27:52.292055 [debug] [Thread-1 (]: Began running node model.chinook.dim_currency
[0m13:27:52.292055 [info ] [Thread-1 (]: 1 of 7 START sql table model chinook_dwh.dim_currency .......................... [RUN]
[0m13:27:52.292055 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_currency'
[0m13:27:52.292055 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_currency
[0m13:27:52.298122 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_currency"
[0m13:27:52.298122 [debug] [Thread-1 (]: Timing info for model.chinook.dim_currency (compile): 13:27:52.292055 => 13:27:52.298122
[0m13:27:52.298122 [debug] [Thread-1 (]: Began executing node model.chinook.dim_currency
[0m13:27:52.334827 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_currency"
[0m13:27:52.335830 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:27:52.335830 [debug] [Thread-1 (]: On model.chinook.dim_currency: BEGIN
[0m13:27:52.337006 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:52.363749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.363749 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:27:52.363749 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_currency__dbt_tmp"
  
  
    as
  
  (
    

SELECT  distinct invoice.invoicedate as date_rate
       ,exchange.ils as ils
FROM "chinook"."stg"."invoice" as invoice
	 left join "chinook"."stg"."exchange" as exchange
        on invoice.invoicedate = exchange.date_rate
ORDER BY date_rate asc
  );
  
[0m13:27:52.372321 [debug] [Thread-1 (]: SQL status: SELECT 1592 in 0.0 seconds
[0m13:27:52.377538 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:27:52.377538 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
alter table "chinook"."chinook_dwh"."dim_currency" rename to "dim_currency__dbt_backup"
[0m13:27:52.378541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.381285 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:27:52.381285 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
alter table "chinook"."chinook_dwh"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m13:27:52.381285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.396476 [debug] [Thread-1 (]: On model.chinook.dim_currency: COMMIT
[0m13:27:52.396476 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:27:52.396476 [debug] [Thread-1 (]: On model.chinook.dim_currency: COMMIT
[0m13:27:52.396476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:52.399796 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_currency__dbt_backup"
[0m13:27:52.399796 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:27:52.399796 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
drop table if exists "chinook"."chinook_dwh"."dim_currency__dbt_backup" cascade
[0m13:27:52.411564 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:27:52.412568 [debug] [Thread-1 (]: Timing info for model.chinook.dim_currency (execute): 13:27:52.298122 => 13:27:52.412568
[0m13:27:52.412568 [debug] [Thread-1 (]: On model.chinook.dim_currency: Close
[0m13:27:52.412568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A38EBD90>]}
[0m13:27:52.412568 [info ] [Thread-1 (]: 1 of 7 OK created sql table model chinook_dwh.dim_currency ..................... [[32mSELECT 1592[0m in 0.12s]
[0m13:27:52.412568 [debug] [Thread-1 (]: Finished running node model.chinook.dim_currency
[0m13:27:52.412568 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:27:52.416524 [info ] [Thread-1 (]: 2 of 7 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:27:52.417027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_currency, now model.chinook.dim_customer)
[0m13:27:52.417027 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:27:52.419819 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:27:52.419819 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:27:52.417027 => 13:27:52.419819
[0m13:27:52.419819 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:27:52.423680 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:27:52.423680 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:27:52.423680 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:27:52.423680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:52.456156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.456156 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:27:52.456156 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-10 10:27:51'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:27:52.461531 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:27:52.461531 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:27:52.461531 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:27:52.461531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.461531 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:27:52.461531 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:27:52.461531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.475038 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:27:52.475038 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:27:52.475038 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:27:52.475038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:52.479398 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:27:52.479398 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:27:52.479398 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:27:52.479398 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:27:52.479398 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:27:52.422074 => 13:27:52.479398
[0m13:27:52.479398 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:27:52.479398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A2567550>]}
[0m13:27:52.479398 [info ] [Thread-1 (]: 2 of 7 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.06s]
[0m13:27:52.479398 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:27:52.488155 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:27:52.488155 [info ] [Thread-1 (]: 3 of 7 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:27:52.488155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:27:52.488155 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:27:52.491160 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:27:52.491160 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:27:52.488155 => 13:27:52.491160
[0m13:27:52.491160 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:27:52.497386 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:27:52.498386 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:27:52.498386 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:27:52.499386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:52.529388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.530403 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:27:52.530403 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-10 10:27:51'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:27:52.537925 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:27:52.539268 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:27:52.539268 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:27:52.539268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.545071 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:27:52.545071 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:27:52.545071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.549079 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:27:52.549079 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:27:52.550158 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:27:52.550158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:52.552041 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:27:52.552041 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:27:52.552041 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:27:52.557165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:27:52.557165 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:27:52.494325 => 13:27:52.557165
[0m13:27:52.557165 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:27:52.557165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A3944110>]}
[0m13:27:52.557165 [info ] [Thread-1 (]: 3 of 7 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.07s]
[0m13:27:52.557165 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:27:52.557165 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:27:52.561557 [info ] [Thread-1 (]: 4 of 7 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:27:52.561557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:27:52.561557 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:27:52.565081 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:27:52.565081 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:27:52.561557 => 13:27:52.565081
[0m13:27:52.565081 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:27:52.565081 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:27:52.565081 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:27:52.565081 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:27:52.565081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:52.605823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.605823 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:27:52.605823 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-10 10:27:51'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:27:52.613194 [debug] [Thread-1 (]: SQL status: SELECT 8719 in 0.0 seconds
[0m13:27:52.613194 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:27:52.613194 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist" rename to "dim_playlist__dbt_backup"
[0m13:27:52.613194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.613194 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:27:52.613194 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp" rename to "dim_playlist"
[0m13:27:52.613194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.629229 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:27:52.629229 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:27:52.629229 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:27:52.631973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:52.631973 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_playlist__dbt_backup"
[0m13:27:52.631973 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:27:52.631973 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
drop table if exists "chinook"."chinook_dwh"."dim_playlist__dbt_backup" cascade
[0m13:27:52.631973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:27:52.640208 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:27:52.565081 => 13:27:52.640208
[0m13:27:52.640208 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:27:52.640208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A3977390>]}
[0m13:27:52.640208 [info ] [Thread-1 (]: 4 of 7 OK created sql table model chinook_dwh.dim_playlist ..................... [[32mSELECT 8719[0m in 0.08s]
[0m13:27:52.640208 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:27:52.640208 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:27:52.643694 [info ] [Thread-1 (]: 5 of 7 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:27:52.644697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:27:52.644697 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:27:52.646783 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:27:52.646783 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:27:52.644697 => 13:27:52.646783
[0m13:27:52.646783 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:27:52.653073 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:27:52.654597 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:27:52.654597 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:27:52.654597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:52.778787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.778787 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:27:52.778787 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-10 10:27:51'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.albumid = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:27:52.795144 [debug] [Thread-1 (]: SQL status: SELECT 3503 in 0.0 seconds
[0m13:27:52.804942 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:27:52.806278 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track" rename to "dim_track__dbt_backup"
[0m13:27:52.806782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.808786 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:27:52.809994 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track__dbt_tmp" rename to "dim_track"
[0m13:27:52.810499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:52.810499 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:27:52.810499 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:27:52.810499 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:27:52.810499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:52.810499 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_track__dbt_backup"
[0m13:27:52.810499 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:27:52.810499 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
drop table if exists "chinook"."chinook_dwh"."dim_track__dbt_backup" cascade
[0m13:27:52.822074 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:27:52.822074 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:27:52.646783 => 13:27:52.822074
[0m13:27:52.822074 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:27:52.824580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A37EF690>]}
[0m13:27:52.824580 [info ] [Thread-1 (]: 5 of 7 OK created sql table model chinook_dwh.dim_track ........................ [[32mSELECT 3503[0m in 0.18s]
[0m13:27:52.824580 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:27:52.824580 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:27:52.826766 [info ] [Thread-1 (]: 6 of 7 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:27:52.826766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:27:52.828215 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:27:52.829325 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:27:52.829325 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:27:52.828215 => 13:27:52.829325
[0m13:27:52.829325 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:27:52.855958 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:27:52.855958 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

    
  
    

  create temporary table "fact_invoice__dbt_tmp132752840329"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-10 10:27:51'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoice")

  );
  
  
[0m13:27:52.855958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:52.891824 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:27:52.898201 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:27:52.899203 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:27:52.901891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:52.901891 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:27:52.901891 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice__dbt_tmp132752840329'
        
      order by ordinal_position

  
[0m13:27:52.913481 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:27:52.916638 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:27:52.916638 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:27:52.916638 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:27:52.916638 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:27:52.916638 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:27:52.932361 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:27:52.948414 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:27:52.948414 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:27:52.948414 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoice"
            where (
                invoiceid) in (
                select (invoiceid)
                from "fact_invoice__dbt_tmp132752840329"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoice" ("invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time")
    (
        select "invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time"
        from "fact_invoice__dbt_tmp132752840329"
    )
  
[0m13:27:52.948414 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:27:52.948414 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:27:52.948414 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:27:52.948414 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:27:52.948414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:52.948414 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:27:52.829325 => 13:27:52.948414
[0m13:27:52.948414 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:27:52.948414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A3849310>]}
[0m13:27:52.948414 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model chinook_dwh.fact_invoice ............... [[32mINSERT 0 0[0m in 0.12s]
[0m13:27:52.960338 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:27:52.960338 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:27:52.960338 [info ] [Thread-1 (]: 7 of 7 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:27:52.960338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:27:52.960338 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:27:52.966523 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:27:52.966523 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:27:52.960338 => 13:27:52.966523
[0m13:27:52.966523 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:27:52.970683 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:27:52.970683 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

    
  
    

  create temporary table "fact_invoiceline__dbt_tmp132752970683"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-10 10:27:51'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoiceline")

  );
  
  
[0m13:27:52.976118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:53.018219 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:27:53.023281 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:27:53.023281 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:27:53.026097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:53.026097 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:27:53.027306 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline__dbt_tmp132752970683'
        
      order by ordinal_position

  
[0m13:27:53.037816 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:27:53.037816 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:27:53.037816 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:27:53.048842 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:27:53.049847 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:27:53.049847 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:27:53.056006 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:27:53.056006 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:27:53.056006 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:27:53.056006 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoiceline"
            where (
                invoicelineid) in (
                select (invoicelineid)
                from "fact_invoiceline__dbt_tmp132752970683"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoiceline" ("invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time")
    (
        select "invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time"
        from "fact_invoiceline__dbt_tmp132752970683"
    )
  
[0m13:27:53.056006 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:27:53.056006 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:27:53.056006 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:27:53.056006 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:27:53.056006 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:53.056006 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:27:52.966523 => 13:27:53.056006
[0m13:27:53.065511 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:27:53.065511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4da15f3-ad2c-4834-be6e-58ddb20e340e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A39E1250>]}
[0m13:27:53.067227 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model chinook_dwh.fact_invoiceline ........... [[32mINSERT 0 0[0m in 0.11s]
[0m13:27:53.067227 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:27:53.069971 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:53.069971 [debug] [MainThread]: On master: BEGIN
[0m13:27:53.069971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:53.098461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:53.098461 [debug] [MainThread]: On master: COMMIT
[0m13:27:53.098461 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:53.098461 [debug] [MainThread]: On master: COMMIT
[0m13:27:53.098461 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:27:53.098461 [debug] [MainThread]: On master: Close
[0m13:27:53.098461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:53.098461 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:27:53.098461 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:27:53.098461 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:27:53.098461 [info ] [MainThread]: 
[0m13:27:53.098461 [info ] [MainThread]: Finished running 5 table models, 2 incremental models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m13:27:53.109220 [debug] [MainThread]: Command end result
[0m13:27:53.114975 [info ] [MainThread]: 
[0m13:27:53.114975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:53.114975 [info ] [MainThread]: 
[0m13:27:53.114975 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:27:53.120672 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:53.120672 after 1.49 seconds
[0m13:27:53.121176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A17E7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A17E6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4A1E27690>]}
[0m13:27:53.121176 [debug] [MainThread]: Flushing usage events
[0m13:30:40.660479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8149090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8815ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8149450>]}


============================== 13:30:40.665256 | d5ef59fc-3924-4001-beba-29a518c2daf0 ==============================
[0m13:30:40.665256 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:30:40.665256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:30:40.828270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8149690>]}
[0m13:30:40.902146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8AD0890>]}
[0m13:30:40.903799 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:30:40.910129 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:30:41.040621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:30:41.042936 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_currency.sql
[0m13:30:41.144566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8B0B990>]}
[0m13:30:41.167343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D9BAE250>]}
[0m13:30:41.167343 [info ] [MainThread]: Found 7 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:30:41.167343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8B2AA50>]}
[0m13:30:41.170140 [info ] [MainThread]: 
[0m13:30:41.170140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:41.172109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:30:41.176191 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:30:41.176191 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:30:41.176191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:41.211380 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:30:41.211380 [debug] [ThreadPool]: On list_chinook: Close
[0m13:30:41.211380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:30:41.217579 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:30:41.217579 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:30:41.217579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:41.252417 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.252417 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:30:41.253440 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:30:41.254569 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:30:41.254569 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:30:41.254569 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:30:41.268304 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:41.268304 [debug] [MainThread]: On master: BEGIN
[0m13:30:41.268304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:41.304874 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.304874 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:41.305977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:30:41.315647 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:30:41.316673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D9D661D0>]}
[0m13:30:41.316673 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:41.318751 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:41.318751 [debug] [MainThread]: On master: BEGIN
[0m13:30:41.318751 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.320269 [debug] [MainThread]: On master: COMMIT
[0m13:30:41.320269 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:41.320269 [debug] [MainThread]: On master: COMMIT
[0m13:30:41.320269 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:41.322290 [debug] [MainThread]: On master: Close
[0m13:30:41.322290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:41.322290 [info ] [MainThread]: 
[0m13:30:41.324135 [debug] [Thread-1 (]: Began running node model.chinook.dim_currency
[0m13:30:41.324135 [info ] [Thread-1 (]: 1 of 7 START sql table model chinook_dwh.dim_currency .......................... [RUN]
[0m13:30:41.324135 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_currency'
[0m13:30:41.324135 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_currency
[0m13:30:41.336138 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_currency"
[0m13:30:41.336138 [debug] [Thread-1 (]: Timing info for model.chinook.dim_currency (compile): 13:30:41.324135 => 13:30:41.336138
[0m13:30:41.336138 [debug] [Thread-1 (]: Began executing node model.chinook.dim_currency
[0m13:30:41.367393 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_currency"
[0m13:30:41.367393 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:30:41.367393 [debug] [Thread-1 (]: On model.chinook.dim_currency: BEGIN
[0m13:30:41.367393 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:30:41.410561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.410561 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:30:41.410561 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_currency__dbt_tmp"
  
  
    as
  
  (
    

SELECT  distinct invoice.invoicedate as date_rate
       ,exchange.ils as ils
FROM "chinook"."stg"."invoice" as invoice
	 right join "chinook"."stg"."exchange" as exchange
        on invoice.invoicedate = exchange.date_rate
ORDER BY date_rate asc
  );
  
[0m13:30:41.416068 [debug] [Thread-1 (]: SQL status: SELECT 92 in 0.0 seconds
[0m13:30:41.416068 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:30:41.416068 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
alter table "chinook"."chinook_dwh"."dim_currency" rename to "dim_currency__dbt_backup"
[0m13:30:41.416068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.425333 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:30:41.425333 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
alter table "chinook"."chinook_dwh"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m13:30:41.425333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.431892 [debug] [Thread-1 (]: On model.chinook.dim_currency: COMMIT
[0m13:30:41.446896 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:30:41.446896 [debug] [Thread-1 (]: On model.chinook.dim_currency: COMMIT
[0m13:30:41.448826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:41.450971 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_currency__dbt_backup"
[0m13:30:41.450971 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:30:41.450971 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
drop table if exists "chinook"."chinook_dwh"."dim_currency__dbt_backup" cascade
[0m13:30:41.459875 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:41.462879 [debug] [Thread-1 (]: Timing info for model.chinook.dim_currency (execute): 13:30:41.336138 => 13:30:41.462879
[0m13:30:41.462879 [debug] [Thread-1 (]: On model.chinook.dim_currency: Close
[0m13:30:41.463882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D9DCBE50>]}
[0m13:30:41.463882 [info ] [Thread-1 (]: 1 of 7 OK created sql table model chinook_dwh.dim_currency ..................... [[32mSELECT 92[0m in 0.14s]
[0m13:30:41.465386 [debug] [Thread-1 (]: Finished running node model.chinook.dim_currency
[0m13:30:41.465386 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:30:41.465386 [info ] [Thread-1 (]: 2 of 7 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:30:41.467539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_currency, now model.chinook.dim_customer)
[0m13:30:41.467539 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:30:41.469468 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:30:41.469468 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:30:41.467539 => 13:30:41.469468
[0m13:30:41.472203 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:30:41.474282 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:30:41.474282 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:30:41.474282 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:30:41.474282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:41.507301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.507301 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:30:41.507301 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-10 10:30:40'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:30:41.514712 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:30:41.519353 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:30:41.519353 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:30:41.519353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.519353 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:30:41.519353 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:30:41.519353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.526706 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:30:41.526866 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:30:41.527386 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:30:41.528595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:41.530585 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:30:41.531588 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:30:41.531588 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:30:41.534083 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:41.535201 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:30:41.472203 => 13:30:41.535201
[0m13:30:41.535201 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:30:41.535201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8877990>]}
[0m13:30:41.535201 [info ] [Thread-1 (]: 2 of 7 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.07s]
[0m13:30:41.535201 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:30:41.535201 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:30:41.535201 [info ] [Thread-1 (]: 3 of 7 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:30:41.535201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:30:41.535201 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:30:41.535201 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:30:41.535201 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:30:41.535201 => 13:30:41.535201
[0m13:30:41.535201 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:30:41.548902 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:30:41.549977 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:30:41.549977 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:30:41.549977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:41.581958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.581958 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:30:41.583515 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-10 10:30:40'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:30:41.590081 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:30:41.596211 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:30:41.596211 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:30:41.596211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.599643 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:30:41.600646 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:30:41.601650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.603069 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:30:41.603571 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:30:41.603571 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:30:41.604572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:41.606974 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:30:41.607976 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:30:41.607976 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:30:41.610332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:41.612613 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:30:41.535201 => 13:30:41.610332
[0m13:30:41.612613 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:30:41.612613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8B7B1D0>]}
[0m13:30:41.612613 [info ] [Thread-1 (]: 3 of 7 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.08s]
[0m13:30:41.612613 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:30:41.612613 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:30:41.616110 [info ] [Thread-1 (]: 4 of 7 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:30:41.616110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:30:41.616110 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:30:41.618154 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:30:41.618154 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:30:41.616110 => 13:30:41.618154
[0m13:30:41.618154 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:30:41.626209 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:30:41.626209 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:30:41.626209 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:30:41.626209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:41.661103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.662170 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:30:41.662170 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-10 10:30:40'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:30:41.677638 [debug] [Thread-1 (]: SQL status: SELECT 8719 in 0.0 seconds
[0m13:30:41.680141 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:30:41.680141 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist" rename to "dim_playlist__dbt_backup"
[0m13:30:41.680141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.683973 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:30:41.683973 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp" rename to "dim_playlist"
[0m13:30:41.683973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.689494 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:30:41.690550 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:30:41.691573 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:30:41.693673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:41.696322 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_playlist__dbt_backup"
[0m13:30:41.697426 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:30:41.697426 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
drop table if exists "chinook"."chinook_dwh"."dim_playlist__dbt_backup" cascade
[0m13:30:41.700631 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:41.700631 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:30:41.618154 => 13:30:41.700631
[0m13:30:41.704225 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:30:41.704225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D9BE7250>]}
[0m13:30:41.704225 [info ] [Thread-1 (]: 4 of 7 OK created sql table model chinook_dwh.dim_playlist ..................... [[32mSELECT 8719[0m in 0.09s]
[0m13:30:41.706638 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:30:41.706638 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:30:41.708142 [info ] [Thread-1 (]: 5 of 7 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:30:41.708142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:30:41.708142 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:30:41.714550 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:30:41.714550 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:30:41.708142 => 13:30:41.714550
[0m13:30:41.714550 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:30:41.721075 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:30:41.722173 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:30:41.722173 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:30:41.722173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:41.760386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.761502 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:30:41.761502 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-10 10:30:40'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.albumid = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:30:41.785420 [debug] [Thread-1 (]: SQL status: SELECT 3503 in 0.0 seconds
[0m13:30:41.788199 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:30:41.788199 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track" rename to "dim_track__dbt_backup"
[0m13:30:41.788199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.792106 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:30:41.792106 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track__dbt_tmp" rename to "dim_track"
[0m13:30:41.792106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:41.797762 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:30:41.797762 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:30:41.797762 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:30:41.797762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:41.803540 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_track__dbt_backup"
[0m13:30:41.803540 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:30:41.803540 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
drop table if exists "chinook"."chinook_dwh"."dim_track__dbt_backup" cascade
[0m13:30:41.808295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:41.808295 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:30:41.716554 => 13:30:41.808295
[0m13:30:41.808295 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:30:41.808295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8120310>]}
[0m13:30:41.808295 [info ] [Thread-1 (]: 5 of 7 OK created sql table model chinook_dwh.dim_track ........................ [[32mSELECT 3503[0m in 0.10s]
[0m13:30:41.814841 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:30:41.814841 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:30:41.814841 [info ] [Thread-1 (]: 6 of 7 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:30:41.816362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:30:41.816362 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:30:41.819366 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:30:41.819366 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:30:41.816362 => 13:30:41.819366
[0m13:30:41.819366 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:30:41.838497 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:30:41.851505 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

    
  
    

  create temporary table "fact_invoice__dbt_tmp133041838497"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-10 10:30:40'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoice")

  );
  
  
[0m13:30:41.851505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:41.882525 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:30:41.882525 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:30:41.882525 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:30:41.898755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:41.898989 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:30:41.900114 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice__dbt_tmp133041838497'
        
      order by ordinal_position

  
[0m13:30:41.914265 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:30:41.919975 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:30:41.919975 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:30:41.926782 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:30:41.935415 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:30:41.935415 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:30:41.940456 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:30:41.956946 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:30:41.958215 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:30:41.958215 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoice"
            where (
                invoiceid) in (
                select (invoiceid)
                from "fact_invoice__dbt_tmp133041838497"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoice" ("invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time")
    (
        select "invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time"
        from "fact_invoice__dbt_tmp133041838497"
    )
  
[0m13:30:41.958215 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:30:41.961129 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:30:41.961129 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:30:41.961129 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:30:41.965242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:41.965242 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:30:41.819366 => 13:30:41.965242
[0m13:30:41.965242 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:30:41.965242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D9D99450>]}
[0m13:30:41.965242 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model chinook_dwh.fact_invoice ............... [[32mINSERT 0 0[0m in 0.15s]
[0m13:30:41.969217 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:30:41.969217 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:30:41.971079 [info ] [Thread-1 (]: 7 of 7 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:30:41.971079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:30:41.971079 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:30:41.975362 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:30:41.976844 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:30:41.971079 => 13:30:41.976844
[0m13:30:41.976844 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:30:41.983530 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:30:41.983530 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

    
  
    

  create temporary table "fact_invoiceline__dbt_tmp133041978672"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-10 10:30:40'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoiceline")

  );
  
  
[0m13:30:41.984684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:42.022636 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:30:42.029681 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:30:42.030835 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:30:42.033058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:42.033058 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:30:42.033058 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline__dbt_tmp133041978672'
        
      order by ordinal_position

  
[0m13:30:42.052986 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:30:42.058262 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:30:42.058262 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:30:42.060495 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:30:42.063500 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:30:42.063500 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:30:42.069763 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:30:42.072958 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:30:42.072958 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:30:42.072958 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoiceline"
            where (
                invoicelineid) in (
                select (invoicelineid)
                from "fact_invoiceline__dbt_tmp133041978672"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoiceline" ("invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time")
    (
        select "invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time"
        from "fact_invoiceline__dbt_tmp133041978672"
    )
  
[0m13:30:42.072958 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:30:42.078159 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:30:42.078159 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:30:42.079166 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:30:42.079166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:42.080417 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:30:41.976844 => 13:30:42.080417
[0m13:30:42.082028 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:30:42.082028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef59fc-3924-4001-beba-29a518c2daf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8A733D0>]}
[0m13:30:42.082028 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model chinook_dwh.fact_invoiceline ........... [[32mINSERT 0 0[0m in 0.11s]
[0m13:30:42.082028 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:30:42.085743 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:42.085743 [debug] [MainThread]: On master: BEGIN
[0m13:30:42.085743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:42.119283 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:42.120338 [debug] [MainThread]: On master: COMMIT
[0m13:30:42.120338 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:42.120338 [debug] [MainThread]: On master: COMMIT
[0m13:30:42.120338 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:42.120338 [debug] [MainThread]: On master: Close
[0m13:30:42.120338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:42.120338 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:30:42.120338 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:30:42.124141 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:30:42.124141 [info ] [MainThread]: 
[0m13:30:42.124141 [info ] [MainThread]: Finished running 5 table models, 2 incremental models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m13:30:42.126947 [debug] [MainThread]: Command end result
[0m13:30:42.135116 [info ] [MainThread]: 
[0m13:30:42.135116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:42.136399 [info ] [MainThread]: 
[0m13:30:42.136399 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:30:42.136399 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:42.136399 after 1.51 seconds
[0m13:30:42.136399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8016510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D8287AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171D48E5250>]}
[0m13:30:42.136399 [debug] [MainThread]: Flushing usage events
[0m13:54:53.805588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ABE6DA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AB6B6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC0E4F90>]}


============================== 13:54:53.811345 | 8f5627fa-8e85-473a-a645-15eaa0beacab ==============================
[0m13:54:53.811345 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:54:53.811345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Дмитрий\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Дмитрий\\Desktop\\final_project\\chinook_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:54:53.965784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC461C50>]}
[0m13:54:54.041171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD508890>]}
[0m13:54:54.042172 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m13:54:54.045174 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:54:54.155522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:54.155522 [debug] [MainThread]: Partial parsing: updated file: chinook://models\dimensions\dim_currency.sql
[0m13:54:54.271073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD5097D0>]}
[0m13:54:54.280577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD7A44D0>]}
[0m13:54:54.280577 [info ] [MainThread]: Found 7 models, 12 tests, 13 sources, 0 exposures, 0 metrics, 411 macros, 0 groups, 0 semantic models
[0m13:54:54.280577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC4FD710>]}
[0m13:54:54.288711 [info ] [MainThread]: 
[0m13:54:54.289985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:54.291057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook'
[0m13:54:54.296259 [debug] [ThreadPool]: Using postgres connection "list_chinook"
[0m13:54:54.296259 [debug] [ThreadPool]: On list_chinook: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook"} */

    select distinct nspname from pg_namespace
  
[0m13:54:54.296259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:54.329392 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:54:54.330902 [debug] [ThreadPool]: On list_chinook: Close
[0m13:54:54.333141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chinook_chinook_dwh'
[0m13:54:54.333648 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:54:54.333648 [debug] [ThreadPool]: On list_chinook_chinook_dwh: BEGIN
[0m13:54:54.333648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:54.362608 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:54:54.362608 [debug] [ThreadPool]: Using postgres connection "list_chinook_chinook_dwh"
[0m13:54:54.362608 [debug] [ThreadPool]: On list_chinook_chinook_dwh: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "list_chinook_chinook_dwh"} */
select
      'chinook' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'chinook_dwh'
    union all
    select
      'chinook' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'chinook_dwh'
  
[0m13:54:54.362608 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:54:54.362608 [debug] [ThreadPool]: On list_chinook_chinook_dwh: ROLLBACK
[0m13:54:54.362608 [debug] [ThreadPool]: On list_chinook_chinook_dwh: Close
[0m13:54:54.376720 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:54.376720 [debug] [MainThread]: On master: BEGIN
[0m13:54:54.376720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:54.392542 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:54.407048 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:54.407048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:54.408295 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:54:54.408295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD50DC90>]}
[0m13:54:54.408295 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:54.408295 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:54.408295 [debug] [MainThread]: On master: BEGIN
[0m13:54:54.408295 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:54.408295 [debug] [MainThread]: On master: COMMIT
[0m13:54:54.408295 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:54.408295 [debug] [MainThread]: On master: COMMIT
[0m13:54:54.408295 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:54.408295 [debug] [MainThread]: On master: Close
[0m13:54:54.408295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:54.422703 [info ] [MainThread]: 
[0m13:54:54.424914 [debug] [Thread-1 (]: Began running node model.chinook.dim_currency
[0m13:54:54.424914 [info ] [Thread-1 (]: 1 of 7 START sql table model chinook_dwh.dim_currency .......................... [RUN]
[0m13:54:54.424914 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.chinook.dim_currency'
[0m13:54:54.427833 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_currency
[0m13:54:54.427833 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_currency"
[0m13:54:54.427833 [debug] [Thread-1 (]: Timing info for model.chinook.dim_currency (compile): 13:54:54.427833 => 13:54:54.427833
[0m13:54:54.427833 [debug] [Thread-1 (]: Began executing node model.chinook.dim_currency
[0m13:54:54.454229 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_currency"
[0m13:54:54.454229 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:54:54.454229 [debug] [Thread-1 (]: On model.chinook.dim_currency: BEGIN
[0m13:54:54.454229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:54:54.498442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:54.499488 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:54:54.499488 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_currency__dbt_tmp"
  
  
    as
  
  (
    

SELECT  distinct invoice.invoicedate as date_rate
       ,exchange_rate.ils as ils
FROM "chinook"."stg"."invoice" as invoice
	 left join "chinook"."stg"."exchange" as exchange_rate
        on invoice.invoicedate = exchange_rate.date_rate
ORDER BY date_rate asc
  );
  
[0m13:54:54.508786 [debug] [Thread-1 (]: SQL status: SELECT 1592 in 0.0 seconds
[0m13:54:54.513879 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:54:54.513879 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
alter table "chinook"."chinook_dwh"."dim_currency" rename to "dim_currency__dbt_backup"
[0m13:54:54.514986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.517093 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:54:54.517093 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
alter table "chinook"."chinook_dwh"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m13:54:54.517093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.534525 [debug] [Thread-1 (]: On model.chinook.dim_currency: COMMIT
[0m13:54:54.535672 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:54:54.535672 [debug] [Thread-1 (]: On model.chinook.dim_currency: COMMIT
[0m13:54:54.536935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:54.545077 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_currency__dbt_backup"
[0m13:54:54.551327 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_currency"
[0m13:54:54.552327 [debug] [Thread-1 (]: On model.chinook.dim_currency: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_currency"} */
drop table if exists "chinook"."chinook_dwh"."dim_currency__dbt_backup" cascade
[0m13:54:54.554789 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:54:54.557226 [debug] [Thread-1 (]: Timing info for model.chinook.dim_currency (execute): 13:54:54.427833 => 13:54:54.557226
[0m13:54:54.557226 [debug] [Thread-1 (]: On model.chinook.dim_currency: Close
[0m13:54:54.557226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD4E3410>]}
[0m13:54:54.557226 [info ] [Thread-1 (]: 1 of 7 OK created sql table model chinook_dwh.dim_currency ..................... [[32mSELECT 1592[0m in 0.13s]
[0m13:54:54.557226 [debug] [Thread-1 (]: Finished running node model.chinook.dim_currency
[0m13:54:54.557226 [debug] [Thread-1 (]: Began running node model.chinook.dim_customer
[0m13:54:54.562118 [info ] [Thread-1 (]: 2 of 7 START sql table model chinook_dwh.dim_customer .......................... [RUN]
[0m13:54:54.562118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_currency, now model.chinook.dim_customer)
[0m13:54:54.563463 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_customer
[0m13:54:54.565796 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_customer"
[0m13:54:54.568412 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (compile): 13:54:54.563463 => 13:54:54.568412
[0m13:54:54.570003 [debug] [Thread-1 (]: Began executing node model.chinook.dim_customer
[0m13:54:54.574793 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_customer"
[0m13:54:54.577214 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:54:54.577214 [debug] [Thread-1 (]: On model.chinook.dim_customer: BEGIN
[0m13:54:54.578259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:54.615274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:54.616295 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:54:54.616828 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    select customer.customerid
    ,INITCAP(customer.firstname) as first_name
    ,INITCAP(customer.lastname) as last_name
    ,customer.company
    ,customer.address
    ,customer.city
    ,customer.state 
    ,customer.country
    ,customer.postalcode
    ,customer.phone
    ,customer.fax
    ,customer.email
    ,left(substring(customer.email, position('@' in customer.email) + 1), position('.' in substring(customer.email, position('@' in customer.email) + 1))-1) as domain
    ,customer.supportrepid
    ,customer.last_update
    ,'2024-08-10 10:54:53'::timestamp as dbt_time
from "chinook"."stg"."customer"
  );
  
[0m13:54:54.628461 [debug] [Thread-1 (]: SQL status: SELECT 657 in 0.0 seconds
[0m13:54:54.631967 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:54:54.631967 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer" rename to "dim_customer__dbt_backup"
[0m13:54:54.631967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.636218 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:54:54.636218 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
alter table "chinook"."chinook_dwh"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:54:54.636218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.640494 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:54:54.642062 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:54:54.642062 [debug] [Thread-1 (]: On model.chinook.dim_customer: COMMIT
[0m13:54:54.643550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:54.647680 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_customer__dbt_backup"
[0m13:54:54.647680 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_customer"
[0m13:54:54.647680 [debug] [Thread-1 (]: On model.chinook.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_customer"} */
drop table if exists "chinook"."chinook_dwh"."dim_customer__dbt_backup" cascade
[0m13:54:54.647680 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:54:54.654455 [debug] [Thread-1 (]: Timing info for model.chinook.dim_customer (execute): 13:54:54.570003 => 13:54:54.653952
[0m13:54:54.654455 [debug] [Thread-1 (]: On model.chinook.dim_customer: Close
[0m13:54:54.654455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC4A69D0>]}
[0m13:54:54.657266 [info ] [Thread-1 (]: 2 of 7 OK created sql table model chinook_dwh.dim_customer ..................... [[32mSELECT 657[0m in 0.09s]
[0m13:54:54.658536 [debug] [Thread-1 (]: Finished running node model.chinook.dim_customer
[0m13:54:54.658536 [debug] [Thread-1 (]: Began running node model.chinook.dim_employee
[0m13:54:54.658536 [info ] [Thread-1 (]: 3 of 7 START sql table model chinook_dwh.dim_employee .......................... [RUN]
[0m13:54:54.660526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_customer, now model.chinook.dim_employee)
[0m13:54:54.660526 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_employee
[0m13:54:54.664074 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_employee"
[0m13:54:54.665077 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (compile): 13:54:54.660526 => 13:54:54.664074
[0m13:54:54.665580 [debug] [Thread-1 (]: Began executing node model.chinook.dim_employee
[0m13:54:54.667091 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_employee"
[0m13:54:54.667091 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:54:54.671687 [debug] [Thread-1 (]: On model.chinook.dim_employee: BEGIN
[0m13:54:54.672189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:54.704576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:54.705594 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:54:54.705594 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_employee__dbt_tmp"
  
  
    as
  
  (
    SELECT emp.*
    ,b.department_name
    ,b.budget
    ,EXTRACT(YEAR FROM age(CURRENT_DATE, emp.hiredate)) AS years_in_company
    ,left(substring(email, position('@' in email) +1), position('.' in substring(email, position('@' in email)+1))-1) as domain
    ,case when emp.employeeid in (select distinct reportsto from stg.employee) then 1
        else 0
            end as is_manager
    ,'2024-08-10 10:54:53'::timestamp as dbt_time
FROM "chinook"."stg"."employee" emp
    JOIN "chinook"."stg"."budget" b on emp.departmentid = b.department_id
  );
  
[0m13:54:54.705594 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m13:54:54.716533 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:54:54.716533 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee" rename to "dim_employee__dbt_backup"
[0m13:54:54.716533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.716533 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:54:54.721537 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
alter table "chinook"."chinook_dwh"."dim_employee__dbt_tmp" rename to "dim_employee"
[0m13:54:54.721537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.724106 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:54:54.724106 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:54:54.724106 [debug] [Thread-1 (]: On model.chinook.dim_employee: COMMIT
[0m13:54:54.724106 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:54.727998 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_employee__dbt_backup"
[0m13:54:54.727998 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_employee"
[0m13:54:54.727998 [debug] [Thread-1 (]: On model.chinook.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_employee"} */
drop table if exists "chinook"."chinook_dwh"."dim_employee__dbt_backup" cascade
[0m13:54:54.731246 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:54:54.732699 [debug] [Thread-1 (]: Timing info for model.chinook.dim_employee (execute): 13:54:54.665580 => 13:54:54.732699
[0m13:54:54.734030 [debug] [Thread-1 (]: On model.chinook.dim_employee: Close
[0m13:54:54.734533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC30C210>]}
[0m13:54:54.734533 [info ] [Thread-1 (]: 3 of 7 OK created sql table model chinook_dwh.dim_employee ..................... [[32mSELECT 8[0m in 0.07s]
[0m13:54:54.735991 [debug] [Thread-1 (]: Finished running node model.chinook.dim_employee
[0m13:54:54.736499 [debug] [Thread-1 (]: Began running node model.chinook.dim_playlist
[0m13:54:54.736499 [info ] [Thread-1 (]: 4 of 7 START sql table model chinook_dwh.dim_playlist .......................... [RUN]
[0m13:54:54.737504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_employee, now model.chinook.dim_playlist)
[0m13:54:54.737504 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_playlist
[0m13:54:54.741541 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_playlist"
[0m13:54:54.741541 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (compile): 13:54:54.737504 => 13:54:54.741541
[0m13:54:54.741541 [debug] [Thread-1 (]: Began executing node model.chinook.dim_playlist
[0m13:54:54.741541 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_playlist"
[0m13:54:54.741541 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:54:54.741541 [debug] [Thread-1 (]: On model.chinook.dim_playlist: BEGIN
[0m13:54:54.751654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:54.769260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:54.769260 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:54:54.769260 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp"
  
  
    as
  
  (
    select pl.playlistid as playlist_id
    ,pl.name as playlist_name
    ,pl.last_update as last_update
    ,plt.trackid as trackid
    ,plt.last_update as track_last_update
    ,'2024-08-10 10:54:53'::timestamp as dbt_time
from "chinook"."stg"."playlist" as pl
    left join "chinook"."stg"."playlisttrack" plt on pl.playlistid = plt.playlistid
where 1=1
    
  );
  
[0m13:54:54.786681 [debug] [Thread-1 (]: SQL status: SELECT 8719 in 0.0 seconds
[0m13:54:54.786681 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:54:54.786681 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist" rename to "dim_playlist__dbt_backup"
[0m13:54:54.786681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.800695 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:54:54.800695 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
alter table "chinook"."chinook_dwh"."dim_playlist__dbt_tmp" rename to "dim_playlist"
[0m13:54:54.800695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.800695 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:54:54.800695 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:54:54.800695 [debug] [Thread-1 (]: On model.chinook.dim_playlist: COMMIT
[0m13:54:54.806644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:54.806644 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_playlist__dbt_backup"
[0m13:54:54.809764 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_playlist"
[0m13:54:54.810813 [debug] [Thread-1 (]: On model.chinook.dim_playlist: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_playlist"} */
drop table if exists "chinook"."chinook_dwh"."dim_playlist__dbt_backup" cascade
[0m13:54:54.811316 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:54:54.815442 [debug] [Thread-1 (]: Timing info for model.chinook.dim_playlist (execute): 13:54:54.741541 => 13:54:54.815442
[0m13:54:54.816531 [debug] [Thread-1 (]: On model.chinook.dim_playlist: Close
[0m13:54:54.816531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD864250>]}
[0m13:54:54.816531 [info ] [Thread-1 (]: 4 of 7 OK created sql table model chinook_dwh.dim_playlist ..................... [[32mSELECT 8719[0m in 0.08s]
[0m13:54:54.816531 [debug] [Thread-1 (]: Finished running node model.chinook.dim_playlist
[0m13:54:54.816531 [debug] [Thread-1 (]: Began running node model.chinook.dim_track
[0m13:54:54.816531 [info ] [Thread-1 (]: 5 of 7 START sql table model chinook_dwh.dim_track ............................. [RUN]
[0m13:54:54.821093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_playlist, now model.chinook.dim_track)
[0m13:54:54.821093 [debug] [Thread-1 (]: Began compiling node model.chinook.dim_track
[0m13:54:54.826118 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.dim_track"
[0m13:54:54.827283 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (compile): 13:54:54.822215 => 13:54:54.826118
[0m13:54:54.827283 [debug] [Thread-1 (]: Began executing node model.chinook.dim_track
[0m13:54:54.831743 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.dim_track"
[0m13:54:54.831743 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:54:54.831743 [debug] [Thread-1 (]: On model.chinook.dim_track: BEGIN
[0m13:54:54.834167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:54.869364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:54.869364 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:54:54.869364 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */

  
    

  create  table "chinook"."chinook_dwh"."dim_track__dbt_tmp"
  
  
    as
  
  (
    SELECT track.trackid as trackid
    ,track.name as track
    ,album.title as title
    ,artist.name as artist
    ,genre.name as genre
    ,mediatype.name as mediatype
    ,track.composer as composer
    ,to_char((track.milliseconds / 1000) * INTERVAL'1 second', 'MI:SS') as duration
    ,round(track.milliseconds/1000,0) as seconds
    ,track.unitprice
    ,'2024-08-10 10:54:53'::timestamp as dbt_time
FROM "chinook"."stg"."track" track
    join "chinook"."stg"."album" album on track.albumid = album.albumid
    join "chinook"."stg"."artist" artist on album.artistid = artist.artistid
    join "chinook"."stg"."genre" genre on track.genreid = genre.genreid
    join "chinook"."stg"."mediatype" mediatype on track.mediatypeid = mediatype.mediatypeid
  );
  
[0m13:54:54.899108 [debug] [Thread-1 (]: SQL status: SELECT 3503 in 0.0 seconds
[0m13:54:54.905674 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:54:54.905674 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track" rename to "dim_track__dbt_backup"
[0m13:54:54.905674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.911255 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:54:54.911255 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
alter table "chinook"."chinook_dwh"."dim_track__dbt_tmp" rename to "dim_track"
[0m13:54:54.913351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:54.915543 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:54:54.915543 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:54:54.915543 [debug] [Thread-1 (]: On model.chinook.dim_track: COMMIT
[0m13:54:54.917510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:54.919791 [debug] [Thread-1 (]: Applying DROP to: "chinook"."chinook_dwh"."dim_track__dbt_backup"
[0m13:54:54.922678 [debug] [Thread-1 (]: Using postgres connection "model.chinook.dim_track"
[0m13:54:54.923754 [debug] [Thread-1 (]: On model.chinook.dim_track: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.dim_track"} */
drop table if exists "chinook"."chinook_dwh"."dim_track__dbt_backup" cascade
[0m13:54:54.927377 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:54:54.929750 [debug] [Thread-1 (]: Timing info for model.chinook.dim_track (execute): 13:54:54.827283 => 13:54:54.929750
[0m13:54:54.929750 [debug] [Thread-1 (]: On model.chinook.dim_track: Close
[0m13:54:54.929750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD7A6550>]}
[0m13:54:54.929750 [info ] [Thread-1 (]: 5 of 7 OK created sql table model chinook_dwh.dim_track ........................ [[32mSELECT 3503[0m in 0.11s]
[0m13:54:54.933503 [debug] [Thread-1 (]: Finished running node model.chinook.dim_track
[0m13:54:54.933503 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoice
[0m13:54:54.933503 [info ] [Thread-1 (]: 6 of 7 START sql incremental model chinook_dwh.fact_invoice .................... [RUN]
[0m13:54:54.936407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.dim_track, now model.chinook.fact_invoice)
[0m13:54:54.936407 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoice
[0m13:54:54.943412 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoice"
[0m13:54:54.943412 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (compile): 13:54:54.936407 => 13:54:54.943412
[0m13:54:54.943412 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoice
[0m13:54:54.975317 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:54:54.975317 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

    
  
    

  create temporary table "fact_invoice__dbt_tmp135454975317"
  
  
    as
  
  (
    

SELECT invoice.*
    ,'2024-08-10 10:54:53'::timestamp as dbt_time
FROM "chinook"."stg"."invoice"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoice")

  );
  
  
[0m13:54:54.975317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:55.019120 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:54:55.025387 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:54:55.026536 [debug] [Thread-1 (]: On model.chinook.fact_invoice: BEGIN
[0m13:54:55.028397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:55.028397 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:54:55.029654 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice__dbt_tmp135454975317'
        
      order by ordinal_position

  
[0m13:54:55.041065 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:54:55.045636 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:54:55.045636 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:54:55.045636 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:54:55.045636 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:54:55.045636 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoice'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:54:55.060151 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:54:55.075783 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoice"
[0m13:54:55.075783 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:54:55.075783 [debug] [Thread-1 (]: On model.chinook.fact_invoice: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoice"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoice"
            where (
                invoiceid) in (
                select (invoiceid)
                from "fact_invoice__dbt_tmp135454975317"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoice" ("invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time")
    (
        select "invoiceid", "customerid", "invoicedate", "billingaddress", "billingcity", "billingstate", "billingcountry", "billingpostalcode", "total", "last_update", "dbt_time"
        from "fact_invoice__dbt_tmp135454975317"
    )
  
[0m13:54:55.075783 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:54:55.075783 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:54:55.075783 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoice"
[0m13:54:55.075783 [debug] [Thread-1 (]: On model.chinook.fact_invoice: COMMIT
[0m13:54:55.075783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:55.075783 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoice (execute): 13:54:54.943412 => 13:54:55.075783
[0m13:54:55.075783 [debug] [Thread-1 (]: On model.chinook.fact_invoice: Close
[0m13:54:55.075783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD5519D0>]}
[0m13:54:55.075783 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model chinook_dwh.fact_invoice ............... [[32mINSERT 0 0[0m in 0.14s]
[0m13:54:55.075783 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoice
[0m13:54:55.075783 [debug] [Thread-1 (]: Began running node model.chinook.fact_invoiceline
[0m13:54:55.089134 [info ] [Thread-1 (]: 7 of 7 START sql incremental model chinook_dwh.fact_invoiceline ................ [RUN]
[0m13:54:55.089134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.chinook.fact_invoice, now model.chinook.fact_invoiceline)
[0m13:54:55.089134 [debug] [Thread-1 (]: Began compiling node model.chinook.fact_invoiceline
[0m13:54:55.091639 [debug] [Thread-1 (]: Writing injected SQL for node "model.chinook.fact_invoiceline"
[0m13:54:55.091639 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (compile): 13:54:55.089134 => 13:54:55.091639
[0m13:54:55.091639 [debug] [Thread-1 (]: Began executing node model.chinook.fact_invoiceline
[0m13:54:55.091639 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:54:55.091639 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

    
  
    

  create temporary table "fact_invoiceline__dbt_tmp135455091639"
  
  
    as
  
  (
    

SELECT invoiceline.*
    ,'2024-08-10 10:54:53'::timestamp as dbt_time
FROM "chinook"."stg"."invoiceline"
WHERE 1=1

and last_update::timestamp > (select max(last_update) from "chinook"."chinook_dwh"."fact_invoiceline")

  );
  
  
[0m13:54:55.091639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:55.140721 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m13:54:55.140721 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:54:55.140721 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: BEGIN
[0m13:54:55.146989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:55.147493 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:54:55.147493 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline__dbt_tmp135455091639'
        
      order by ordinal_position

  
[0m13:54:55.159935 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:54:55.159935 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:54:55.159935 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:54:55.159935 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:54:55.159935 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:54:55.170939 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chinook".INFORMATION_SCHEMA.columns
      where table_name = 'fact_invoiceline'
        
        and table_schema = 'chinook_dwh'
        
      order by ordinal_position

  
[0m13:54:55.170939 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m13:54:55.170939 [debug] [Thread-1 (]: Writing runtime sql for node "model.chinook.fact_invoiceline"
[0m13:54:55.170939 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:54:55.170939 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "chinook", "target_name": "dev", "node_id": "model.chinook.fact_invoiceline"} */

      
        
            delete from "chinook"."chinook_dwh"."fact_invoiceline"
            where (
                invoicelineid) in (
                select (invoicelineid)
                from "fact_invoiceline__dbt_tmp135455091639"
            );

        
    

    insert into "chinook"."chinook_dwh"."fact_invoiceline" ("invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time")
    (
        select "invoicelineid", "invoiceid", "trackid", "unitprice", "quantity", "last_update", "dbt_time"
        from "fact_invoiceline__dbt_tmp135455091639"
    )
  
[0m13:54:55.170939 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:54:55.170939 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:54:55.170939 [debug] [Thread-1 (]: Using postgres connection "model.chinook.fact_invoiceline"
[0m13:54:55.170939 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: COMMIT
[0m13:54:55.170939 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:55.170939 [debug] [Thread-1 (]: Timing info for model.chinook.fact_invoiceline (execute): 13:54:55.091639 => 13:54:55.170939
[0m13:54:55.170939 [debug] [Thread-1 (]: On model.chinook.fact_invoiceline: Close
[0m13:54:55.170939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f5627fa-8e85-473a-a645-15eaa0beacab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AD8D9250>]}
[0m13:54:55.170939 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model chinook_dwh.fact_invoiceline ........... [[32mINSERT 0 0[0m in 0.08s]
[0m13:54:55.170939 [debug] [Thread-1 (]: Finished running node model.chinook.fact_invoiceline
[0m13:54:55.187045 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.187045 [debug] [MainThread]: On master: BEGIN
[0m13:54:55.188839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:55.220363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:55.221819 [debug] [MainThread]: On master: COMMIT
[0m13:54:55.221819 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.221819 [debug] [MainThread]: On master: COMMIT
[0m13:54:55.221819 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:55.221819 [debug] [MainThread]: On master: Close
[0m13:54:55.224605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:55.224605 [debug] [MainThread]: Connection 'list_chinook' was properly closed.
[0m13:54:55.225109 [debug] [MainThread]: Connection 'list_chinook_chinook_dwh' was properly closed.
[0m13:54:55.225109 [debug] [MainThread]: Connection 'model.chinook.fact_invoiceline' was properly closed.
[0m13:54:55.225109 [info ] [MainThread]: 
[0m13:54:55.225109 [info ] [MainThread]: Finished running 5 table models, 2 incremental models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m13:54:55.225109 [debug] [MainThread]: Command end result
[0m13:54:55.236450 [info ] [MainThread]: 
[0m13:54:55.236450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:55.236450 [info ] [MainThread]: 
[0m13:54:55.239891 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:54:55.239891 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:55.239891 after 1.47 seconds
[0m13:54:55.241688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC0E4F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ABBBA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AB6D0150>]}
[0m13:54:55.241688 [debug] [MainThread]: Flushing usage events
